<!DOCTYPE HTML>
<html lang="">


<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta name="keywords" content="开发框架, viabcde">
    <meta name="description" content="框架是一套完整的解决方案，能提高开发效率，对项目的侵入性很大。更换框架需要把整个项目重构库是一个单一的小功能，通常称为插件  
web.xml文件web.xml 总结：

配置欢迎页面
配置Spring配置文件 即applicationCo">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>开发框架 | Fox</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">Fox</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>Index</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>Tags</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>Categories</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>Archives</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>About</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>Friends</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="Search"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">Fox</div>
        <div class="logo-desc">
            
            好眉目生来本该住山巅
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                Index
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                Tags
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                Categories
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                Archives
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                About
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                Friends
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/viacbde" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/viacbde" class="github-corner tooltipped hide-on-med-and-down" target="_blank" data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewbox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/>
    </svg>
</a>
        
    </nav>

</header>


<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('请输入访问本文章的密码')).toString(CryptoJS.enc.Hex)) {
                alert('密码错误，将返回主页！');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/10.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        开发框架
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/框架/" target="_blank">
                                <span class="chip bg-color">框架</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/编程/" class="post-category" target="_blank">
                                编程
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2016-09-01
                </div>

                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>Read Count:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <p>框架是一套完整的解决方案，能提高开发效率，对项目的侵入性很大。<br>更换框架需要把整个项目重构<br><strong>库</strong><br>是一个单一的小功能，通常称为插件  </p>
<h1 id="web-xml文件"><a href="#web-xml文件" class="headerlink" title="web.xml文件"></a>web.xml文件</h1><h1 id="web-xml"><a href="#web-xml" class="headerlink" title="web.xml "></a><font color="red"><strong>web.xml</strong> </font></h1><p><strong>总结：</strong></p>
<ul>
<li>配置欢迎页面</li>
<li>配置Spring配置文件 即applicationContext.xml</li>
<li>配置编码过滤器</li>
<li>配置Spring监听器</li>
<li>配置SpringMVC 即spring-mvc.xml</li>
</ul>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee
         http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;
         version=&quot;3.1&quot;&gt;

  &lt;display-name&gt;Student_Information&lt;/display-name&gt;
  &lt;welcome-file-list&gt;
    &lt;welcome-file&gt;/WEB-INF/pages/index.jsp&lt;/welcome-file&gt;
  &lt;/welcome-file-list&gt;
  &lt;!-- 读取spring配置文件 --&gt;
  &lt;context-param&gt;
    &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
    &lt;param-value&gt;classpath:conf/applicationContext.xml&lt;/param-value&gt;
  &lt;/context-param&gt;

  &lt;!-- 编码过滤器 --&gt;
  &lt;filter&gt;
    &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt;
    &lt;async-supported&gt;true&lt;/async-supported&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;encoding&lt;/param-name&gt;
      &lt;param-value&gt;UTF-8&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/filter&gt;
  &lt;filter-mapping&gt;
    &lt;filter-name&gt;encodingFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
  &lt;/filter-mapping&gt;

  &lt;!-- 配置Spring监听器 --&gt;
  &lt;listener&gt;
    &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;
  &lt;/listener&gt;

  &lt;!-- 添加对SpringMVC的支持 --&gt;
  &lt;servlet&gt;
    &lt;servlet-name&gt;SpringMVC&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
      &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
      &lt;param-value&gt;classpath:conf/spring-mvc.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;SpringMVC&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;


&lt;/web-app&gt;
</code></pre><h3 id="web-xml-1"><a href="#web-xml-1" class="headerlink" title="web.xml"></a><strong>web.xml</strong></h3><h3 id="内容一："><a href="#内容一：" class="headerlink" title="内容一："></a><strong>内容一：</strong></h3><p>配置默认页面：<br>当用户在浏览器中输入的URL不包含某个servlet名或JSP页面时，welcome-file-list元素可指定显示的默认文件。</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> displayname 只是用来显示项目名称 可配置可不配置 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>display<span class="token operator">-</span>name<span class="token operator">></span>ssm<span class="token operator">-</span>demo<span class="token operator">&lt;</span><span class="token operator">/</span>display<span class="token operator">-</span>name<span class="token operator">></span>
    <span class="token operator">&lt;</span>welcome<span class="token operator">-</span>file<span class="token operator">-</span>list<span class="token operator">></span>
        <span class="token operator">&lt;</span>welcome<span class="token operator">-</span>file<span class="token operator">></span>index<span class="token punctuation">.</span>html<span class="token operator">&lt;</span><span class="token operator">/</span>welcome<span class="token operator">-</span>file<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>welcome<span class="token operator">-</span>file<span class="token operator">-</span>list<span class="token operator">></span>
</code></pre>
<h3 id="内容二："><a href="#内容二：" class="headerlink" title="内容二："></a><strong>内容二：</strong></h3><pre class=" language-java"><code class="language-java">    <span class="token operator">&lt;</span>context<span class="token operator">-</span>param<span class="token operator">></span>
        <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>contextConfigLocation<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
        <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span>classpath<span class="token operator">:</span>applicationContext<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>context<span class="token operator">-</span>param<span class="token operator">></span>
</code></pre>
<p>context-param是以键值对形式存在的<br>context-param使用方法：由于context-param是配置在web下面，属于上下文参数，在整个环境中都可使用，存放在getServletContext对像中，因此使用方法是：getServletContext().getInitParameter(“user”)，如：</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span><span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span>IOException<span class="token punctuation">{</span>
        String user<span class="token operator">=</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>       
    <span class="token punctuation">}</span>
</code></pre>
<h3 id="内容三："><a href="#内容三：" class="headerlink" title="内容三："></a><strong>内容三：</strong></h3><p>配置字符编码过滤器<br>先配置过滤的实现类<br>再配置被过滤的请求类型 /* 表示所有</p>
<pre class=" language-java"><code class="language-java">   <span class="token operator">&lt;</span>filter<span class="token operator">></span>
        <span class="token operator">&lt;</span>filter<span class="token operator">-</span>name<span class="token operator">></span>encodingFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>name<span class="token operator">></span>
        <span class="token operator">&lt;</span>filter<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>CharacterEncodingFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>init<span class="token operator">-</span>param<span class="token operator">></span>
            <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>encoding<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
            <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span>UTF<span class="token operator">-</span><span class="token number">8</span><span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>init<span class="token operator">-</span>param<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">></span>
    <span class="token operator">&lt;</span>filter<span class="token operator">-</span>mapping<span class="token operator">></span>
        <span class="token operator">&lt;</span>filter<span class="token operator">-</span>name<span class="token operator">></span>encodingFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>name<span class="token operator">></span>
        <span class="token operator">&lt;</span>url<span class="token operator">-</span>pattern<span class="token operator">></span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>url<span class="token operator">-</span>pattern<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>mapping<span class="token operator">></span>
</code></pre>
<h3 id="内容四："><a href="#内容四：" class="headerlink" title="内容四："></a><strong>内容四：</strong></h3><p>配置Spring的监听器<br>和SpribgMVC转发器以及拦截的请求类型</p>
<pre class=" language-java"><code class="language-java">  <span class="token operator">&lt;</span>listener<span class="token operator">></span>
        <span class="token operator">&lt;</span>listener<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>context<span class="token punctuation">.</span>ContextLoaderListener<span class="token operator">&lt;</span><span class="token operator">/</span>listener<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>listener<span class="token operator">></span>
    <span class="token operator">&lt;</span>servlet<span class="token operator">></span>
        <span class="token operator">&lt;</span>servlet<span class="token operator">-</span>name<span class="token operator">></span>springMVC<span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">-</span>name<span class="token operator">></span>
        <span class="token operator">&lt;</span>servlet<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>DispatcherServlet<span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>init<span class="token operator">-</span>param<span class="token operator">></span>
            <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>contextConfigLocation<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
            <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span>classpath<span class="token operator">:</span>spring<span class="token operator">-</span>mvc<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>init<span class="token operator">-</span>param<span class="token operator">></span>
        <span class="token operator">&lt;</span>load<span class="token operator">-</span>on<span class="token operator">-</span>startup<span class="token operator">></span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>load<span class="token operator">-</span>on<span class="token operator">-</span>startup<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">></span>
    <span class="token operator">&lt;</span>servlet<span class="token operator">-</span>mapping<span class="token operator">></span>
        <span class="token operator">&lt;</span>servlet<span class="token operator">-</span>name<span class="token operator">></span>springMVC<span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">-</span>name<span class="token operator">></span>
        <span class="token operator">&lt;</span>url<span class="token operator">-</span>pattern<span class="token operator">></span><span class="token operator">*</span><span class="token punctuation">.</span><span class="token keyword">do</span><span class="token operator">&lt;</span><span class="token operator">/</span>url<span class="token operator">-</span>pattern<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">-</span>mapping<span class="token operator">></span>

</code></pre>
<p>init-param使用方法：由于init-param是配置在servlet中，属于某一下servlet，存放在getServletConfig中，因此使用方法是：getServletConfig().getInitParameter(“user1”); 由于它属于当前的servlet类，所以用this替代getServletConfig(), 使用this.getInitParmeter(“user1”) , 如：</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">service</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span><span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span>IOException<span class="token punctuation">{</span>
        String user<span class="token operator">=</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"user1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token function">getServletConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"user1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">//或this.getInitParmeter("user1");</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>user1<span class="token punctuation">)</span><span class="token punctuation">;</span>      
    <span class="token punctuation">}</span>

</code></pre>
<h3 id="内容五："><a href="#内容五：" class="headerlink" title="内容五："></a><strong>内容五：</strong></h3><p>配置各种错误返回类型所对应的返回页面</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>error<span class="token operator">-</span>page<span class="token operator">></span>
        <span class="token operator">&lt;</span>error<span class="token operator">-</span>code<span class="token operator">></span><span class="token number">404</span><span class="token operator">&lt;</span><span class="token operator">/</span>error<span class="token operator">-</span>code<span class="token operator">></span>
        <span class="token operator">&lt;</span>location<span class="token operator">></span><span class="token operator">/</span>main<span class="token punctuation">.</span>jsp<span class="token operator">&lt;</span><span class="token operator">/</span>location<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>error<span class="token operator">-</span>page<span class="token operator">></span>

    <span class="token operator">&lt;</span>error<span class="token operator">-</span>page<span class="token operator">></span>
        <span class="token operator">&lt;</span>error<span class="token operator">-</span>code<span class="token operator">></span><span class="token number">500</span><span class="token operator">&lt;</span><span class="token operator">/</span>error<span class="token operator">-</span>code<span class="token operator">></span>
        <span class="token operator">&lt;</span>location<span class="token operator">></span><span class="token operator">/</span>main<span class="token punctuation">.</span>jsp<span class="token operator">&lt;</span><span class="token operator">/</span>location<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>error<span class="token operator">-</span>page<span class="token operator">></span>
</code></pre>
<h1 id="web-xml-2"><a href="#web-xml-2" class="headerlink" title="web.xml"></a><strong>web.xml</strong></h1><p><strong>总结：</strong></p>
<ul>
<li>注册Spring配置文件的位置 即applicationContext.xml</li>
<li>注册ServletContext监听器</li>
<li>注册ServletContext监听器</li>
<li>配置中央调度器 拦截所有请求 即spring-mvc.xml</li>
<li><p>使用Rest风格的URI</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span>
<span class="token operator">&lt;</span>web<span class="token operator">-</span>app xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
  xmlns<span class="token operator">=</span><span class="token string">"http://java.sun.com/xml/ns/javaee"</span>
  xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span><span class="token string">"http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"</span>
  id<span class="token operator">=</span><span class="token string">"WebApp_ID"</span> version<span class="token operator">=</span><span class="token string">"2.5"</span><span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">2.1</span> 注册Spring配置文件的位置 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>context<span class="token operator">-</span>param<span class="token operator">></span>
      <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>contextConfigLocation<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span>classpath<span class="token operator">:</span>applicationContext<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>context<span class="token operator">-</span>param<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">2.2</span> 注册ServletContext监听器 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 用于创建Spring容器对象放入ServletContext的域属性空间中，保证整个应用中的Spring容器唯一 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>listener<span class="token operator">></span>
      <span class="token operator">&lt;</span>listener<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>context<span class="token punctuation">.</span>ContextLoaderListener<span class="token operator">&lt;</span><span class="token operator">/</span>listener<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>listener<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">2.3</span> 注册ServletContext监听器 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 用于解决请求参数中的中文乱码问题 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>filter<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span>name<span class="token operator">></span>CharacterEncodingFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>CharacterEncodingFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>init<span class="token operator">-</span>param<span class="token operator">></span>
          <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>encoding<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
          <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span>utf<span class="token operator">-</span><span class="token number">8</span><span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>init<span class="token operator">-</span>param<span class="token operator">></span>
      <span class="token operator">&lt;</span>init<span class="token operator">-</span>param<span class="token operator">></span>
          <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>forceRequestEncoding<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
          <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>init<span class="token operator">-</span>param<span class="token operator">></span>
      <span class="token operator">&lt;</span>init<span class="token operator">-</span>param<span class="token operator">></span>
          <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>forceReponseEncoding<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
          <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>init<span class="token operator">-</span>param<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">></span>

  <span class="token operator">&lt;</span>filter<span class="token operator">-</span>mapping<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span>name<span class="token operator">></span>CharacterEncodingFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>url<span class="token operator">-</span>pattern<span class="token operator">></span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>url<span class="token operator">-</span>pattern<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>mapping<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">2.4</span> 配置中央调度器 拦截所有请求<span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>servlet<span class="token operator">></span>
      <span class="token operator">&lt;</span>servlet<span class="token operator">-</span>name<span class="token operator">></span>springmvc<span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>servlet<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>DispatcherServlet<span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>init<span class="token operator">-</span>param<span class="token operator">></span>
          <span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>contextConfigLocation<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
          <span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span>classpath<span class="token operator">:</span>spring<span class="token operator">-</span>mvc<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>init<span class="token operator">-</span>param<span class="token operator">></span>
      <span class="token operator">&lt;</span>load<span class="token operator">-</span>on<span class="token operator">-</span>startup<span class="token operator">></span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>load<span class="token operator">-</span>on<span class="token operator">-</span>startup<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">></span>
  <span class="token operator">&lt;</span>servlet<span class="token operator">-</span>mapping<span class="token operator">></span>
      <span class="token operator">&lt;</span>servlet<span class="token operator">-</span>name<span class="token operator">></span>springmvc<span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>url<span class="token operator">-</span>pattern<span class="token operator">></span><span class="token operator">/</span><span class="token operator">&lt;</span><span class="token operator">/</span>url<span class="token operator">-</span>pattern<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>servlet<span class="token operator">-</span>mapping<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">2.5</span> 使用Rest风格的URI <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>filter<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span>name<span class="token operator">></span>HiddenHttpMethodFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>HiddenHttpMethodFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">></span>
  <span class="token operator">&lt;</span>filter<span class="token operator">-</span>mapping<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span>name<span class="token operator">></span>HiddenHttpMethodFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>url<span class="token operator">-</span>pattern<span class="token operator">></span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>url<span class="token operator">-</span>pattern<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>mapping<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 解决无法直接发送PUT请求，带着请求体的问题，在修改员工信息的时候使用 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>filter<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span>name<span class="token operator">></span>HttpPutFormContentFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>filter<span class="token punctuation">.</span>HttpPutFormContentFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">></span>
  <span class="token operator">&lt;</span>filter<span class="token operator">-</span>mapping<span class="token operator">></span>
      <span class="token operator">&lt;</span>filter<span class="token operator">-</span>name<span class="token operator">></span>HttpPutFormContentFilter<span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>name<span class="token operator">></span>
      <span class="token operator">&lt;</span>url<span class="token operator">-</span>pattern<span class="token operator">></span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">&lt;</span><span class="token operator">/</span>url<span class="token operator">-</span>pattern<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>filter<span class="token operator">-</span>mapping<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>web<span class="token operator">-</span>app<span class="token operator">></span>
</code></pre>
<h1 id="Controller文件"><a href="#Controller文件" class="headerlink" title="Controller文件"></a>Controller文件</h1><p>@RestController<br>@RequestMapping(“user”)<br>@GetMapping(“{id}”)</p>
<h2 id="Controller"><a href="#Controller" class="headerlink" title="@Controller "></a><font color="red"><strong>@Controller</strong> </font></h2><p>@Controller 用于标记在一个类上，使用它标记的类就是一个SpringMVC Controller 对象<br>使用@Controller，配合视图解析器可以返回jsp、html等页面，如果要返回json，则需要再加@ResponseBody<br>或者直接使用@RestController，此时只能返回json，不能返回jsp、html</p>
<h2 id="ResponseBody"><a href="#ResponseBody" class="headerlink" title="@ResponseBody   "></a><font color="red"><strong>@ResponseBody  </strong> </font></h2><p>@RequestMapping(“url”)，这里的 url写的是请求路径的一部分，一般作用在 Controller的方法上，作为请求的映射地址</p>
</li>
</ul>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/test"</span><span class="token punctuation">)</span><span class="token comment" spellcheck="true">//类级别映射，可以没有，一般用于减少书写量</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">myController</span> <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">//方法级别映射，必须有，那么这个方法的访问地址就是/test/aaa，请求到的页面就是test.jsp【当然，这里的.jsp需要在配置文件中配置】</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"/aaa"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> String <span class="token function">getMyName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"test"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="RequestBody"><a href="#RequestBody" class="headerlink" title=" @RequestBody   "></a><font color="red"><strong> @RequestBody  </strong> </font></h2><p>@ResponseBody是作用在方法上的，@ResponseBody 表示该方法的返回结果直接写入 HTTP response body 中<br>一般在异步获取数据时使用【也就是AJAX】，在使用 @RequestMapping后，返回值通常解析为跳转路径，但是加上 @ResponseBody 后返回结果不会被解析为跳转路径，而是直接写入 HTTP response body 中。<br>比如异步获取 json 数据，加上 @ResponseBody 后，会直接返回 json 数据。@RequestBody 将 HTTP 请求正文插入方法中，使用适合的 HttpMessageConverter 将请求体写入某个对象。</p>
<pre class=" language-java"><code class="language-java">   <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/login.do"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> Object <span class="token function">login</span><span class="token punctuation">(</span>String name<span class="token punctuation">,</span> String password<span class="token punctuation">,</span> HttpSession session<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        user <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">checkLogin</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">JsonResult</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<h2 id="Autowired"><a href="#Autowired" class="headerlink" title=" @Autowired   "></a><font color="red"><strong> @Autowired  </strong> </font></h2><p>@Autowired 注释，它可以对类成员变量、方法及构造函数进行标注，完成自动装配的工作。 通过 @Autowired的使用来消除 set ，get方法。在使用@Autowired之前，我们对一个bean配置起属性时，是这用用的</p>
<h2 id="RequestParam"><a href="#RequestParam" class="headerlink" title=" @RequestParam  "></a><font color="red"><strong> @RequestParam </strong> </font></h2><p> @RequestParam（org.springframework.web.bind.annotation.RequestParam）用于将指定的请求参数赋值给方法中的形参</p>
<pre class=" language-java"><code class="language-java">   <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/requestParamTest"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> RequestMethod<span class="token punctuation">.</span>GET<span class="token punctuation">)</span>
    <span class="token keyword">public</span> String <span class="token function">requestParamTest</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"username"</span><span class="token punctuation">)</span> String userName<span class="token punctuation">,</span> <span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"usernick"</span><span class="token punctuation">)</span> String userNick<span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"requestParam Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"username: "</span> <span class="token operator">+</span> userName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"usernick: "</span> <span class="token operator">+</span> userNick<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>也可以不使用@RequestParam，直接接收，此时要求controller方法中的参数名称要跟form中name名称一致</p>
<pre class=" language-java"><code class="language-java">    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token string">"/requestParamTest"</span><span class="token punctuation">,</span> method <span class="token operator">=</span> RequestMethod<span class="token punctuation">.</span>GET<span class="token punctuation">)</span>
    <span class="token keyword">public</span> String <span class="token function">requestParamTest</span><span class="token punctuation">(</span>String username<span class="token punctuation">,</span> String usernick<span class="token punctuation">)</span><span class="token punctuation">{</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"requestParam Test"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"username: "</span> <span class="token operator">+</span> username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        System<span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"usernick: "</span> <span class="token operator">+</span> usernick<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"hello"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<h1 id="applicationContext配置文件"><a href="#applicationContext配置文件" class="headerlink" title="applicationContext配置文件"></a>applicationContext配置文件</h1><h1 id="applicationContext-xml"><a href="#applicationContext-xml" class="headerlink" title="applicationContext.xml "></a><font color="red"><strong>applicationContext.xml</strong> </font></h1><p><strong>总结</strong></p>
<ul>
<li><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
     xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
     xmlns<span class="token operator">:</span>p<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/p"</span>
     xmlns<span class="token operator">:</span>aop<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/aop"</span>
     xmlns<span class="token operator">:</span>context<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/context"</span>
     xmlns<span class="token operator">:</span>jee<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/jee"</span>
     xmlns<span class="token operator">:</span>tx<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/tx"</span>
     xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"
      http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop<span class="token operator">/</span>spring<span class="token operator">-</span>aop<span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">.</span>xsd
      http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">.</span>xsd
      http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context<span class="token operator">/</span>spring<span class="token operator">-</span>context<span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">.</span>xsd
      http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>jee http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>jee<span class="token operator">/</span>spring<span class="token operator">-</span>jee<span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">.</span>xsd
      http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx<span class="token operator">/</span>spring<span class="token operator">-</span>tx<span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">.</span>xsd"<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 加载数据库参数 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>context<span class="token operator">:</span>property<span class="token operator">-</span>placeholder location<span class="token operator">=</span><span class="token string">"classpath:conf/jdbc.properties"</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>context<span class="token operator">:</span>component<span class="token operator">-</span>scan base<span class="token operator">-</span><span class="token keyword">package</span><span class="token operator">=</span><span class="token string">"com.hlk.service.impl"</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id <span class="token operator">=</span> <span class="token string">"dataSource"</span> <span class="token keyword">class</span> <span class="token operator">=</span> <span class="token string">"com.alibaba.druid.pool.DruidDataSource"</span> destroy<span class="token operator">-</span>method <span class="token operator">=</span> <span class="token string">"close"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 数据库基本信息配置 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"url"</span> value <span class="token operator">=</span> <span class="token string">"${druid.url}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"username"</span> value <span class="token operator">=</span> <span class="token string">"${druid.username}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"password"</span> value <span class="token operator">=</span> <span class="token string">"${druid.password}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"driverClassName"</span> value <span class="token operator">=</span> <span class="token string">"${druid.driverClassName}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"filters"</span> value <span class="token operator">=</span> <span class="token string">"${druid.filters}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 最大并发连接数 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"maxActive"</span> value <span class="token operator">=</span> <span class="token string">"${druid.maxActive}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 初始化连接数量 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"initialSize"</span> value <span class="token operator">=</span> <span class="token string">"${druid.initialSize}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置获取连接等待超时的时间 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"maxWait"</span> value <span class="token operator">=</span> <span class="token string">"${druid.maxWait}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 最小空闲连接数 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"minIdle"</span> value <span class="token operator">=</span> <span class="token string">"${druid.minIdle}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置间隔多久才进行一次检测，检测需要关闭的空闲连接，单位是毫秒 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"timeBetweenEvictionRunsMillis"</span> value <span class="token operator">=</span><span class="token string">"${druid.timeBetweenEvictionRunsMillis}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置一个连接在池中最小生存的时间，单位是毫秒 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"minEvictableIdleTimeMillis"</span> value <span class="token operator">=</span><span class="token string">"${druid.minEvictableIdleTimeMillis}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"validationQuery"</span> value <span class="token operator">=</span> <span class="token string">"${druid.validationQuery}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"testWhileIdle"</span> value <span class="token operator">=</span> <span class="token string">"${druid.testWhileIdle}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"testOnBorrow"</span> value <span class="token operator">=</span> <span class="token string">"${druid.testOnBorrow}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"testOnReturn"</span> value <span class="token operator">=</span> <span class="token string">"${druid.testOnReturn}"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"maxOpenPreparedStatements"</span> value <span class="token operator">=</span><span class="token string">"${druid.maxOpenPreparedStatements}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 打开 removeAbandoned 功能 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"removeAbandoned"</span> value <span class="token operator">=</span> <span class="token string">"${druid.removeAbandoned}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">1800</span> 秒，也就是 <span class="token number">30</span> 分钟 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"removeAbandonedTimeout"</span> value <span class="token operator">=</span><span class="token string">"${druid.removeAbandonedTimeout}"</span> <span class="token operator">/</span><span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 关闭 abanded 连接时输出错误日志 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name <span class="token operator">=</span> <span class="token string">"logAbandoned"</span> value <span class="token operator">=</span> <span class="token string">"${druid.logAbandoned}"</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置MyBatis的sqlSessionFactory <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"sqlSessionFactory"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.mybatis.spring.SqlSessionFactoryBean"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"dataSource"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"configLocation"</span> value<span class="token operator">=</span><span class="token string">"classpath:conf/mybatis-config.xml"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"mapperLocations"</span> value<span class="token operator">=</span><span class="token string">"classpath:mapper/*.xml"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Mapper接口所在包名，Spring会自动查找其下的Mapper  <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"basePackage"</span> value<span class="token operator">=</span><span class="token string">"com.hlk.dao"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sqlSessionFactoryBeanName"</span> value<span class="token operator">=</span><span class="token string">"sqlSessionFactory"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置transactionManager事务管理器 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"transactionManager"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"dataSource"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置事物通知属性 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>tx<span class="token operator">:</span>advice id<span class="token operator">=</span><span class="token string">"txAdvice"</span> transaction<span class="token operator">-</span>manager<span class="token operator">=</span><span class="token string">"transactionManager"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 定义事物传播特性 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>tx<span class="token operator">:</span>attributes<span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"insert"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span><span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"update*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"edit*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"save*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"add*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"new*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"set*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"remove*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"delete*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"change*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"check*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"get*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> read<span class="token operator">-</span>only<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"find*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> read<span class="token operator">-</span>only<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"load*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> read<span class="token operator">-</span>only<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">/</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"*"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span> read<span class="token operator">-</span>only<span class="token operator">=</span><span class="token string">"true"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>tx<span class="token operator">:</span>attributes<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>tx<span class="token operator">:</span>advice<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置事物切面 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>aop<span class="token operator">:</span>config<span class="token operator">></span>
      <span class="token operator">&lt;</span>aop<span class="token operator">:</span>pointcut expression<span class="token operator">=</span><span class="token string">"execution(* com.hlk.service.*.*(..))"</span> id<span class="token operator">=</span><span class="token string">"serviceOperation"</span><span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>aop<span class="token operator">:</span>advisor advice<span class="token operator">-</span>ref<span class="token operator">=</span><span class="token string">"txAdvice"</span> pointcut<span class="token operator">-</span>ref<span class="token operator">=</span><span class="token string">"serviceOperation"</span><span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>aop<span class="token operator">:</span>config<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">></span>
</code></pre>
<h2 id="applicationContext-xml-1"><a href="#applicationContext-xml-1" class="headerlink" title="applicationContext.xml "></a><font color="red"><strong>applicationContext.xml</strong> </font></h2><p><strong>总结：</strong>该文件主要是为了配置事务（而事务需要sessionFactory，sessionFactory需要数据源等信息）和批量执行的SqlSession  </p>
</li>
<li>配置事务(需要sessionFactory)  </li>
<li>配置sessionFactory(需要数据源及其他配置，如指定数据库方言、显示sql语句和自动建表)</li>
<li>配置数据源:设置驱动、数据库的URL、数据库的用户名及密码</li>
</ul>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
    xmlns<span class="token operator">:</span>context<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/context"</span>
    xmlns<span class="token operator">:</span>aop<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/aop"</span>
    xmlns<span class="token operator">:</span>tx<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/tx"</span>
    xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token operator">-</span><span class="token number">4.2</span><span class="token punctuation">.</span>xsd 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context<span class="token operator">/</span>spring<span class="token operator">-</span>context<span class="token operator">-</span><span class="token number">4.2</span><span class="token punctuation">.</span>xsd 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop<span class="token operator">/</span>spring<span class="token operator">-</span>aop<span class="token operator">-</span><span class="token number">4.2</span><span class="token punctuation">.</span>xsd 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx<span class="token operator">/</span>spring<span class="token operator">-</span>tx<span class="token punctuation">.</span>xsd"<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>        数据源配置        <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">1</span><span class="token punctuation">.</span> 配置读取jdbc<span class="token punctuation">.</span>properties文件 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>context<span class="token operator">:</span>property<span class="token operator">-</span>placeholder location<span class="token operator">=</span><span class="token string">"classpath:jdbc.properties"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">2</span><span class="token punctuation">.</span> 配置C3P0连接池 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean name<span class="token operator">=</span><span class="token string">"C3P0DataSource"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span> <span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"jdbcUrl"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.url}"</span> <span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"driverClass"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.driver}"</span> <span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"user"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.username}"</span> <span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"password"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.password}"</span> <span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>        业务注册        <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Service的注册 业务逻辑注册 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置扫描器 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>context<span class="token operator">:</span>component<span class="token operator">-</span>scan base<span class="token operator">-</span><span class="token keyword">package</span><span class="token operator">=</span><span class="token string">"com.crud.service"</span> <span class="token operator">/</span><span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>        整合Mybatis        <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">1</span><span class="token punctuation">.</span> 注册SqlSessionFactoryBean <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"sqlSessionFactory"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.mybatis.spring.SqlSessionFactoryBean"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定mybatis主配置文件的位置 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"configLocation"</span> value<span class="token operator">=</span><span class="token string">"classpath:mybatis.xml"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 连接池注入 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"C3P0DataSource"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定mapper文件的位置 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"mapperLocations"</span> value<span class="token operator">=</span><span class="token string">"classpath:mapper/*.xml"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>        sqlSessionFactory 配置完成        <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token operator">--</span><span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>        使用sqlSessionFactory批量执行的SqlSession        <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"sqlSession"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.mybatis.spring.SqlSessionTemplate"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>constructor<span class="token operator">-</span>arg name<span class="token operator">=</span><span class="token string">"sqlSessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sqlSessionFactory"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>constructor<span class="token operator">-</span>arg name<span class="token operator">=</span><span class="token string">"executorType"</span> value<span class="token operator">=</span><span class="token string">"BATCH"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span>        使用C3P0DataSource事务配置        <span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span><span class="token operator">*</span> <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">1</span><span class="token punctuation">.</span> 配置事务管理器 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"transactionManager"</span>
        <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 控制住数据源 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"C3P0DataSource"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">2</span><span class="token punctuation">.</span> 注册事务通知 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 比较重要的要使用配置式 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>tx<span class="token operator">:</span>advice id<span class="token operator">=</span><span class="token string">"transactionAdvice"</span> transaction<span class="token operator">-</span>manager<span class="token operator">=</span><span class="token string">"transactionManager"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>tx<span class="token operator">:</span>attributes<span class="token operator">></span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 所有方法都是事务方法 <span class="token operator">--</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"*"</span> isolation<span class="token operator">=</span><span class="token string">"DEFAULT"</span> propagation<span class="token operator">=</span><span class="token string">"REQUIRED"</span><span class="token operator">/</span><span class="token operator">></span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> get查询方法为只读，优化查询效率 <span class="token operator">--</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>tx<span class="token operator">:</span>method name<span class="token operator">=</span><span class="token string">"get*"</span> read<span class="token operator">-</span>only<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>tx<span class="token operator">:</span>attributes<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>tx<span class="token operator">:</span>advice<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">3</span><span class="token punctuation">.</span> aop配置 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>aop<span class="token operator">:</span>config<span class="token operator">></span>
        <span class="token operator">&lt;</span>aop<span class="token operator">:</span>pointcut expression<span class="token operator">=</span><span class="token string">"execution(* com.crud.service..*(..))"</span> id<span class="token operator">=</span><span class="token string">"myPointCut"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>aop<span class="token operator">:</span>advisor advice<span class="token operator">-</span>ref<span class="token operator">=</span><span class="token string">"transactionAdvice"</span> pointcut<span class="token operator">-</span>ref<span class="token operator">=</span><span class="token string">"myPointCut"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>aop<span class="token operator">:</span>config<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">></span>
</code></pre>
<h1 id="springApplication注解"><a href="#springApplication注解" class="headerlink" title="springApplication注解"></a>springApplication注解</h1><p>springApplication=声明是配置类+开始配置+自动扫描<br>@SpringApplication文件默认扫描它同级及以下的<br>如果不是放在最顶级包则需要加@ComponentScan才能加载到其他包的程序</p>
<h1 id="springboot工作流程"><a href="#springboot工作流程" class="headerlink" title="springboot工作流程"></a>springboot工作流程</h1><h1 id="springBoot启动项目"><a href="#springBoot启动项目" class="headerlink" title="springBoot启动项目"></a><strong>springBoot启动项目</strong></h1><p><a href="https://github.com/54321decba/tu/tree/master/springboot%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE" target="_blank" rel="noopener">SpringBoot启动项目地址</a><br>我们开发任何一个Spring Boot项目，都会用到如下的启动类</p>
<pre class=" language-groovy"><code class="language-groovy"><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        SpringApplication<span class="token operator">.</span><span class="token function">run</span><span class="token punctuation">(</span>Application<span class="token operator">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>从上面代码可以看出，Annotation定义（@SpringBootApplication）和类定义（SpringApplication.run）最为耀眼，所以要揭开SpringBoot的神秘面纱，我们要从这两位开始就可以了。<br><strong>SpringBootApplication注解的源码</strong></p>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Target</span><span class="token punctuation">(</span>ElementType<span class="token punctuation">.</span>TYPE<span class="token punctuation">)</span>            <span class="token comment" spellcheck="true">// 注解的适用范围，其中TYPE用于描述类、接口（包括包注解类型）或enum声明</span>
<span class="token annotation punctuation">@Retention</span><span class="token punctuation">(</span>RetentionPolicy<span class="token punctuation">.</span>RUNTIME<span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">// 注解的生命周期，保留到class文件中（三个生命周期）</span>
<span class="token annotation punctuation">@Documented</span>                          <span class="token comment" spellcheck="true">// 表明这个注解应该被javadoc记录</span>
<span class="token annotation punctuation">@Inherited</span>                           <span class="token comment" spellcheck="true">// 子类可以继承该注解</span>
<span class="token annotation punctuation">@SpringBootConfiguration</span>             <span class="token comment" spellcheck="true">// 继承了Configuration，表示当前是注解类</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>             <span class="token comment" spellcheck="true">// 开启springboot的注解功能，springboot的四大神器之一，其借助@import的帮助</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>excludeFilters <span class="token operator">=</span> <span class="token punctuation">{</span>    <span class="token comment" spellcheck="true">// 扫描路径设置（具体使用待确认）</span>
        <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> FilterType<span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> TypeExcludeFilter<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token annotation punctuation">@Filter</span><span class="token punctuation">(</span>type <span class="token operator">=</span> FilterType<span class="token punctuation">.</span>CUSTOM<span class="token punctuation">,</span> classes <span class="token operator">=</span> AutoConfigurationExcludeFilter<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> @<span class="token keyword">interface</span> <span class="token class-name">SpringBootApplication</span> <span class="token punctuation">{</span>
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre>
<p>虽然定义使用了多个Annotation进行了原信息标注，但实际上重要的只有三个Annotation：<br>@Configuration（@SpringBootConfiguration点开查看发现里面还是应用了@Configuration）<br>@EnableAutoConfiguration<br>@ComponentScan<br>所以，如果我们使用如下的SpringBoot启动类，整个SpringBoot应用依然可以与之前的启动类功能对等：<br>即SpringBootApplication=Configuration+EnableAutoConfiguration+ComponentScan</p>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableAutoConfiguration</span>
<span class="token annotation punctuation">@ComponentScan</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>Application<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>既然作用一样，写这3个注解比较累，那直接写@即SpringBootApplication更简洁一点    </p>
<h3 id="Configuration"><a href="#Configuration" class="headerlink" title="@Configuration"></a>@Configuration</h3><p>标注了@Configuration之后说明本身是一个IoC容器的配置类<br>它也可以使用xml格式</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
       xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
       xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"</span>
       <span class="token keyword">default</span><span class="token operator">-</span>lazy<span class="token operator">-</span>init<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>bean定义<span class="token operator">--</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">></span>
</code></pre>
<p>SpringBoot社区推荐使用基于JavaConfig的配置形式  ，即使用注解的方式</p>
<pre><code>@Configuration
public class MockConfiguration{
    //bean定义
}
</code></pre><p>注册bean定义层面<br>基于XML的配置形式是这样：</p>
<pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>mockService<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>..MockServiceImpl<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    ...
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>bean</span><span class="token punctuation">></span></span>
</code></pre>
<p>而基于JavaConfig的配置形式是这样的：</p>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MockConfiguration</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> MockService <span class="token function">mockService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MockServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="任何一个标注了-Bean的方法，其返回值将作为一个bean定义注册到Spring的IoC容器，方法名将默认成该bean定义的id。"><a href="#任何一个标注了-Bean的方法，其返回值将作为一个bean定义注册到Spring的IoC容器，方法名将默认成该bean定义的id。" class="headerlink" title="任何一个标注了@Bean的方法，其返回值将作为一个bean定义注册到Spring的IoC容器，方法名将默认成该bean定义的id。"></a>任何一个标注了@Bean的方法，其返回值将作为一个bean定义注册到Spring的IoC容器，方法名将默认成该bean定义的id。</h2><p>为了表达bean与bean之间的依赖关系，在XML形式中一般是这样：</p>
<pre class=" language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"mockService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"..MockServiceImpl"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>propery name <span class="token operator">=</span><span class="token string">"dependencyService"</span> ref<span class="token operator">=</span><span class="token string">"dependencyService"</span> <span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

<span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"dependencyService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"DependencyServiceImpl"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
</code></pre>
<p>而基于JavaConfig的配置形式是这样的：</p>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MockConfiguration</span><span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> MockService <span class="token function">mockService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MockServiceImpl</span><span class="token punctuation">(</span><span class="token function">dependencyService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> DependencyService <span class="token function">dependencyService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DependencyServiceImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>如果一个bean的定义依赖其他bean,则直接调用对应的JavaConfig类中依赖bean的创建方法就可以了。</p>
<h3 id="ComponentScan"><a href="#ComponentScan" class="headerlink" title="@ComponentScan"></a>@ComponentScan</h3><p>@ComponentScan的功能其实就是自动扫描并加载符合条件的组件（比如@Component和@Repository等）或者bean定义，最终将这些bean定义加载到IoC容器中。<br>我们可以通过basePackages等属性来细粒度的定制@ComponentScan自动扫描的范围，如果不指定，则默认Spring框架实现会从声明@ComponentScan所在类的package进行扫描。<br>注：所以SpringBoot的启动类最好是放在root package下，因为默认不指定basePackages。</p>
<h3 id="EnableAutoConfiguration"><a href="#EnableAutoConfiguration" class="headerlink" title="@EnableAutoConfiguration"></a>@EnableAutoConfiguration</h3><p><strong>对Enablexxx的解读</strong><br>个人感觉@EnableAutoConfiguration这个Annotation最为重要，所以放在最后来解读，大家是否还记得Spring框架提供的各种名字为@Enable开头的Annotation定义？比如@EnableScheduling、@EnableCaching、@EnableMBeanExport等，@EnableAutoConfiguration的理念和做事方式其实一脉相承，简单概括一下就是，借助@Import的支持，收集和注册特定场景相关的bean定义。<br>例如：<br>@EnableScheduling是通过@Import将Spring调度框架相关的bean定义都加载到IoC容器。<br>@EnableMBeanExport是通过@Import将JMX相关的bean定义加载到IoC容器。<br>而@EnableAutoConfiguration也是借助@Import的帮助，将所有符合自动配置条件的bean定义加载到IoC容器，仅此而已！<br><strong>@EnableAutoConfiguration的详细解读</strong><br>@EnableAutoConfiguration作为一个复合Annotation,其自身定义关键信息如下：</p>
<pre class=" language-less"><code class="language-less"><span class="token atrule">@SuppressWarnings<span class="token punctuation">(</span>"deprecation"<span class="token punctuation">)</span>
@Target<span class="token punctuation">(</span>ElementType.TYPE<span class="token punctuation">)</span>
@Retention<span class="token punctuation">(</span>RetentionPolicy.RUNTIME<span class="token punctuation">)</span>
@Documented
@Inherited
@AutoConfigurationPackage
@Import<span class="token punctuation">(</span>EnableAutoConfigurationImportSelector.class<span class="token punctuation">)</span>
public @interface EnableAutoConfiguration</span> <span class="token punctuation">{</span>
    <span class="token number">...</span>
<span class="token punctuation">}</span>
</code></pre>
<p>两个比较重要的注解：<br>@AutoConfigurationPackage：自动配置包<br>@Import: 导入自动配置的组件</p>
<p>AutoConfigurationPackage注解：</p>
<pre class=" language-java"><code class="language-java">     <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Registrar</span> <span class="token keyword">implements</span> <span class="token class-name">ImportBeanDefinitionRegistrar</span><span class="token punctuation">,</span> DeterminableImports <span class="token punctuation">{</span>
         <span class="token annotation punctuation">@Override</span>
         <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">registerBeanDefinitions</span><span class="token punctuation">(</span>AnnotationMetadata metadata<span class="token punctuation">,</span>
                 BeanDefinitionRegistry registry<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">register</span><span class="token punctuation">(</span>registry<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PackageImport</span><span class="token punctuation">(</span>metadata<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre>
<p>它其实是注册了一个Bean的定义。<br>new PackageImport(metadata).getPackageName()这一句返回了当前主程序类的 同级以及子级的包组件。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>@EnableAutoConfiguration自动配置的魔法骑士就变成了：从classpath中搜寻所有的META-INF/spring.factories配置文件，并将其中org.springframework.boot.autoconfigure.EnableutoConfiguration对应的配置项通过反射（Java Refletion）实例化为对应的标注了@Configuration的JavaConfig形式的IoC容器配置类，然后汇总为一个并加载到IoC容器。<br>SpringApplication的run方法的实现是我们本次旅程的主要线路，该方法的主要流程大体可以归纳如下：</p>
<h1 id="SpringApplication执行流程"><a href="#SpringApplication执行流程" class="headerlink" title="SpringApplication执行流程"></a>SpringApplication执行流程</h1><p>1） 如果我们使用的是SpringApplication的静态run方法，那么，这个方法里面首先要创建一个SpringApplication对象实例，然后调用这个创建好的SpringApplication的实例方法。在SpringApplication实例初始化的时候，它会提前做几件事情：  </p>
<pre class=" language-arduino"><code class="language-arduino">public static ConfigurableApplicationContext run(Object[] sources, String[] args) {
        return new SpringApplication(sources).run(args);
    }
</code></pre>
<p>一、决定是否应该创建一个为Web应用使用的ApplicationContext类型<br>根据classpath里面是否存在某个特征类（org.springframework.web.context.ConfigurableWebApplicationContext）来决定<br>使用SpringFactoriesLoader在应用的classpath中查找并加载所有可用的ApplicationContextInitializer。<br>使用SpringFactoriesLoader在应用的classpath中查找并加载所有可用的ApplicationListener。<br>推断并设置main方法的定义类。  </p>
<pre class=" language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">"unchecked"</span><span class="token punctuation">,</span> <span class="token string">"rawtypes"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> void <span class="token function">initialize</span><span class="token punctuation">(</span>Object<span class="token punctuation">[</span><span class="token punctuation">]</span> sources<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>sources <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> sources<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>sources<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>sources<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>webEnvironment <span class="token operator">=</span> <span class="token function">deduceWebEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setInitializers</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Collection<span class="token punctuation">)</span> <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span>
                ApplicationContextInitializer<span class="token punctuation">.</span>class<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setListeners</span><span class="token punctuation">(</span><span class="token punctuation">(</span>Collection<span class="token punctuation">)</span> <span class="token function">getSpringFactoriesInstances</span><span class="token punctuation">(</span>ApplicationListener<span class="token punctuation">.</span>class<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>mainApplicationClass <span class="token operator">=</span> <span class="token function">deduceMainApplicationClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>2） SpringApplication实例初始化完成并且完成设置后，就开始执行run方法的逻辑了，方法执行伊始，首先遍历执行所有通过SpringFactoriesLoader可以查找到并加载的SpringApplicationRunListener。调用它们的started()方法，告诉这些SpringApplicationRunListener，“嘿，SpringBoot应用要开始执行咯！”。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> ConfigurableApplicationContext <span class="token function">run</span><span class="token punctuation">(</span>String<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        StopWatch stopWatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        stopWatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        ConfigurableApplicationContext context <span class="token operator">=</span> null<span class="token punctuation">;</span>
        FailureAnalyzers analyzers <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token function">configureHeadlessProperty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        SpringApplicationRunListeners listeners <span class="token operator">=</span> <span class="token function">getRunListeners</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">starting</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            ApplicationArguments applicationArguments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultApplicationArguments</span><span class="token punctuation">(</span>
                    args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            ConfigurableEnvironment environment <span class="token operator">=</span> <span class="token function">prepareEnvironment</span><span class="token punctuation">(</span>listeners<span class="token punctuation">,</span>
                    applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
            Banner printedBanner <span class="token operator">=</span> <span class="token function">printBanner</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
            context <span class="token operator">=</span> <span class="token function">createApplicationContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            analyzers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FailureAnalyzers</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">prepareContext</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> environment<span class="token punctuation">,</span> listeners<span class="token punctuation">,</span> applicationArguments<span class="token punctuation">,</span>
                    printedBanner<span class="token punctuation">)</span><span class="token punctuation">;</span>
　　　　　　　<span class="token comment" spellcheck="true">// 核心点：会打印springboot的启动标志，直到server.port端口启动</span>
            <span class="token function">refreshContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">afterRefresh</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
            listeners<span class="token punctuation">.</span><span class="token function">finished</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
            stopWatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>logStartupInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">new</span> <span class="token class-name">StartupInfoLogger</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>mainApplicationClass<span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">logStarted</span><span class="token punctuation">(</span><span class="token function">getApplicationLog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> stopWatch<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">return</span> context<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">handleRunFailure</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> listeners<span class="token punctuation">,</span> analyzers<span class="token punctuation">,</span> ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span>ex<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>3） 创建并配置当前Spring Boot应用将要使用的Environment（包括配置要使用的PropertySource以及Profile）。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> ConfigurableEnvironment <span class="token function">prepareEnvironment</span><span class="token punctuation">(</span>
            SpringApplicationRunListeners listeners<span class="token punctuation">,</span>
            ApplicationArguments applicationArguments<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// Create and configure the environment</span>
        ConfigurableEnvironment environment <span class="token operator">=</span> <span class="token function">getOrCreateEnvironment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">configureEnvironment</span><span class="token punctuation">(</span>environment<span class="token punctuation">,</span> applicationArguments<span class="token punctuation">.</span><span class="token function">getSourceArgs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">environmentPrepared</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>webEnvironment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            environment <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EnvironmentConverter</span><span class="token punctuation">(</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token punctuation">.</span><span class="token function">convertToStandardEnvironmentIfNecessary</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> environment<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>4） 遍历调用所有SpringApplicationRunListener的environmentPrepared()的方法，告诉他们：“当前SpringBoot应用使用的Environment准备好了咯！”。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">environmentPrepared</span><span class="token punctuation">(</span>ConfigurableEnvironment environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>SpringApplicationRunListener listener <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            listener<span class="token punctuation">.</span><span class="token function">environmentPrepared</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>5） 如果SpringApplication的showBanner属性被设置为true，则打印banner。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> Banner <span class="token function">printBanner</span><span class="token punctuation">(</span>ConfigurableEnvironment environment<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bannerMode <span class="token operator">==</span> Banner<span class="token punctuation">.</span>Mode<span class="token punctuation">.</span>OFF<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        ResourceLoader resourceLoader <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader <span class="token operator">!=</span> null <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>resourceLoader
                <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">DefaultResourceLoader</span><span class="token punctuation">(</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        SpringApplicationBannerPrinter bannerPrinter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpringApplicationBannerPrinter</span><span class="token punctuation">(</span>
                resourceLoader<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>banner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>bannerMode <span class="token operator">==</span> Mode<span class="token punctuation">.</span>LOG<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> bannerPrinter<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>environment<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainApplicationClass<span class="token punctuation">,</span> logger<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> bannerPrinter<span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>environment<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>mainApplicationClass<span class="token punctuation">,</span> System<span class="token punctuation">.</span>out<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>6） 根据用户是否明确设置了applicationContextClass类型以及初始化阶段的推断结果，决定该为当前SpringBoot应用创建什么类型的ApplicationContext并创建完成，然后根据条件决定是否添加ShutdownHook，决定是否使用自定义的BeanNameGenerator，决定是否使用自定义的ResourceLoader，当然，最重要的，将之前准备好的Environment设置给创建好的ApplicationContext使用。<br>7） ApplicationContext创建好之后，SpringApplication会再次借助Spring-FactoriesLoader，查找并加载classpath中所有可用的ApplicationContext-Initializer，然后遍历调用这些ApplicationContextInitializer的initialize（applicationContext）方法来对已经创建好的ApplicationContext进行进一步的处理。  </p>
<pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token string">"rawtypes"</span><span class="token punctuation">,</span> <span class="token string">"unchecked"</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">applyInitializers</span><span class="token punctuation">(</span>ConfigurableApplicationContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>ApplicationContextInitializer initializer <span class="token operator">:</span> <span class="token function">getInitializers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> requiredType <span class="token operator">=</span> GenericTypeResolver<span class="token punctuation">.</span><span class="token function">resolveTypeArgument</span><span class="token punctuation">(</span>
                    initializer<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ApplicationContextInitializer<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Assert<span class="token punctuation">.</span><span class="token function">isInstanceOf</span><span class="token punctuation">(</span>requiredType<span class="token punctuation">,</span> context<span class="token punctuation">,</span> <span class="token string">"Unable to call initializer."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            initializer<span class="token punctuation">.</span><span class="token function">initialize</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>8） 遍历调用所有SpringApplicationRunListener的contextPrepared()方法。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">prepareContext</span><span class="token punctuation">(</span>ConfigurableApplicationContext context<span class="token punctuation">,</span>
            ConfigurableEnvironment environment<span class="token punctuation">,</span> SpringApplicationRunListeners listeners<span class="token punctuation">,</span>
            ApplicationArguments applicationArguments<span class="token punctuation">,</span> Banner printedBanner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        context<span class="token punctuation">.</span><span class="token function">setEnvironment</span><span class="token punctuation">(</span>environment<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">postProcessApplicationContext</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">applyInitializers</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">contextPrepared</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>logStartupInfo<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">logStartupInfo</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">logStartupProfileInfo</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment" spellcheck="true">// Add boot specific singleton beans</span>
        context<span class="token punctuation">.</span><span class="token function">getBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">registerSingleton</span><span class="token punctuation">(</span><span class="token string">"springApplicationArguments"</span><span class="token punctuation">,</span>
                applicationArguments<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>printedBanner <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            context<span class="token punctuation">.</span><span class="token function">getBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">registerSingleton</span><span class="token punctuation">(</span><span class="token string">"springBootBanner"</span><span class="token punctuation">,</span> printedBanner<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment" spellcheck="true">// Load the sources</span>
        Set<span class="token operator">&lt;</span>Object<span class="token operator">></span> sources <span class="token operator">=</span> <span class="token function">getSources</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        Assert<span class="token punctuation">.</span><span class="token function">notEmpty</span><span class="token punctuation">(</span>sources<span class="token punctuation">,</span> <span class="token string">"Sources must not be empty"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">load</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> sources<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>sources<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        listeners<span class="token punctuation">.</span><span class="token function">contextLoaded</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>9） 最核心的一步，将之前通过@EnableAutoConfiguration获取的所有配置以及其他形式的IoC容器配置加载到已经准备完毕的ApplicationContext。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">prepareAnalyzer</span><span class="token punctuation">(</span>ConfigurableApplicationContext context<span class="token punctuation">,</span>
            FailureAnalyzer analyzer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>analyzer <span class="token keyword">instanceof</span> <span class="token class-name">BeanFactoryAware</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>BeanFactoryAware<span class="token punctuation">)</span> analyzer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setBeanFactory</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getBeanFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>10） 遍历调用所有SpringApplicationRunListener的contextLoaded()方法。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoaded</span><span class="token punctuation">(</span>ConfigurableApplicationContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>SpringApplicationRunListener listener <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            listener<span class="token punctuation">.</span><span class="token function">contextLoaded</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>11） 调用ApplicationContext的refresh()方法，完成IoC容器可用的最后一道工序。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">refreshContext</span><span class="token punctuation">(</span>ConfigurableApplicationContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">refresh</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>registerShutdownHook<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                context<span class="token punctuation">.</span><span class="token function">registerShutdownHook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">AccessControlException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// Not allowed in some environments.</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>12） 查找当前ApplicationContext中是否注册有CommandLineRunner，如果有，则遍历执行它们。</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">callRunners</span><span class="token punctuation">(</span>ApplicationContext context<span class="token punctuation">,</span> ApplicationArguments args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        List<span class="token operator">&lt;</span>Object<span class="token operator">></span> runners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>Object<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        runners<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getBeansOfType</span><span class="token punctuation">(</span>ApplicationRunner<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        runners<span class="token punctuation">.</span><span class="token function">addAll</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getBeansOfType</span><span class="token punctuation">(</span>CommandLineRunner<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        AnnotationAwareOrderComparator<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span>runners<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>Object runner <span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">LinkedHashSet</span><span class="token operator">&lt;</span>Object<span class="token operator">></span><span class="token punctuation">(</span>runners<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>runner <span class="token keyword">instanceof</span> <span class="token class-name">ApplicationRunner</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">callRunner</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ApplicationRunner<span class="token punctuation">)</span> runner<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>runner <span class="token keyword">instanceof</span> <span class="token class-name">CommandLineRunner</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token function">callRunner</span><span class="token punctuation">(</span><span class="token punctuation">(</span>CommandLineRunner<span class="token punctuation">)</span> runner<span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<p>13） 正常情况下，遍历执行SpringApplicationRunListener的finished()方法、（如果整个过程出现异常，则依然调用所有SpringApplicationRunListener的finished()方法，只不过这种情况下会将异常信息一并传入处理）<br>去除事件通知点后，整个流程如下：  </p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">finished</span><span class="token punctuation">(</span>ConfigurableApplicationContext context<span class="token punctuation">,</span> Throwable exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>SpringApplicationRunListener listener <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>listeners<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">callFinishedListener</span><span class="token punctuation">(</span>listener<span class="token punctuation">,</span> context<span class="token punctuation">,</span> exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</code></pre>
<h1 id="Spring各jar包详解"><a href="#Spring各jar包详解" class="headerlink" title="Spring各jar包详解"></a>Spring各jar包详解</h1><p>spring.jar 是包含有完整发布模块的单个jar 包。但是不包括mock.jar,aspects.jar, spring-portlet.jar, and spring-hibernate2.jar。<br>spring-src.zip就是所有的源代码压缩包。<br>除了spring.jar 文件，Spring 还包括有其它21 个独立的jar 包，各自包含着对应的Spring组件，用户可以根据自己的需要来选择组合自己的jar 包，而不必引入整个spring.jar的所有类文件。</p>
<h1 id="1-spring-aop"><a href="#1-spring-aop" class="headerlink" title="1.spring-aop"></a>1.spring-aop</h1><p>这个jar 文件包含在应用中使用Spring 的AOP 特性时所需的类和源码级元数据支持。<br>使用基于AOP 的Spring特性，如声明型事务管理（Declarative Transaction Management），也要在应用里包含这个jar包。<br>外部依赖spring-core， (spring-beans，AOP Alliance， CGLIB，Commons Attributes)。<br>关于org.springframework.asm<br>Spring独立的asm程序, Spring2.5.6的时候需要asmJar包，3.0开始提供他自己独立的asmJar。 </p>
<h1 id="2-spring-aspects-jar"><a href="#2-spring-aspects-jar" class="headerlink" title="2.spring-aspects.jar"></a>2.spring-aspects.jar</h1><p>提供对AspectJ的支持，以便可以方便的将面向方面的功能集成进IDE中，比如Eclipse AJDT。<br>外部依赖。 </p>
<h1 id="3-spring-beans-jar"><a href="#3-spring-beans-jar" class="headerlink" title="3.spring-beans.jar"></a>3.spring-beans.jar</h1><p>这个jar 文件是所有应用都要用到的，它包含访问配置文件、创建和管理bean 以及进行Inversion ofControl / Dependency Injection（IoC/DI）操作相关的所有类。如果应用只需基本的IoC/DI 支持，引入spring-core.jar 及spring-beans.jar 文件就可以了。<br>外部依赖spring-core，(CGLIB)。</p>
<h1 id="4-spring-context-jar"><a href="#4-spring-context-jar" class="headerlink" title="4.spring-context.jar"></a>4.spring-context.jar</h1><p>这个jar 文件为Spring 核心提供了大量扩展。可以找到使用Spring ApplicationContext特性时所需的全部类，JDNI 所需的全部类，instrumentation组件以及校验Validation 方面的相关类。<br>外部依赖spring-beans, (spring-aop)。 </p>
<h1 id="5-spring-context-support"><a href="#5-spring-context-support" class="headerlink" title="5.spring-context-support"></a>5.spring-context-support</h1><p>包含支持缓存Cache（ehcache）、JCA、JMX、 邮件服务（Java Mail、COS Mail）、任务计划Scheduling（Timer、Quartz）方面的类。<br>以前的版本中应该是这个：spring-support.jar这个jar 文件包含支持UI模版（Velocity，FreeMarker，JasperReports），邮件服务，脚本服务(JRuby)，缓存Cache（EHCache），任务计划Scheduling（uartz）方面的类。<br>外部依赖spring-context, (spring-jdbc, Velocity,FreeMarker, JasperReports, BSH, Groovy,JRuby, Quartz, EHCache) </p>
<h1 id="6-spring-core-jar"><a href="#6-spring-core-jar" class="headerlink" title="6.spring-core.jar"></a>6.spring-core.jar</h1><p>这个jar 文件包含Spring 框架基本的核心工具类。Spring 其它组件要都要使用到这个包里的类，是其它组件的基本核心，当然你也可以在自己的应用系统中使用这些工具类。<br>外部依赖Commons Logging， (Log4J)。</p>
<h1 id="7-spring-expression"><a href="#7-spring-expression" class="headerlink" title="7.spring-expression"></a>7.spring-expression</h1><p>Spring表达式语言。</p>
<h1 id="8-spring-instrument"><a href="#8-spring-instrument" class="headerlink" title="8.spring-instrument"></a>8.spring-instrument</h1><p>Spring3.0对服务器的代理接口。</p>
<h1 id="9-spring-instrument-tomcat"><a href="#9-spring-instrument-tomcat" class="headerlink" title="9. spring-instrument-tomcat"></a>9. spring-instrument-tomcat</h1><p>Spring3.0对Tomcat的连接池的集成。</p>
<h1 id="10-spring-jdbc-jar"><a href="#10-spring-jdbc-jar" class="headerlink" title="10.spring-jdbc.jar"></a>10.spring-jdbc.jar</h1><p>这个jar 文件包含对Spring 对JDBC 数据访问进行封装的所有类。<br>外部依赖spring-beans，spring-dao。 </p>
<h1 id="11-spring-jms-jar"><a href="#11-spring-jms-jar" class="headerlink" title="11.spring-jms.jar"></a>11.spring-jms.jar</h1><p>这个jar包提供了对JMS 1.0.2/1.1的支持类。<br>外部依赖spring-beans，spring-dao，JMS API。<br>此外，还有下面这些以<code>spring-j*</code>开头的包，本人还没用过。</p>
<h1 id="spring-jmx-jar"><a href="#spring-jmx-jar" class="headerlink" title="spring-jmx.jar"></a>spring-jmx.jar</h1><p>这个jar包提供了对JMX 1.0/1.2的支持类。外部依赖spring-beans，spring-aop， JMX API。</p>
<h1 id="spring-jca-jar"><a href="#spring-jca-jar" class="headerlink" title="spring-jca.jar"></a>spring-jca.jar</h1><p>对JCA 1.0的支持。外部依赖spring-beans，spring-dao， JCA API。</p>
<h1 id="spring-jdo-jar"><a href="#spring-jdo-jar" class="headerlink" title="spring-jdo.jar"></a>spring-jdo.jar</h1><p>对JDO 1.0/2.0的支持。外部依赖spring-jdbc， JDO API， (spring-web)。</p>
<h1 id="spring-jpa-jar"><a href="#spring-jpa-jar" class="headerlink" title="spring-jpa.jar"></a>spring-jpa.jar</h1><p>对JPA 1.0的支持。外部依赖spring-jdbc， JPA API， (spring-web)。 </p>
<h1 id="12-spring-messaging"><a href="#12-spring-messaging" class="headerlink" title="12.spring-messaging"></a>12.spring-messaging</h1><p> spring-messaging模块为集成messaging api和消息协议提供支持<br>参考 <a href="http://www.cnblogs.com/davidwang456/p/4446796.html" target="_blank" rel="noopener">http://www.cnblogs.com/davidwang456/p/4446796.html</a></p>
<h1 id="13-spring-orm"><a href="#13-spring-orm" class="headerlink" title="13. spring-orm"></a>13. spring-orm</h1><p>包含Spring对DAO特性集进行了扩展，使其支持iBATIS、JDO、OJB、TopLink，  因为Hibernate已经独立成包了，现在不包含在这个包里了。这个jar文件里大部分的类都要依赖spring-dao.jar里的类，用这个包时你需要同时包含spring-dao.jar包。 </p>
<h1 id="14-spring-oxm"><a href="#14-spring-oxm" class="headerlink" title="14. spring-oxm"></a>14. spring-oxm</h1><p>Spring 对Object/XMl的映射支持,可以让Java与XML之间来回切换。</p>
<h1 id="15-spring-test"><a href="#15-spring-test" class="headerlink" title="15.spring-test"></a>15.spring-test</h1><p>对Junit等测试框架的简单封装。</p>
<h1 id="16-spring-tx"><a href="#16-spring-tx" class="headerlink" title="16.spring-tx"></a>16.spring-tx</h1><p>以前是在这里org.springframework.transaction<br>为JDBC、Hibernate、JDO、JPA、Beans等提供的一致的声明式和编程式事务管理支持。</p>
<h1 id="17-spring-web-jar"><a href="#17-spring-web-jar" class="headerlink" title="17.spring-web.jar"></a>17.spring-web.jar</h1><p>这个jar 文件包含Web 应用开发时，用到Spring 框架时所需的核心类，包括自动载入Web ApplicationContext 特性的类、Struts 与JSF 集成类、文件上传的支持类、Filter 类和大量工具辅助类。<br>外部依赖spring-context, Servlet API, (JSP API, JSTL,Commons FileUpload, COS)。<br>org.springframework.web.portlet<br>SpringMVC的增强。<br>org.springframework.web.servlet<br>对J2EE6.0的Servlet3.0的支持。<br>org.springframework.web.struts<br>Struts框架支持，可以更方便更容易的集成Struts框架。</p>
<h1 id="18-spring-webmvc-jar"><a href="#18-spring-webmvc-jar" class="headerlink" title="18.spring-webmvc.jar"></a>18.spring-webmvc.jar</h1><p>这个jar 文件包含Spring MVC 框架相关的所有类。包括框架的Servlets，Web MVC框架，控制器和视图支持。当然，如果你的应用使用了独立的MVC 框架，则无需这个JAR 文件里的任何类。<br>外部依赖spring-web, (spring-support，Tiles，iText，POI)。</p>
<h1 id="19-spring-webmvc-protlet"><a href="#19-spring-webmvc-protlet" class="headerlink" title="19.spring-webmvc-protlet"></a>19.spring-webmvc-protlet</h1><h1 id="20-spring-websocket"><a href="#20-spring-websocket" class="headerlink" title="20.spring-websocket"></a>20.spring-websocket</h1><h1 id="21-spring-dao"><a href="#21-spring-dao" class="headerlink" title="21.spring-dao"></a>21.spring-dao</h1><p>这个jar文件包含Spring DAO、Spring Transaction进行数据访问的所有类。为了使用声明型事务支持，还需在自己的应用里包含spring-aop.jar。<br>关于spring-dao.jar（3.x版本里，没有发现这个包）<br>外部依赖spring-core，(spring-aop， spring-context， JTA API)。</p>
<h1 id="22-spring-remoting"><a href="#22-spring-remoting" class="headerlink" title="22.spring-remoting"></a>22.spring-remoting</h1><p>这个jar文件包含支持EJB、远程调用Remoting（RMI、Hessian、Burlap、Http Invoker、JAX-RPC）方面的类。<br>外部依赖spring-aop， (spring-context，spring-web，Hessian，Burlap，JAX-RPC，EJB API)。</p>
<h1 id="23-spring-portlet-jar"><a href="#23-spring-portlet-jar" class="headerlink" title="23.spring-portlet.jar"></a>23.spring-portlet.jar</h1><p>spring自己实现的一个类似Spring MVC的框架。包括一个MVC框架和控制器。<br>外部依赖spring-web， Portlet API，(spring-webmvc)。<br>Spring与其他框架整合的jar包</p>
<h1 id="spring-hibernate2-jar"><a href="#spring-hibernate2-jar" class="headerlink" title="spring-hibernate2.jar"></a>spring-hibernate2.jar</h1><p>对Hibernate 2.1的支持，已经不建议使用。外部依赖spring-jdbc，Hibernate2，(spring-web)。</p>
<h1 id="spring-hibernate3-jar"><a href="#spring-hibernate3-jar" class="headerlink" title="spring-hibernate3.jar"></a>spring-hibernate3.jar</h1><p>对Hibernate 3.0/3.1/3.2的支持。外部依赖spring-jdbc，Hibernate3，(spring-web)。<br>目前的Spring对Hibernate的支持比较好，直接用spring-orm包即可，一般不用单独添加spring-hibernate包。</p>
<h1 id="spring-toplink-jar"><a href="#spring-toplink-jar" class="headerlink" title="spring-toplink.jar"></a>spring-toplink.jar</h1><p>对TopLink框架的支持。外部依赖spring-jdbc，TopLink。</p>
<h1 id="spring-ibatis-jar"><a href="#spring-ibatis-jar" class="headerlink" title="spring-ibatis.jar"></a>spring-ibatis.jar</h1><p>对iBATIS SQL Maps的支持。外部依赖spring-jdbc，iBATIS SQL Maps。</p>
<h1 id="spring-jmx-jar-1"><a href="#spring-jmx-jar-1" class="headerlink" title="spring-jmx.jar"></a>spring-jmx.jar</h1><p>这个jar包提供了对JMX 1.0/1.2的支持类。<br>外部依赖spring-beans，spring-aop， JMXAPI。</p>
<h1 id="spring-jms-jar"><a href="#spring-jms-jar" class="headerlink" title="spring-jms.jar"></a>spring-jms.jar</h1><p>这个jar包提供了对JMS 1.0.2/1.1的支持类。<br>外部依赖spring-beans，spring-dao，JMS API。</p>
<h1 id="spring-jca-jar-1"><a href="#spring-jca-jar-1" class="headerlink" title="spring-jca.jar"></a>spring-jca.jar</h1><p>对JCA 1.0的支持。<br>外部依赖spring-beans，spring-dao， JCAAPI。</p>
<h1 id="spring-jdo-jar-1"><a href="#spring-jdo-jar-1" class="headerlink" title="spring-jdo.jar"></a>spring-jdo.jar</h1><p>对JDO 1.0/2.0的支持。<br>外部依赖spring-jdbc， JDO API， (spring-web)。</p>
<h1 id="spring-jpa-jar-1"><a href="#spring-jpa-jar-1" class="headerlink" title="spring-jpa.jar"></a>spring-jpa.jar</h1><p>对JPA 1.0的支持。<br>外部依赖spring-jdbc， JPA API，(spring-web)<br>另外的三个包。</p>
<h1 id="spring-mock-jar"><a href="#spring-mock-jar" class="headerlink" title="spring-mock.jar"></a>spring-mock.jar</h1><p>这个jar 文件包含Spring 一整套mock 类来辅助应用的测试。Spring 测试套件使用了其中大量mock 类，这样测试就更加简单。模拟HttpServletRequest 和HttpServletResponse 类在Web 应用单元测试是很方便的。并且提供了对JUnit的支持。<br>外部依赖spring-core。<br>WEAVER JARS (dist/weavers)说明。</p>
<h1 id="spring-agent-jar"><a href="#spring-agent-jar" class="headerlink" title="spring-agent.jar"></a>spring-agent.jar</h1><p>Spring的InstrumentationSavingAgent (为InstrumentationLoadTimeWeaver)，一个设备代理包，可以参考JDK1.5的Instrumentation功能获得更多信息。<br>外部依赖none (for use at JVM startup:”-javaagent:spring-agent.jar”)。</p>
<h1 id="spring-tomcat-weaver-jar"><a href="#spring-tomcat-weaver-jar" class="headerlink" title="spring-tomcat-weaver.jar"></a>spring-tomcat-weaver.jar</h1><p>扩展Tomcat的ClassLoader，使其可以使用instrumentation（设备）类。<br>外部依赖none (for deployment into Tomcat’s”server/lib” directory)。<br>#<br>如果需要使用JSP语言作为Spring’s web MVC tags的参数，则需要JSP 2.0的支持。或者选择Jakarta的JSTL (standard.jar)。<br>如何选择这些发布包，决定选用哪些发布包其实相当简单。<br>如果你正在构建Web 应用并将全程使用Spring，那么最好就使用单个全部的spring.jar 文件；<br>如果你的应用仅仅用到简单的Inversion ofControl / Dependency Injection（IoC/DI）容器，那么只需spring-core.jar与spring-beans.jar 即可；<br>如果你对发布的大小要求很高，那么就得精挑细选了，只取包含自己所需特性的jar 文件了。<br>采用独立的发布包你可以避免包含自己的应用不需要的全部类。当然你可以采用其它的一些工具来设法令整个应用包变小，节省空间的重点在于准确地找出自己所需的Spring 依赖类，然后合并所需的类与包就可以了。<br>Eclispe 有个插件叫ClassPathHelper 可以帮你找找所依赖的类。<br>Spring AOP：Spring的面向切面编程，提供AOP（面向切面编程）的实现<br>Spring Aspects：Spring提供的对AspectJ框架的整合<br>Spring Beans：Spring IOC的基础实现，包含访问配置文件、创建和管理bean等。<br>Spring Context：在基础IOC功能上提供扩展服务，此外还提供许多企业级服务的支持，有邮件服务、任务调度、JNDI定位，EJB集成、远程访问、缓存以及多种视图层框架的支持。<br>Spring ContextSupport：Springcontext的扩展支持，用于MVC方面。<br>Spring Core：Spring的核心工具包<br>Spring expression：Spring表达式语言<br>Spring FrameworkBom：<br>Spring Instrument：Spring对服务器的代理接口<br>Spring InstrumentTomcat：Spring对tomcat连接池的集成<br>Spring JDBC：对JDBC 的简单封装<br>Spring JMS：为简化jms api的使用而做的简单封装<br>Spring Messaging：<br>Spring orm：整合第三方的orm实现，如hibernate，ibatis，jdo以及spring 的jpa实现<br>Spring oxm：Spring对于object/xml映射的支持，可以让JAVA与XML之间来回切换<br>Spring test：对JUNIT等测试框架的简单封装<br>Spring tx：为JDBC、Hibernate、JDO、JPA等提供的一致的声明式和编程式事务管理。<br>Spring web：包含Web应用开发时，用到Spring框架时所需的核心类，包括自动载入WebApplicationContext特性的类、Struts与JSF集成类、文件上传的支持类、Filter类和大量工具辅助类。<br>Spring webmvc：包含SpringMVC框架相关的所有类。包含国际化、标签、Theme、视图展现的FreeMarker、JasperReports、Tiles、Velocity、XSLT相关类。当然，如果你的应用使用了独立的MVC框架，则无需这个JAR文件里的任何类。<br>Spring webmvcportlet：SpringMVC的增强</p>
<h1 id="spring-boot-starter-web"><a href="#spring-boot-starter-web" class="headerlink" title="spring-boot-starter-web"></a>spring-boot-starter-web</h1><p>对全栈web开发的支持， 包括Tomcat和spring-webmvc</p>
<h1 id="spring-boot-devtools"><a href="#spring-boot-devtools" class="headerlink" title="spring-boot-devtools"></a>spring-boot-devtools</h1><p>最重要的功能就是自动应用代码更改到最新的App上面去。原理是在发现代码有更改之后，重新启动应用，但是比速度比手动停止后再启动还要更快，更快指的不是节省出来的手工操作的时间。其深层原理是使用了两个ClassLoader，一个Classloader加载那些不会改变的类（第三方Jar包），另一个ClassLoader加载会更改的类，称为  restart ClassLoader,这样在有代码更改的时候，原来的restartClassLoader 被丢弃，重新创建一个restartClassLoader，由于需要加载的类相比较少，所以实现了较快的重启时间（5秒以内）。</p>
<h1 id="spring-boot-starter-jdbc"><a href="#spring-boot-starter-jdbc" class="headerlink" title="spring-boot-starter-jdbc"></a>spring-boot-starter-jdbc</h1><p>默认情况下，当我们没有配置任何DataSource,SpringBoot会为我们自动配置一个DataSource，这种自动配置的方式一般适用于测试，开发还是自己配置一个DataSource的实例比较好。<br>如果我们的工程只依赖一个数据库，那么，使用DataSource自动配置模块提供的参数是最方便的：</p>
<pre class=" language-java"><code class="language-java">spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>url<span class="token operator">=</span>jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token punctuation">{</span>datasource host<span class="token punctuation">}</span><span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span><span class="token punctuation">{</span>databaseName<span class="token punctuation">}</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>username<span class="token operator">=</span><span class="token punctuation">{</span>database username<span class="token punctuation">}</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>passwd<span class="token operator">=</span><span class="token punctuation">{</span>database passwd<span class="token punctuation">}</span>
</code></pre>
<p>还会自动配置的有：JdbcTemplate DateSourceTransactionManager等，我们只要在使用的时候注入（@Autowired）就好了<br>此外，SpringBoot还支持的数据库有spring-boot-data-jpa spring-boot-data-mongodb</p>
<h1 id="spring-boot-starter-redis"><a href="#spring-boot-starter-redis" class="headerlink" title="spring-boot-starter-redis"></a>spring-boot-starter-redis</h1><h1 id="mysql-connector-java"><a href="#mysql-connector-java" class="headerlink" title="mysql-connector-java"></a>mysql-connector-java</h1><p>mysql驱动包</p>
<h1 id="commons-net"><a href="#commons-net" class="headerlink" title="commons-net"></a>commons-net</h1><p>实现FTP文件上传与下载工具类</p>
<h1 id="commons-io"><a href="#commons-io" class="headerlink" title="commons-io"></a>commons-io</h1><p>commons-io是一款处理io流的工具，封装了很多处理io流和文件的方法，可以大大简化我们处理io流和操作文件的代码</p>
<h1 id="maven-compiler-plugin"><a href="#maven-compiler-plugin" class="headerlink" title="maven-compiler-plugin"></a>maven-compiler-plugin</h1><p>maven是个项目管理工具，如果我们不告诉它我们的代码要使用什么样的jdk版本编译的话，它就会用maven-compiler-plugin默认的jdk版本来进行处理，这样就容易出现版本不匹配，以至于可能导致编译不通过的问题。<br>maven的默认编译使用的jdk版本貌似很低，使用maven-compiler-plugin插件可以指定项目源码的jdk版本，编译后的jdk版本，以及编码。<br>maven的默认编译使用的jdk版本貌似很低，使用maven-compiler-plugin插件可以指定项目源码的jdk版本，编译后的jdk版本，以及编码。</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>plugin<span class="token operator">></span>                                                                                                                                      
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定maven编译的jdk版本<span class="token punctuation">,</span>如果不指定<span class="token punctuation">,</span>maven3默认用jdk <span class="token number">1.5</span> maven2默认用jdk1<span class="token number">.3</span> <span class="token operator">--</span><span class="token operator">></span>                                                                           
    <span class="token operator">&lt;</span>groupId<span class="token operator">></span>org<span class="token punctuation">.</span>apache<span class="token punctuation">.</span>maven<span class="token punctuation">.</span>plugins<span class="token operator">&lt;</span><span class="token operator">/</span>groupId<span class="token operator">></span>                                                                                               
    <span class="token operator">&lt;</span>artifactId<span class="token operator">></span>maven<span class="token operator">-</span>compiler<span class="token operator">-</span>plugin<span class="token operator">&lt;</span><span class="token operator">/</span>artifactId<span class="token operator">></span>                                                                                            
    <span class="token operator">&lt;</span>version<span class="token operator">></span><span class="token number">3.1</span><span class="token operator">&lt;</span><span class="token operator">/</span>version<span class="token operator">></span>                                                                                                                    
    <span class="token operator">&lt;</span>configuration<span class="token operator">></span>                                                                                                                           
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 一般而言，target与source是保持一致的，但是，有时候为了让程序能在其他版本的jdk中运行<span class="token punctuation">(</span>对于低版本目标jdk，源代码中不能使用低版本jdk中不支持的语法<span class="token punctuation">)</span>，会存在target不同于source的情况 <span class="token operator">--</span><span class="token operator">></span>                    
        <span class="token operator">&lt;</span>source<span class="token operator">></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>source<span class="token operator">></span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 源代码使用的JDK版本 <span class="token operator">--</span><span class="token operator">></span>                                                                                             
        <span class="token operator">&lt;</span>target<span class="token operator">></span><span class="token number">1.8</span><span class="token operator">&lt;</span><span class="token operator">/</span>target<span class="token operator">></span> <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 需要生成的目标<span class="token keyword">class</span>文件的编译版本 <span class="token operator">--</span><span class="token operator">></span>                                                                                     
        <span class="token operator">&lt;</span>encoding<span class="token operator">></span>UTF<span class="token operator">-</span><span class="token number">8</span><span class="token operator">&lt;</span><span class="token operator">/</span>encoding<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 字符集编码 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>skipTests<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>skipTests<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 跳过测试 <span class="token operator">--</span><span class="token operator">></span>                                                                             
        <span class="token operator">&lt;</span>verbose<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>verbose<span class="token operator">></span>
        <span class="token operator">&lt;</span>showWarnings<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>showWarnings<span class="token operator">></span>                                                                                                               
        <span class="token operator">&lt;</span>fork<span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>fork<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 要使compilerVersion标签生效，还需要将fork设为<span class="token boolean">true</span>，用于明确表示编译版本配置的可用 <span class="token operator">--</span><span class="token operator">></span>                                                        
        <span class="token operator">&lt;</span>executable<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> path<span class="token operator">-</span>to<span class="token operator">-</span>javac <span class="token operator">--</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>executable<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 使用指定的javac命令，例如：<span class="token operator">&lt;</span>executable<span class="token operator">></span>$<span class="token punctuation">{</span>JAVA_1_4_HOME<span class="token punctuation">}</span><span class="token operator">/</span>bin<span class="token operator">/</span>javac<span class="token operator">&lt;</span><span class="token operator">/</span>executable<span class="token operator">></span> <span class="token operator">--</span><span class="token operator">></span>           
        <span class="token operator">&lt;</span>compilerVersion<span class="token operator">></span><span class="token number">1.3</span><span class="token operator">&lt;</span><span class="token operator">/</span>compilerVersion<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定插件将使用的编译器的版本 <span class="token operator">--</span><span class="token operator">></span>                                                                         
        <span class="token operator">&lt;</span>meminitial<span class="token operator">></span>128m<span class="token operator">&lt;</span><span class="token operator">/</span>meminitial<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 编译器使用的初始内存 <span class="token operator">--</span><span class="token operator">></span>                                                                                      
        <span class="token operator">&lt;</span>maxmem<span class="token operator">></span>512m<span class="token operator">&lt;</span><span class="token operator">/</span>maxmem<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 编译器使用的最大内存 <span class="token operator">--</span><span class="token operator">></span>                                                                                              
        <span class="token operator">&lt;</span>compilerArgument<span class="token operator">></span><span class="token operator">-</span>verbose <span class="token operator">-</span>bootclasspath $<span class="token punctuation">{</span>java<span class="token punctuation">.</span>home<span class="token punctuation">}</span>\lib\rt<span class="token punctuation">.</span>jar<span class="token operator">&lt;</span><span class="token operator">/</span>compilerArgument<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 这个选项用来传递编译器自身不包含但是却支持的参数选项 <span class="token operator">--</span><span class="token operator">></span>               
    <span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">></span>                                                                                                                          
<span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">></span>    
</code></pre>
<h1 id="spring-boot-maven-plugin"><a href="#spring-boot-maven-plugin" class="headerlink" title="spring-boot-maven-plugin"></a>spring-boot-maven-plugin</h1><p>Spring Boot的Maven插件（Spring Boot Maven plugin）能够以Maven的方式为应用提供Spring Boot的支持，即为Spring Boot应用提供了执行Maven操作的可能。<br>Spring Boot Maven plugin能够将Spring Boot应用打包为可执行的jar或war文件，然后以通常的方式运行Spring Boot应用。</p>
<h1 id="maven-resources-plugin"><a href="#maven-resources-plugin" class="headerlink" title="maven-resources-plugin"></a>maven-resources-plugin</h1><p>为了使项目结构更为清晰，Maven区别对待Java代码文件和资源文件，maven-compiler-plugin用来编译Java代码，maven-resources-plugin则用来处理资源文件。<br>默认的主资源文件目录是src/main/resources，很多用户会需要添加额外的资源文件目录，这个时候就可以通过配置maven-resources-plugin来实现</p>
<h1 id="springboot配置数据库连接池的三种方法"><a href="#springboot配置数据库连接池的三种方法" class="headerlink" title="springboot配置数据库连接池的三种方法"></a>springboot配置数据库连接池的三种方法</h1><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>itcast<span class="token punctuation">.</span>config<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Value<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * @author: HuYi.Zhang
 * @create: 2018-05-20 09:36
 **/</span>
 <span class="token annotation punctuation">@Configuration</span>
 <span class="token annotation punctuation">@PropertySource</span><span class="token punctuation">(</span><span class="token string">"classpath:jdbc.properties"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcConfig</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${jdbc.driverClassName}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String driverClassName<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${jdbc.url}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String url<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${jdbc.username}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String username<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"${jdbc.password}"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> String password<span class="token punctuation">;</span>

  <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> DataSource <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        DruidDataSource dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span>driverClassName<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<p>然后在controller文件autowired DateSource即可</p>
<pre class=" language-java"><code class="language-java"> <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> DateSource datasource<span class="token punctuation">;</span>
</code></pre>
<h1 id="另一种"><a href="#另一种" class="headerlink" title="另一种"></a>另一种</h1><p>配置application.yml</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>itcast<span class="token punctuation">.</span>config<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Value<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * @author: HuYi.Zhang
 * @create: 2018-05-20 09:36
 **/</span>
 <span class="token annotation punctuation">@Configuration</span>
 <span class="token annotation punctuation">@EnableConfgurationPropertirs</span><span class="token punctuation">(</span>JdbcProperties<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcConfig</span> <span class="token punctuation">{</span>
  <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> DataSource <span class="token function">dataSource</span><span class="token punctuation">(</span>JdbcProperties pro<span class="token punctuation">)</span><span class="token punctuation">{</span>
        DruidDataSource dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setDriverClassName</span><span class="token punctuation">(</span>pro<span class="token punctuation">.</span><span class="token function">getDriverClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUrl</span><span class="token punctuation">(</span>pro<span class="token punctuation">.</span><span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setUsername</span><span class="token punctuation">(</span>pro<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        dataSource<span class="token punctuation">.</span><span class="token function">setPassword</span><span class="token punctuation">(</span>pro<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>itcast<span class="token punctuation">.</span>config<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>ConfigurationProperties<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * @author: HuYi.Zhang
 * @create: 2018-05-20 09:54
 **/</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"jdbc"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcProperties</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> String driverClassName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String password<span class="token punctuation">;</span>

    <span class="token keyword">public</span> String <span class="token function">getDriverClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> driverClassName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDriverClassName</span><span class="token punctuation">(</span>String driverClassName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>driverClassName <span class="token operator">=</span> driverClassName<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getUrl</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> url<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUrl</span><span class="token punctuation">(</span>String url<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>url <span class="token operator">=</span> url<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> username<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setUsername</span><span class="token punctuation">(</span>String username<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> String <span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setPassword</span><span class="token punctuation">(</span>String password<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>password <span class="token operator">=</span> password<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>或者<br>导入lombok包自动生成getter setter</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>itcast<span class="token punctuation">.</span>config<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>ConfigurationProperties<span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">/**
 * @author: HuYi.Zhang
 * @create: 2018-05-20 09:54
 **/</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"jdbc"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcProperties</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> String driverClassName<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String url<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String username<span class="token punctuation">;</span>
    <span class="token keyword">private</span> String password<span class="token punctuation">;</span>
</code></pre>
<h1 id="第三种"><a href="#第三种" class="headerlink" title="第三种"></a>第三种</h1><p>配置application.yml</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> cn<span class="token punctuation">.</span>itcast<span class="token punctuation">.</span>config<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>ConfigurationProperties<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Bean<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>

<span class="token keyword">import</span> javax<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DataSource<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * @author: HuYi.Zhang
 * @create: 2018-05-20 09:51
 **/</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JdbcConfig2</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"jdbc"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> DataSource <span class="token function">dataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        DruidDataSource dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre>
<h1 id="SpringBoot配置文件"><a href="#SpringBoot配置文件" class="headerlink" title="SpringBoot配置文件"></a>SpringBoot配置文件</h1><h1 id="如果application-properties和application-yaml文件同时存在"><a href="#如果application-properties和application-yaml文件同时存在" class="headerlink" title="如果application.properties和application.yaml文件同时存在"></a>如果application.properties和application.yaml文件同时存在</h1><p>则spring会取这两个文件的并集，如果有冲突的，以properties为准</p>
<h2 id="application-properties文件"><a href="#application-properties文件" class="headerlink" title="application.properties文件"></a><strong>application.properties文件</strong></h2><p>application.properties中配置通用内容，并设置spring.profiles.active=dev，以开发环境为默认配置<br> application-{profile}.properties中配置各个环境不同的内容<br>通过命令行方式去激活不同环境的配置。<br>application-dev.properties：开发环境<br> application-test.properties：测试环境<br> application-prod.properties：生产环境<br>application.properties中设置spring.profiles.active=dev，就是说默认以dev环境设置</p>
<pre class=" language-javascript"><code class="language-javascript">spring<span class="token punctuation">.</span>profiles<span class="token punctuation">.</span>active<span class="token operator">=</span>dev
#Tomcat\u7aef\u53e3
server<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">8080</span>
server<span class="token punctuation">.</span>servlet<span class="token operator">-</span>path<span class="token operator">=</span><span class="token operator">/</span>
# \u4f1a\u8bdd\u8d85\u65f6\uff08\u79d2\uff09\u3002
server<span class="token punctuation">.</span>session<span class="token punctuation">.</span>timeout<span class="token operator">=</span><span class="token number">3600</span>
# \u4f1a\u8bddcookie\u7684\u6700\u5927\u65f6\u957f\uff08\u4ee5\u79d2\u4e3a\u5355\u4f4d\uff09\u3002
server<span class="token punctuation">.</span>session<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span>max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">3600</span>

#\u89c6\u56fe\u89e3\u6790
spring<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>view<span class="token punctuation">.</span>prefix<span class="token operator">=</span><span class="token operator">/</span>WEB<span class="token operator">-</span>INF<span class="token regex">/pages/</span>
spring<span class="token punctuation">.</span>mvc<span class="token punctuation">.</span>view<span class="token punctuation">.</span>suffix<span class="token operator">=</span><span class="token punctuation">.</span>jsp

#mysql\u914d\u7f6e
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>url<span class="token operator">=</span>jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token punctuation">:</span><span class="token number">3306</span><span class="token operator">/</span>pipi<span class="token operator">?</span>useUnicode<span class="token operator">=</span><span class="token boolean">true</span><span class="token operator">&amp;</span>characterEncoding<span class="token operator">=</span>UTF<span class="token number">-8</span><span class="token operator">&amp;</span>useSSL<span class="token operator">=</span><span class="token boolean">false</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>type<span class="token operator">=</span>com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>druid<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>DruidDataSource
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>username<span class="token operator">=</span>root
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>password<span class="token operator">=</span><span class="token number">135246</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>driverClassName<span class="token operator">=</span>com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
spring<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>database<span class="token operator">=</span>mysql

#Mybatis\u626b\u63cf
mybatis<span class="token punctuation">.</span>mapper<span class="token operator">-</span>locations<span class="token operator">=</span>classpath<span class="token operator">*</span><span class="token punctuation">:</span>mapper<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>xml
#\u8d77\u522b\u540d\u3002\u53ef\u7701\u7565\u5199mybatis\u7684xml\u4e2d\u7684resultType\u7684\u5168\u8def\u5f84
mybatis<span class="token punctuation">.</span>type<span class="token operator">-</span>aliases<span class="token operator">-</span><span class="token keyword">package</span><span class="token operator">=</span>com<span class="token punctuation">.</span>pipi<span class="token punctuation">.</span>dao<span class="token punctuation">.</span>pojo

#\u65e5\u5fd7\u7ea7\u522b
#logging<span class="token punctuation">.</span>level<span class="token punctuation">.</span>org<span class="token punctuation">.</span>springframework<span class="token operator">=</span>INFO

#\u5728application<span class="token punctuation">.</span>properties\u6587\u4ef6\u4e2d\u5f15\u5165\u65e5\u5fd7\u914d\u7f6e\u6587\u4ef6  
#<span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">=</span>  log  <span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">===</span><span class="token operator">==</span>  
logging<span class="token punctuation">.</span>config<span class="token operator">=</span>classpath<span class="token punctuation">:</span>logback<span class="token operator">-</span>boot<span class="token punctuation">.</span>xml

#pagehelper\u5206\u9875\u63d2\u4ef6\u914d\u7f6e
pagehelper<span class="token punctuation">.</span>helperDialect<span class="token operator">=</span>mysql
pagehelper<span class="token punctuation">.</span>reasonable<span class="token operator">=</span><span class="token boolean">true</span>
pagehelper<span class="token punctuation">.</span>supportMethodsArguments<span class="token operator">=</span><span class="token boolean">true</span>
pagehelper<span class="token punctuation">.</span>params<span class="token operator">=</span>count<span class="token operator">=</span>countSql

#redis
spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>host<span class="token operator">=</span>localhost
spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>password<span class="token operator">=</span>
spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">6379</span>
spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>max<span class="token operator">-</span>idle<span class="token operator">=</span><span class="token number">8</span>
spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>min<span class="token operator">-</span>idle<span class="token operator">=</span><span class="token number">0</span>
spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>max<span class="token operator">-</span>active<span class="token operator">=</span><span class="token number">8</span>
spring<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>pool<span class="token punctuation">.</span>max<span class="token operator">-</span>wait<span class="token operator">=</span><span class="token operator">-</span><span class="token number">1</span>
</code></pre>
<pre class=" language-java"><code class="language-java">#config tomcat port
server<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">8848</span>
#config database datasource
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>url<span class="token operator">=</span>jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">3306</span><span class="token operator">/</span>db_api
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>username<span class="token operator">=</span>root
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>password<span class="token operator">=</span><span class="token number">135246</span>
spring<span class="token punctuation">.</span>datasource<span class="token punctuation">.</span>driverClassName<span class="token operator">=</span>com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
spring<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span>database <span class="token operator">=</span> mysql

#Mybatis扫描
mybatis<span class="token punctuation">.</span>mapper<span class="token operator">-</span>locations<span class="token operator">=</span>classpath<span class="token operator">*</span><span class="token operator">:</span>mapper<span class="token operator">/</span><span class="token operator">*</span><span class="token punctuation">.</span>xml
#起别名。可省略写mybatis的xml中的resultType的全路径
mybatis<span class="token punctuation">.</span>type<span class="token operator">-</span>aliases<span class="token operator">-</span><span class="token keyword">package</span><span class="token operator">=</span>com<span class="token punctuation">.</span>twq<span class="token punctuation">.</span>springbootssm<span class="token punctuation">.</span>domain
</code></pre>
<h1 id="SpringApplicationBuilder"><a href="#SpringApplicationBuilder" class="headerlink" title="SpringApplicationBuilder"></a>SpringApplicationBuilder</h1><pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>pipi<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>SpringApplication<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>builder<span class="token punctuation">.</span>SpringApplicationBuilder<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>support<span class="token punctuation">.</span>SpringBootServletInitializer<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>pipi<span class="token punctuation">.</span>config<span class="token punctuation">.</span>PipiApplication<span class="token punctuation">;</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token keyword">extends</span> <span class="token class-name">SpringBootServletInitializer</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        SpringApplication<span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span>PipiApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">//该方法的作用是可以把项目打包成war包</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> SpringApplicationBuilder <span class="token function">configure</span><span class="token punctuation">(</span>SpringApplicationBuilder builder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// 设置启动类，用于独立的Tomcat入口</span>
        <span class="token comment" spellcheck="true">// 应为springboot没有web.xml文件</span>
        <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">sources</span><span class="token punctuation">(</span>PipiApplication<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h1 id="SpringBoot启动类注解"><a href="#SpringBoot启动类注解" class="headerlink" title="SpringBoot启动类注解"></a>SpringBoot启动类注解</h1><h1 id="Configuration-Bean"><a href="#Configuration-Bean" class="headerlink" title="@Configuration+@Bean"></a>@Configuration+@Bean</h1><p>@Configuration用于定义配置类，可替换xml配置文件，被注解的类内部包含有一个或多个被@Bean注解的方法，这些方法将会被AnnotationConfigApplicationContext或AnnotationConfigWebApplicationContext类进行扫描，并用于构建bean定义，初始化Spring容器</p>
<h1 id="ComponentScan-basePackages-“com-pipi”"><a href="#ComponentScan-basePackages-“com-pipi”" class="headerlink" title="@ComponentScan(basePackages = “com.pipi”)"></a>@ComponentScan(basePackages = “com.pipi”)</h1><p>不声明出来只有SpringBootApplication注解默认只扫描和主类处于同包下的Class  </p>
<h1 id="EnableTransactionManagement"><a href="#EnableTransactionManagement" class="headerlink" title="@EnableTransactionManagement"></a>@EnableTransactionManagement</h1><p>Spring Boot 使用的事务非常简单，首先使用注解 @EnableTransactionManagement 开启事务支持后，然后在访问数据库的Service方法上添加注解 @Transactional 便可</p>
<h1 id="MapperScan-basePackages-”com-pipi-dao-mapper”"><a href="#MapperScan-basePackages-”com-pipi-dao-mapper”" class="headerlink" title="@MapperScan(basePackages=”com.pipi.dao.mapper”)"></a>@MapperScan(basePackages=”com.pipi.dao.mapper”)</h1><h1 id="SpringBootApplication-Configuration-ComponentScan-EnableAutoConfiguration"><a href="#SpringBootApplication-Configuration-ComponentScan-EnableAutoConfiguration" class="headerlink" title="@SpringBootApplication=+@Configuration+@ComponentScan+@EnableAutoConfiguration"></a>@SpringBootApplication=+@Configuration+@ComponentScan+@EnableAutoConfiguration</h1><p><a href="https://viabcde.github.io/2018/07/01/2018-07-01-@springApplication/">SpringBootApplication注解</a></p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>pipi<span class="token punctuation">.</span>config<span class="token punctuation">;</span>

<span class="token keyword">import</span> org<span class="token punctuation">.</span>mybatis<span class="token punctuation">.</span>spring<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>MapperScan<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span>SpringBootApplication<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>ServletRegistrationBean<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Bean<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>ComponentScan<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Configuration<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>transaction<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>EnableTransactionManagement<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>DispatcherServlet<span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">/**
 * 主配置
 * 
 * @author yubaojin
 *
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@ComponentScan</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">"com.pipi"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@EnableTransactionManagement</span>
<span class="token annotation punctuation">@MapperScan</span><span class="token punctuation">(</span>basePackages<span class="token operator">=</span><span class="token string">"com.pipi.dao.mapper"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PipiApplication</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> ServletRegistrationBean <span class="token function">dispatcherRegistration</span><span class="token punctuation">(</span>DispatcherServlet dispatcherServlet<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ServletRegistrationBean reg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletRegistrationBean</span><span class="token punctuation">(</span>dispatcherServlet<span class="token punctuation">)</span><span class="token punctuation">;</span>
        reg<span class="token punctuation">.</span><span class="token function">getUrlMappings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        reg<span class="token punctuation">.</span><span class="token function">addUrlMappings</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> reg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<h1 id="ConfigurationProperties注解"><a href="#ConfigurationProperties注解" class="headerlink" title="ConfigurationProperties注解"></a>ConfigurationProperties注解</h1><p>@ConfigurationProperties注解主要用来把properties配置文件转化为bean来使用的</p>
<p>而@EnableConfigurationProperties注解的作用：<br>使@ConfigurationProperties注解生效。如果只配置@ConfigurationProperties注解，在IOC容器中是获取不到properties配置文件转化的bean的</p>
<h1 id="SpringBoot-测试类"><a href="#SpringBoot-测试类" class="headerlink" title="SpringBoot 测试类"></a>SpringBoot 测试类</h1><p>在类上标注@RunWith(SpringRunner.class) @SpringBootTest注解 方法上标注@Test注解</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> com<span class="token punctuation">.</span>leyou<span class="token punctuation">.</span>search<span class="token punctuation">.</span>client<span class="token punctuation">;</span>

<span class="token keyword">import</span> com<span class="token punctuation">.</span>leyou<span class="token punctuation">.</span>item<span class="token punctuation">.</span>pojo<span class="token punctuation">.</span>Category<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>Test<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span>RunWith<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span>Autowired<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>SpringBootTest<span class="token punctuation">;</span>
<span class="token keyword">import</span> org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span>SpringRunner<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>Arrays<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>util<span class="token punctuation">.</span>List<span class="token punctuation">;</span>


<span class="token comment" spellcheck="true">/**
 * @author bystander
 * @date 2018/9/22
 */</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span>SpringRunner<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CategoryClientTest</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
   <span class="token keyword">private</span> CategoryClient categoryClient<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testQueryCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        List<span class="token operator">&lt;</span>Category<span class="token operator">></span> list <span class="token operator">=</span> categoryClient<span class="token punctuation">.</span><span class="token function">queryByIds</span><span class="token punctuation">(</span>Arrays<span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>1L<span class="token punctuation">,</span> 2L<span class="token punctuation">,</span> 3L<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>System<span class="token punctuation">.</span>out<span class="token operator">:</span><span class="token operator">:</span>println<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<h1 id="SpringBoot访问默认页面"><a href="#SpringBoot访问默认页面" class="headerlink" title="SpringBoot访问默认页面"></a>SpringBoot访问默认页面</h1><p><a href="https://github.com/54321decba/tu/tree/master/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%9C%8D%E5%8A%A1%E7%AB%AF/pipi" target="_blank" rel="noopener">实例项目</a></p>
<h1 id="在controller文件配置即可"><a href="#在controller文件配置即可" class="headerlink" title="在controller文件配置即可"></a>在controller文件配置即可</h1><pre class=" language-java"><code class="language-java"><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> String <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">"login"</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre>
<h1 id="SpringBoot"><a href="#SpringBoot" class="headerlink" title="SpringBoot"></a>SpringBoot</h1><h2 id="SpringBoot登录系统"><a href="#SpringBoot登录系统" class="headerlink" title="SpringBoot登录系统"></a><strong>SpringBoot登录系统</strong></h2><p><a href="https://github.com/54321decba/tu/tree/master/springboot%E7%99%BB%E5%BD%95%E9%A1%B9%E7%9B%AE" target="_blank" rel="noopener">SpringBoot登录系统</a><br><a href="https://github.com/viabcde/mycoding.github.io/tree/master/SpringBootDemo" target="_blank" rel="noopener">示例demo源码地址</a></p>
<h2 id="Spring-Boot简介-习惯大于约定原则"><a href="#Spring-Boot简介-习惯大于约定原则" class="headerlink" title="Spring Boot简介_习惯大于约定原则"></a><strong>Spring Boot简介_习惯大于约定原则</strong></h2><h3 id="springboot就是一个能够快速搭起spring项目的神器"><a href="#springboot就是一个能够快速搭起spring项目的神器" class="headerlink" title="springboot就是一个能够快速搭起spring项目的神器"></a><strong>springboot就是一个能够快速搭起spring项目的神器</strong></h3><p><strong>原始Spring问题：</strong>大量的XML配置、复杂的依赖管理；需要手动配置tomcat    </p>
<p><strong>Spring Boot</strong>采用了包扫描和自动化配置的机制来加载原本集中于xml文件中的各项内容,提前配置好xml和依赖包，不需要手动配置服务器。<br><strong>如何做到的呢：</strong>把应用打包成可直接启动的jar/war，不需要另外配置一个Web Server。   </p>
<h2 id="PS"><a href="#PS" class="headerlink" title="PS"></a><strong>PS</strong></h2><pre><code>SpringBoot借助Groovy的MetaObject协议、可插拔的AST转换过程以及内置的依赖解决方案引擎实现  
Spring Boot默认使用tomcat作为服务器，使用logback提供日志记录  
CLI（命令行界面）可在Spring仓库中手动下载和安装，用来运行和测试Boot应用  
使用Groovy环境管理器（Groovy enVironment Manager，GVM）处理Boot版本的安装和管理。
</code></pre><h2 id="安装Boot"><a href="#安装Boot" class="headerlink" title="安装Boot"></a><strong>安装Boot</strong></h2><p>Boot及其CLI可以通过GVM的命令行gvm install springboot进行安装。<br><strong>遇到的问题</strong><br>对应的spring-boot版本是否正确，这里使用的是1.4.1版本；<br>是否加入plugin以及属性true<br>Eclipse Project 是否开启了Build Automatically（我自己就在这里栽了坑，不知道为什么我的工具什么时候关闭了自动编译的功能）。<br>如果设置SpringApplication.setRegisterShutdownHook(false)，则自动重启将不起作用。      </p>
<h1 id="spring-boot-starter"><a href="#spring-boot-starter" class="headerlink" title="spring-boot-starter"></a>spring-boot-starter</h1><p>内置了spring的默认配置<br><strong>自动配置文件</strong><br><strong>spring.factories</strong><br>指导Spring Boot找到指定的自动配置文件<br><strong>endpoint</strong><br>包含对服务的描述、界面、交互(业务信息的查询)<br><strong>health indicator</strong><br>提供的服务的健康指标   </p>
<h2 id="ConditionalOnMissingBean的作用是"><a href="#ConditionalOnMissingBean的作用是" class="headerlink" title="@ConditionalOnMissingBean的作用是"></a><strong>@ConditionalOnMissingBean的作用是</strong></h2><p>如果用户自己手动创建的bean，则不用它修饰的初始化代码块    </p>
<h2 id="Spring-Boot-Starter找到自动配置文件-xxxxAutoConfiguration之类的文件-的方式有两种："><a href="#Spring-Boot-Starter找到自动配置文件-xxxxAutoConfiguration之类的文件-的方式有两种：" class="headerlink" title="Spring Boot Starter找到自动配置文件(xxxxAutoConfiguration之类的文件)的方式有两种："></a><strong>Spring Boot Starter找到自动配置文件(xxxxAutoConfiguration之类的文件)的方式有两种：</strong></h2><p>1.spring.factories:由<strong>Spring Boot触发</strong>找classpath目录下的类，进行自动配置<br>2.@EnableXxxxx:有时需要由starter的<strong>用户触发</strong>查找自动配置文件  </p>
<h2 id="Spring-Boot-Starter的工作原理："><a href="#Spring-Boot-Starter的工作原理：" class="headerlink" title="Spring Boot Starter的工作原理："></a><strong>Spring Boot Starter的工作原理：</strong></h2><p>Spring Boot 在启动时扫描寻找包含spring.factories文件的JAR<br>根据spring.factories配置加载AutoConfigure类<br>根据 @Conditional注解的条件，进行自动配置并将Bean注入Spring Context   </p>
<h3 id="3-谈谈对Spring-Boot的认识"><a href="#3-谈谈对Spring-Boot的认识" class="headerlink" title="3.谈谈对Spring Boot的认识"></a><strong>3.谈谈对Spring Boot的认识</strong></h3><p>它可用于创建可执行的Spring应用程序，它的@EnableAutoConfiguration注解自动载入应用程序所需的所有Bean——这依赖于Spring Boot在类路径中的查找。<br><strong>@Enablexx注解</strong><br>@EnableTransactionManagement注解:声明事务管理<br>@EnableWebMvc注解:启用Spring MVC<br>@EnableScheduling注解:初始化一个调度器<br><strong>属性映射</strong><br>下面看MongoProperties类，它是一个Spring Boot属性映射的例子：</p>
<pre><code>@ConfigurationProperties(prefix = &quot;spring.data.mongodb&quot;)
public class MongoProperties {
    private String host;
    private int port = DBPort.PORT;
    private String uri = &quot;mongodb://localhost/test&quot;;
    private String database;
    // ... getters/ setters omitted
}
</code></pre><p><strong>@ConfigurationProperties注解:</strong> 将POJO关联到指定前缀的每一个属性。<br>例如，spring.data.mongodb.port属性将映射到这个类的端口属性。<br>强烈建议Spring Boot开发者使用这种方式来删除与配置属性相关的瓶颈代码。<br><strong>@Conditional注解</strong><br>此注解使得只有在特定条件满足时才启用一些配置<br>@ConditionalOnBean<br>@ConditionalOnClass<br>@ConditionalOnExpression<br>@ConditionalOnMissingBean<br>@ConditionalOnMissingClass<br>@ConditionalOnNotWebApplication<br>@ConditionalOnResource<br>@ConditionalOnWebApplication<br><strong>应用程序上下文初始化器</strong><br>spring.factories还提供了第二种可能性，即定义应用程序的初始化。这使得我们可以在应用程序载入前操纵Spring的应用程序上下文ApplicationContext。<br>特别是，可以在上下文创建监听器，使用ConfigurableApplicationContext类的addApplicationListener()方法。<br>AutoConfigurationReportLoggingInitializer监听到系统事件时，比如上下文刷新或应用程序启动故障之类的事件，Spring Boot可以执行一些工作。这有助于我们以调试模式启动应用程序时创建自动配置的报告。<br>要以调试模式启动应用程序，可以使用-Ddebug标识，或者在application.properties文件这添加属性debug= true。   </p>
<h3 id="4-自定义springboot-starter注意事项"><a href="#4-自定义springboot-starter注意事项" class="headerlink" title="4.自定义springboot-starter注意事项"></a><strong>4.自定义springboot-starter注意事项</strong></h3><p>// 1. springboot默认scan的包名是其main类所在的包名。如果引入的starter包名不一样，需要自己添加scan。<br>@ComponentScan(basePackages = {“com.xixicat.demo”,”com.xixicat.sms”})<br>// 2. 对于starter中有feign的，需要额外指定<br>@EnableFeignClients(basePackages = {“com.xixicat.sms”})<br>// 3. 对于exclude一些autoConfig<br>@EnableAutoConfiguration(exclude = {MetricFilterAutoConfiguration.class})     </p>
<h1 id="spring-boot-starter-test"><a href="#spring-boot-starter-test" class="headerlink" title="spring-boot-starter-test"></a>spring-boot-starter-test</h1><p>在pom包中添加spring-boot-starter-test包<strong>引用</strong></p>
<pre><code>　　&lt;dependency&gt;
　　&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
　　&lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
　　&lt;scope&gt;test&lt;/scope&gt;
　　&lt;/dependency&gt;
</code></pre><p><strong>测试类示例</strong>  </p>
<pre><code>@RunWith(SpringRunner.class)
　　@SpringBootTest
　　public class ApplicationTests {
　　@Test
　　public void hello() {
　　System.out.println(&quot;hello world&quot;);
　　}
　　}
</code></pre><p>引入了MockMvc支持<strong>对Controller层的测试</strong>，简单示例如下：</p>
<pre><code>　　public class HelloControlerTests {
　　
　　private MockMvc mvc;
　　
　　//初始化执行
　　
　　@Before
　　
　　public void setUp() throws Exception {
　　
　　mvc = MockMvcBuilders.standaloneSetup(new HelloController()).build();
　　
　　}
　　
　　//验证controller是否正常响应并打印返回结果
　　
　　@Test
　　
　　public void getHello() throws Exception {
　　
　　mvc.perform(MockMvcRequestBuilders.get(&quot;/hello&quot;).accept(MediaType.APPLICATION_JSON))
　　
　　.andExpect(MockMvcResultMatchers.status().isOk(www.027yeshenghuowang.com/))
　　
　　.andDo(MockMvcResultHandlers.print())
　　
　　.andReturn();
　　
　　}
　　
　　//验证controller是否正常响应并判断返回结果是否正确
　　
　　@Test
　　
　　public void testHello() throws Exception {
　　
　　mvc.perform(MockMvcRequestBuilders.get(&quot;/hello&quot;).accept(MediaType.APPLICATION_JSON))
　　
　　.andExpect(status().isOk(http://xucaizxyl.com/))
　　
　　.andExpect(content().string(equalTo(&quot;Hello World&quot;)http://www.wbjyl.cn/));
　　}
　　}
</code></pre><h1 id="SpringBoot遇到的问题"><a href="#SpringBoot遇到的问题" class="headerlink" title="SpringBoot遇到的问题"></a>SpringBoot遇到的问题</h1><h1 id="导入项目时出现cannot-find-value的问题-1"><a href="#导入项目时出现cannot-find-value的问题-1" class="headerlink" title="导入项目时出现cannot find value的问题  1"></a><strong>导入项目时出现cannot find value的问题</strong>  1</h1><p>可能的问题：Maven仓库没配置好<br>如果Maven仓库没问题，右键项目—-Maven—reimport</p>
<h2 id="端口占用问题"><a href="#端口占用问题" class="headerlink" title="端口占用问题"></a><strong>端口占用问题</strong></h2><p>运行独立jar包时可能会出现端口占用问题，springboot的内嵌tomcat的端口8080可能会被oracle (我就是)占用或者 tomcat（默认8080）占用    </p>
<h2 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a><strong>解决方法</strong></h2><p>重新配置内嵌tomcat的端口号步骤如下    </p>
<ol>
<li>在resource目录下新建application.properties文件（文件名一定要application.properties因为这个是默认的配置，如果文件名字不是这个则需要手动的添加识别）配置如下图<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101015.png?raw=true" alt="enter description
here"> </li>
</ol>
<h3 id="通过命令行设置属性值-启动的应用的端口号"><a href="#通过命令行设置属性值-启动的应用的端口号" class="headerlink" title="通过命令行设置属性值 启动的应用的端口号"></a><strong>通过命令行设置属性值 启动的应用的端口号</strong></h3><p>在命令行运行时，连续的两个减号–就是对application.properties中的属性值进行赋值的标识。<br>java -jar xxx.jar –server.port=8888命令，等价于我们在application.properties中添加属性server.port=8888</p>
<p><strong>问题：</strong>通过命令行就能更改应用运行的参数很不安全<br><strong>解决方法：</strong>SpringBoot提供了屏蔽命令行访问属性的设置：SpringApplication.setAddCommandLineProperties(false)。 </p>
<h3 id="编写SpringBoot-demo过程遇到的2个错误"><a href="#编写SpringBoot-demo过程遇到的2个错误" class="headerlink" title="编写SpringBoot demo过程遇到的2个错误"></a><strong>编写SpringBoot demo过程遇到的2个错误</strong></h3><p><strong>错误1</strong><br>创建完成后，如果项目报红色，(1).需要对项目右键-》属性-》Generate Deloyment Desriptor Stub。(2).项目右键-》Maven-》Update Project<br><strong>错误2</strong><br>运行后出现springboot A resource exists with a different case<br><img src="https://github.com/54321decba/tu/blob/master/201811/20181106.png?raw=true" alt="enter description
here"><br>groupId 和artifactId 和项目名不一致，我这里项目名SpringBootDemo而pom文件中是springbootDemo，所以出现这个错误，修改如上图即可<br><strong>错误3</strong><br>spring boot javax/annotation/ManagedBean : Unsupported major.minor version 51.0<br>原因jdk版本的问题  ，maven自带的jar版本与javax的jar版本不符，我修改为1.6即可解决<br><strong>错误4</strong><br>Establishing SSL connection without server’s identity verification is not recommended<br><strong>解决方法</strong><br>MySQL 5.5.45+, 5.6.26+ and 5.7.6+ 这些版本的数据库需要手动指定SSL是否开启，所以原来的连接字符串：jdbc.url=jdbc:mysql://127.0.0.1:3306/test就不可以了。<br>解决：<br>需要在其后附加useSSL=true或false，使用新的连接字符串：jdbc.url=jdbc:mysql://127.0.0.1:3306/test&amp;useSSL=false问题就解决了。</p>
<h3 id="Spring-Boot-启动报错Unable-to-start-ServletWebServerApplicationContext-due-to-missing-ServletWebServerFa"><a href="#Spring-Boot-启动报错Unable-to-start-ServletWebServerApplicationContext-due-to-missing-ServletWebServerFa" class="headerlink" title="Spring Boot 启动报错Unable to start ServletWebServerApplicationContext due to missing ServletWebServerFa"></a><strong>Spring Boot 启动报错Unable to start ServletWebServerApplicationContext due to missing ServletWebServerFa</strong></h3><p><strong>错误代码</strong> </p>
<pre><code>import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class HelloApplication {

    public static void main(String[] args) {
        SpringApplication.run(HelloController.class, args);
    }
}

</code></pre><pre><code>
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloController {

    @RequestMapping(&quot;/&quot;)
    public String index() {
        return &quot;Hello Spring Boot 2.0!&quot;;
    }
}
</code></pre><p><strong>原因：</strong><br>使用代码自动提示(Alt+/)时粗心了<code>SpringApplication.run(HelloController.class, args);</code><br>应该改为<code>SpringApplication.run(HelloApplication.class, args);</code></p>
<h1 id="SpringBoot核心组件"><a href="#SpringBoot核心组件" class="headerlink" title="SpringBoot核心组件"></a>SpringBoot核心组件</h1><h3 id="核心组件starter"><a href="#核心组件starter" class="headerlink" title="核心组件starter"></a><strong>核心组件starter</strong></h3><p>Starter主要用来简化依赖用的。比如我们之前做 MVC时要引入日志组件，那么需要去找到log4j的版本，然后引入，现在有了Starter之后，直接用这个之后，log4j就自动引入了，也不用关心版本这些问题。  </p>
<h3 id="核心组件actuator"><a href="#核心组件actuator" class="headerlink" title="核心组件actuator"></a><strong>核心组件actuator</strong></h3><p>即<strong>spring-boot-starter-actuator</strong>，主要作用是<strong>监控与管理</strong></p>
<pre><code>&lt;dependency&gt;
  &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
  &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><p><strong>模块解析</strong><br><strong>包含以下三个类：</strong><br><strong>应用配置类：</strong>应用配置、环境变量、自动化配置报告等<br><strong>度量指标类：</strong>内存信息、线程池信息、HTTP请求统计等<br><strong>操作控制类：</strong>提供了对应用的关闭等操作类功能  </p>
<h1 id="应用配置类"><a href="#应用配置类" class="headerlink" title="应用配置类"></a><strong>应用配置类</strong></h1><h2 id="autoconfig"><a href="#autoconfig" class="headerlink" title="/autoconfig"></a><strong>/autoconfig</strong></h2><p><strong>使用场景：</strong>帮助找到自动化配置为什么没有生效的具体原因。<br><strong>该报告内容将自动化配置内容分为两部分：</strong><br>positiveMatches中返回的是条件匹配成功的自动化配置<br>negativeMatches中返回的是条件匹配不成功的自动化配置     </p>
<pre><code>{
    &quot;positiveMatches&quot;: { // 条件匹配成功的
        &quot;EndpointWebMvcAutoConfiguration&quot;: [
            {
                &quot;condition&quot;: &quot;OnClassCondition&quot;,
                &quot;message&quot;: &quot;@ConditionalOnClass classes found: javax.servlet.Servlet,org.springframework.web.servlet.DispatcherServlet&quot;
            },
            {
                &quot;condition&quot;: &quot;OnWebApplicationCondition&quot;,
                &quot;message&quot;: &quot;found web application StandardServletEnvironment&quot;
            }
        ],
        ...
    },
    &quot;negativeMatches&quot;: {  // 条件不匹配成功的
        &quot;HealthIndicatorAutoConfiguration.DataSourcesHealthIndicatorConfiguration&quot;: [
            {
                &quot;condition&quot;: &quot;OnClassCondition&quot;,
                &quot;message&quot;: &quot;required @ConditionalOnClass classes not found: org.springframework.jdbc.core.JdbcTemplate&quot;
            }
        ],
        ...
    }
}
</code></pre><p>每个自动化配置候选项中都有一系列的条件，比如上面没有成功匹配的HealthIndicatorAutoConfiguration.DataSourcesHealthIndicatorConfiguration配置。<br>它的先决条件就是需要在工程中包含org.springframework.jdbc.core.JdbcTemplate类，由于没有引入相关的依赖，它就不会执行自动化配置内容。  所以，当发现有一些配置没有生效时，就可以通过该端点来查看没有生效的原因。    </p>
<h2 id="beans"><a href="#beans" class="headerlink" title="/beans"></a><strong>/beans</strong></h2><p><strong>作用：</strong>该端点用来获取应用上下文中创建的所有Bean  </p>
<pre><code>[
    {
        &quot;context&quot;: &quot;hello:dev:8881&quot;,
        &quot;parent&quot;: null,
        &quot;beans&quot;: [
            {
                &quot;bean&quot;: &quot;org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$DispatcherServletConfiguration&quot;,
                &quot;scope&quot;: &quot;singleton&quot;,
                &quot;type&quot;: &quot;org.springframework.boot.autoconfigure.web.DispatcherServletAutoConfiguration$DispatcherServletConfiguration$$EnhancerBySpringCGLIB$$3440282b&quot;,
                &quot;resource&quot;: &quot;null&quot;,
                &quot;dependencies&quot;: [
                    &quot;serverProperties&quot;,
                    &quot;spring.mvc.CONFIGURATION_PROPERTIES&quot;,
                    &quot;multipartConfigElement&quot;
                ]
            },
            {
                &quot;bean&quot;: &quot;dispatcherServlet&quot;,
                &quot;scope&quot;: &quot;singleton&quot;,
                &quot;type&quot;: &quot;org.springframework.web.servlet.DispatcherServlet&quot;,
                &quot;resource&quot;: &quot;class path resource [org/springframework/boot/autoconfigure/web/DispatcherServletAutoConfiguration$DispatcherServletConfiguration.class]&quot;,
                &quot;dependencies&quot;: []
            }
        ]
    }
]
</code></pre><p>如上示例中，可以看到每个bean都包含了下面这几个信息：<br>bean：Bean的名称<br>scope：Bean的作用域<br>type：Bean的Java类型<br>reource：class文件的具体路径<br>dependencies：依赖的Bean名称  </p>
<h3 id="configprops"><a href="#configprops" class="headerlink" title="/configprops"></a><strong>/configprops</strong></h3><p><strong>作用：</strong>用来获取应用中配置的属性信息报告。<br>从下面该端点返回示例片段中，返回了关于该短信的配置信息：<br>prefix属性代表了属性的配置前缀<br>properties代表了各个属性的名称和值<br>所以，我们可以通过该报告来看到各个属性的配置路径，比如我们要关闭该端点，就可以通过使用endpoints.configprops.enabled=false来完成设置</p>
<pre><code>{
    &quot;configurationPropertiesReportEndpoint&quot;: {
        &quot;prefix&quot;: &quot;endpoints.configprops&quot;,
        &quot;properties&quot;: {
            &quot;id&quot;: &quot;configprops&quot;,
            &quot;sensitive&quot;: true,
            &quot;enabled&quot;: true
        }
    },
    ...
}
</code></pre><h3 id="env"><a href="#env" class="headerlink" title="/env"></a><strong>/env</strong></h3><p><strong>作用：</strong>该端点与/configprops不同，它用来获取应用所有可用的环境属性报告。包括：环境变量、JVM属性、应用的配置配置、命令行中的参数<br>从下面该端点返回的示例片段中，可以看到它不仅返回了应用的配置属性，还返回了系统属性、环境变量等丰富的配置信息，其中也包括了应用还没有没有使用的配置。<br><strong>用途：</strong>帮助看当前应用可以加载的配置信息，并配合@ConfigurationProperties将它们引入到应用来使用。<br>为了配置属性的安全，对于一些类似密码等敏感信息，该端点都会进行隐私保护，但是需要让属性名中包含：password、secret、key这些关键词，这样该端点在返回它们的时候会使用” *  “来替代实际的属性值</p>
<pre><code>{
    &quot;profiles&quot;: [
        &quot;dev&quot;
    ],
    &quot;server.ports&quot;: {
        &quot;local.server.port&quot;: 8881
    },
    &quot;servletContextInitParams&quot;: {

    },
    &quot;systemProperties&quot;: {
        &quot;idea.version&quot;: &quot;2016.1.3&quot;,
        &quot;java.runtime.name&quot;: &quot;Java(TM) SE Runtime Environment&quot;,
        &quot;sun.boot.library.path&quot;: &quot;C:\\Program Files\\Java\\jdk1.8.0_91\\jre\\bin&quot;,
        &quot;java.vm.version&quot;: &quot;25.91-b15&quot;,
        &quot;java.vm.vendor&quot;: &quot;Oracle Corporation&quot;,
        ...
    },
    &quot;systemEnvironment&quot;: {
        &quot;configsetroot&quot;: &quot;C:\\WINDOWS\\ConfigSetRoot&quot;,
        &quot;RABBITMQ_BASE&quot;: &quot;E:\\tools\\rabbitmq&quot;,
        ...
    },
    &quot;applicationConfig: [classpath:/application-dev.properties]&quot;: {
        &quot;server.port&quot;: &quot;8881&quot;
    },
    &quot;applicationConfig: [classpath:/application.properties]&quot;: {
        &quot;server.port&quot;: &quot;8885&quot;,
        &quot;spring.profiles.active&quot;: &quot;dev&quot;,
        &quot;info.app.name&quot;: &quot;spring-boot-hello&quot;,
        &quot;info.app.version&quot;: &quot;v1.0.0&quot;,
        &quot;spring.application.name&quot;: &quot;hello&quot;
    }
}

</code></pre><h3 id="mappings"><a href="#mappings" class="headerlink" title="/mappings"></a><strong>/mappings</strong></h3><p><strong>作用：</strong>该端点用来返回所有Spring MVC的控制器映射关系报告<br>从下面的示例片段中，可以看该报告的信息<br>与我们在启用Spring MVC的Web应用时输出的日志信息类似，其中bean属性标识了该映射关系的请求处理器，method属性标识了该映射关系的具体处理类和处理函数  </p>
<pre><code>{
    &quot;/webjars/**&quot;: {
        &quot;bean&quot;: &quot;resourceHandlerMapping&quot;
    },
    &quot;/**&quot;: {
        &quot;bean&quot;: &quot;resourceHandlerMapping&quot;
    },
    &quot;/**/favicon.ico&quot;: {
        &quot;bean&quot;: &quot;faviconHandlerMapping&quot;
    },
    &quot;{[/hello]}&quot;: {
        &quot;bean&quot;: &quot;requestMappingHandlerMapping&quot;,
        &quot;method&quot;: &quot;public java.lang.String com.didispace.web.HelloController.index()&quot;
    },
    &quot;{[/mappings || /mappings.json],methods=[GET],produces=[application/json]}&quot;: {
        &quot;bean&quot;: &quot;endpointHandlerMapping&quot;,
        &quot;method&quot;: &quot;public java.lang.Object org.springframework.boot.actuate.endpoint.mvc.EndpointMvcAdapter.invoke()&quot;
    },
    ...
}
</code></pre><h3 id="info"><a href="#info" class="headerlink" title="/info"></a><strong>/info</strong></h3><p><strong>作用：</strong>用来返回应用自定义的信息。默认情况下，该端点只会返回一个空的json内容。我们可以在application.properties配置文件中通过info前缀来设置一些属性，比如下面这样：  </p>
<p>info.app.name=spring-boot-hello<br>info.app.version=v1.0.0<br>再访问/info端点，我们可以得到下面的返回报告，其中就包含了上面我们在应用自定义的两个参数。  </p>
<pre><code>{
    &quot;app&quot;: {
        &quot;name&quot;: &quot;spring-boot-hello&quot;,
        &quot;version&quot;: &quot;v1.0.0&quot;
    }
}
</code></pre><h2 id="度量指标类"><a href="#度量指标类" class="headerlink" title="度量指标类"></a><strong>度量指标类</strong></h2><p>应用配置类端点所提供的信息报告在应用启动时都已经确定了其返回内容，是一个静态报告。<br>而度量指标类端点提供的报告内容则是动态变化的，这些端点提供了应用程序运行中的信息<br>比如：内存使用情况、HTTP请求统计、外部资源指标等。<br>这些端点对于我们构建微服务架构中的监控系统非常有帮助，由于Spring Boot应用自身实现了这些端点，所以可以利用它们来收集想要的信息，以制定出各种自动化策略。    </p>
<h3 id="metrics"><a href="#metrics" class="headerlink" title="/metrics"></a><strong>/metrics</strong></h3><p><strong>作用：</strong>该端点用来返回当前应用的比如：内存信息、线程信息、垃圾回收信息等</p>
<pre><code>{
  &quot;mem&quot;: 541305,
  &quot;mem.free&quot;: 317864,
  &quot;processors&quot;: 8,
  &quot;instance.uptime&quot;: 33376471,
  &quot;uptime&quot;: 33385352,
  &quot;systemload.average&quot;: -1,
  &quot;heap.committed&quot;: 476672,
  &quot;heap.init&quot;: 262144,
  &quot;heap.used&quot;: 158807,
  &quot;heap&quot;: 3701248,
  &quot;nonheap.committed&quot;: 65856,
  &quot;nonheap.init&quot;: 2496,
  &quot;nonheap.used&quot;: 64633,
  &quot;nonheap&quot;: 0,
  &quot;threads.peak&quot;: 22,
  &quot;threads.daemon&quot;: 20,
  &quot;threads.totalStarted&quot;: 26,
  &quot;threads&quot;: 22,
  &quot;classes&quot;: 7669,
  &quot;classes.loaded&quot;: 7669,
  &quot;classes.unloaded&quot;: 0,
  &quot;gc.ps_scavenge.count&quot;: 7,
  &quot;gc.ps_scavenge.time&quot;: 118,
  &quot;gc.ps_marksweep.count&quot;: 2,
  &quot;gc.ps_marksweep.time&quot;: 234,
  &quot;httpsessions.max&quot;: -1,
  &quot;httpsessions.active&quot;: 0,
  &quot;gauge.response.beans&quot;: 55,
  &quot;gauge.response.env&quot;: 10,
  &quot;gauge.response.hello&quot;: 5,
  &quot;gauge.response.metrics&quot;: 4,
  &quot;gauge.response.configprops&quot;: 153,
  &quot;gauge.response.star-star&quot;: 5,
  &quot;counter.status.200.beans&quot;: 1,
  &quot;counter.status.200.metrics&quot;: 3,
  &quot;counter.status.200.configprops&quot;: 1,
  &quot;counter.status.404.star-star&quot;: 2,
  &quot;counter.status.200.hello&quot;: 11,
  &quot;counter.status.200.env&quot;: 1
}

</code></pre><p>从上面的示例中，有这些重要的度量值：<br>系统信息：包括处理器数量processors、运行时间uptime和instance.uptime、系统平均负载systemload.average<br>mem. <em> ：内存概要信息，包括分配给应用的总内存数量以及当前空闲的内存数量。这些信息来自java.lang.Runtime<br>heap.</em> ：堆内存使用情况。来自java.lang.management.MemoryMXBean接口中getHeapMemoryUsage方法获取的java.lang.management.MemoryUsage。<br>nonheap.<em> ：非堆内存使用情况。来自java.lang.management.MemoryMXBean接口中getNonHeapMemoryUsage方法获取的java.lang.management.MemoryUsage。<br>threads.</em> ： 线程使用情况，包括线程数、守护线程数（daemon）、线程峰值（peak）等，这些数据均来自java.lang.management.ThreadMXBean。<br>classes.<em> ：应用加载和卸载的类统计。这些数据均来自java.lang.management.ClassLoadingMXBean。<br>gc.</em> ：垃圾收集器的详细信息，包括垃圾回收次数gc.ps_scavenge.count、垃圾回收消耗时间gc.ps_scavenge.time、标记-清除算法的次数gc.ps_marksweep.count、标记-清除算法的消耗时间gc.ps_marksweep.time。这些数据均来自java.lang.management.GarbageCollectorMXBean。<br>httpsessions.<em> ：Tomcat容器的会话使用情况。包括最大会话数httpsessions.max和活跃会话数httpsessions.active。该度量指标信息仅在引入了嵌入式Tomcat作为应用容器的时候才会提供。<br>gauge.</em> ：HTTP请求的性能指标之一，它主要用来反映一个绝对数值。比如上面示例中的gauge.response.hello: 5，它表示上一次hello请求的延迟时间为5毫秒。<br>counter.<em> ：HTTP请求的性能指标之一，它主要作为计数器来使用，记录了增加量和减少量。如上示例中counter.status.200.hello: 11，它代表了hello请求返回200状态的次数为11。<br>对于gauge.</em> 和counter.* 的统计，这里有一个特殊的内容请求star-star，它代表了对静态资源的访问。这两类度量指标非常有用，我们不仅可以使用它默认的统计指标，还可以在程序中轻松的增加自定义统计值。只需要通过注入org.springframework.boot.actuate.metrics.CounterService和org.springframework.boot.actuate.metrics.GaugeService来实现自定义的统计指标信息。比如：我们可以像下面这样自定义实现对hello接口的访问次数统计。    </p>
<pre><code>@RestController
public class HelloController {

    @Autowired
    private CounterService counterService;

    @RequestMapping(&quot;/hello&quot;)
    public String greet() {
        counterService.increment(&quot;didispace.hello.count&quot;);
        return &quot;&quot;;
    }

}
</code></pre><h3 id="metrics-1"><a href="#metrics-1" class="headerlink" title="/metrics"></a><strong>/metrics</strong></h3><p><strong>作用：</strong>提供应用运行状态的完整度量指标报告，对于监控系统中的各项监控功能，它们的监控内容、数据收集频率都不同，如果我们每次都通过全量获取报告的方式来收集，略显粗暴。所以，我们还可以通过/metrics/{name}接口来更细粒度的获取度量信息，比如我们可以通过访问/metrics/mem.free来获取当前可用内存数量。  </p>
<h3 id="health"><a href="#health" class="headerlink" title="/health"></a><strong>/health</strong></h3><p>用来获取应用的各类健康指标信息。<br>在spring-boot-starter-actuator模块中自带实现了一些常用资源的健康指标检测器。这些检测器通过HealthIndicator接口实现，并且会根据依赖关系的引入实现自动化装配，比如用于检测磁盘的DiskSpaceHealthIndicator、检测DataSource连接是否可用的DataSourceHealthIndicator等。有时候，我们可能还会用到一些Spring Boot的Starter POMs中还没有封装的产品来进行开发，比如：当使用RocketMQ作为消息代理时，由于没有自动化配置的检测器，所以需要自己来实现一个用来采集健康信息的检测器。比如，我们可以在Spring Boot的应用中，为org.springframework.boot.actuate.health.HealthIndicator接口实现一个对RocketMQ的检测器类：</p>
<pre><code>@Component
public class RocketMQHealthIndicator implements HealthIndicator {

    @Override
    public Health health() {
        int errorCode = check();
        if (errorCode != 0) {
          return Health.down().withDetail(&quot;Error Code&quot;, errorCode).build();
        }
        return Health.up().build();
    }

      private int check() {
         // 对监控对象的检测操作
      }
}
</code></pre><p>通过重写health()函数来实现健康检查，返回的Heath对象中，共有两项内容，一个是状态信息，除了该示例中的UP与DOWN之外，还有UNKNOWN和OUT_OF_SERVICE，可以根据需要来实现返回；还有一个详细信息，采用Map的方式存储，在这里通过withDetail函数，注入了一个Error Code信息，也可以填入一下其他信息，比如，检测对象的IP地址、端口等。重新启动应用，并访问/health接口，我们在返回的JSON字符串中，将会包含了如下信息：  </p>
<pre><code>&quot;rocketMQ&quot;: {
  &quot;status&quot;: &quot;UP&quot;
}
</code></pre><h3 id="dump"><a href="#dump" class="headerlink" title="/dump"></a><strong>/dump</strong></h3><p>用来暴露程序运行中的线程信息。它使用java.lang.management.ThreadMXBean的dumpAllThreads方法来返回所有含有同步信息的活动线程详情。  </p>
<h3 id="trace"><a href="#trace" class="headerlink" title="/trace"></a><strong>/trace</strong></h3><p>用来返回基本的HTTP跟踪信息。默认情况下，跟踪信息的存储采用org.springframework.boot.actuate.trace.InMemoryTraceRepository实现的内存方式，始终保留最近的100条请求记录。它记录的内容格式如下：  </p>
<pre><code>[
    {
        &quot;timestamp&quot;: 1482570022463,
        &quot;info&quot;: {
            &quot;method&quot;: &quot;GET&quot;,
            &quot;path&quot;: &quot;/metrics/mem&quot;,
            &quot;headers&quot;: {
                &quot;request&quot;: {
                    &quot;host&quot;: &quot;localhost:8881&quot;,
                    &quot;connection&quot;: &quot;keep-alive&quot;,
                    &quot;cache-control&quot;: &quot;no-cache&quot;,
                    &quot;user-agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36&quot;,
                    &quot;postman-token&quot;: &quot;9817ea4d-ad9d-b2fc-7685-9dff1a1bc193&quot;,
                    &quot;accept&quot;: &quot;*/*&quot;,
                    &quot;accept-encoding&quot;: &quot;gzip, deflate, sdch&quot;,
                    &quot;accept-language&quot;: &quot;zh-CN,zh;q=0.8&quot;
                },
                &quot;response&quot;: {
                    &quot;X-Application-Context&quot;: &quot;hello:dev:8881&quot;,
                    &quot;Content-Type&quot;: &quot;application/json;charset=UTF-8&quot;,
                    &quot;Transfer-Encoding&quot;: &quot;chunked&quot;,
                    &quot;Date&quot;: &quot;Sat, 24 Dec 2016 09:00:22 GMT&quot;,
                    &quot;status&quot;: &quot;200&quot;
                }
            }
        }
    },
    ...
]
</code></pre><h2 id="操作控制类"><a href="#操作控制类" class="headerlink" title="操作控制类"></a><strong>操作控制类</strong></h2><p>由于介绍的所有端点都是用来反映应用自身的属性或是运行中的状态，相对于操作控制类端点没有那么敏感，所以他们默认都是启用的。<br>而操作控制类端点拥有更强大的控制能力，如果要使用它们的话，需要通过属性来配置开启。<br>在原生端点中，只提供了一个用来关闭应用的端点：/shutdown。我们可以通过如下配置开启它：<br>endpoints.shutdown.enabled=true<br>在配置了上述属性后，只需要访问应用的/shutdown端点就能实现关闭该应用的远程操作。由于开放关闭应用的操作本身是一件非常危险的事，所以真正在线上使用的时候，我们需要对其加入一定的保护机制，比如：定制Actuator的端点路径、整合Spring Security进行安全校验等。</p>
<h1 id="spring-boot-starter-logging"><a href="#spring-boot-starter-logging" class="headerlink" title="spring-boot-starter-logging"></a>spring-boot-starter-logging</h1><p>需要在<strong>maven中添加</strong>如下配置中之一即可</p>
<pre><code>#默认的logging
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-logging&lt;/artifactId&gt;
&lt;/dependency&gt;

#log4j
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-logg4j&lt;/artifactId&gt;
&lt;/dependency&gt;

#log4j2
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-log4j2&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><h1 id="mybatis-spring-boot-starter"><a href="#mybatis-spring-boot-starter" class="headerlink" title="mybatis-spring-boot-starter"></a>mybatis-spring-boot-starter</h1><p>mybatis-spring-boot-starter主要有两种解决方案，一种是使用注解解决一切问题，一种是简化后的老传统<br>2种都需要首先<strong>引入</strong>mybatis-spring-boot-starter的<strong>pom文件</strong>   </p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
    &lt;version&gt;1.1.1&lt;/version&gt;
&lt;/dependency&gt;
</code></pre><h2 id="第一种：无配置文件注解版"><a href="#第一种：无配置文件注解版" class="headerlink" title="第一种：无配置文件注解版"></a>第一种：无配置文件<strong>注解版</strong></h2><p>1 添加相关maven文件</p>
<pre><code>&lt;dependencies&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
        &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;
        &lt;version&gt;1.1.1&lt;/version&gt;
    &lt;/dependency&gt;
     &lt;dependency&gt;
        &lt;groupId&gt;mysql&lt;/groupId&gt;
        &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;
    &lt;/dependency&gt;
     &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
        &lt;optional&gt;true&lt;/optional&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;

</code></pre><p>完整的pom包这里就不贴了，大家直接看源码    </p>
<p>2、application.properties 添加相关配置</p>
<pre><code>mybatis.type-aliases-package=com.neo.entity

spring.datasource.driverClassName = com.mysql.jdbc.Driver
spring.datasource.url = jdbc:mysql://localhost:3306/test1?useUnicode=true&amp;characterEncoding=utf-8
spring.datasource.username = root
spring.datasource.password = root
</code></pre><p>springboot会自动加载<code>spring.datasource.*</code>相关配置，数据源就会自动注入到sqlSessionFactory中，sqlSessionFactory会自动注入到Mapper中，对了你一切都不用管了，直接拿起来使用就行了。<br><strong>在启动类中添加对mapper包扫描@MapperScan</strong></p>
<pre><code>@SpringBootApplication
@MapperScan(&quot;com.neo.mapper&quot;)
public class Application {

    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}
</code></pre><p>3、开发Mapper<br>第三步是最关键的一块，sql生产都在这里   </p>
<pre><code>public interface UserMapper {

    @Select(&quot;SELECT * FROM users&quot;)
    @Results({
        @Result(property = &quot;userSex&quot;,  column = &quot;user_sex&quot;, javaType = UserSexEnum.class),
        @Result(property = &quot;nickName&quot;, column = &quot;nick_name&quot;)
    })
    List&lt;UserEntity&gt; getAll();

    @Select(&quot;SELECT * FROM users WHERE id = #{id}&quot;)
    @Results({
        @Result(property = &quot;userSex&quot;,  column = &quot;user_sex&quot;, javaType = UserSexEnum.class),
        @Result(property = &quot;nickName&quot;, column = &quot;nick_name&quot;)
    })
    UserEntity getOne(Long id);

    @Insert(&quot;INSERT INTO users(userName,passWord,user_sex) VALUES(#{userName}, #{passWord}, #{userSex})&quot;)
    void insert(UserEntity user);

    @Update(&quot;UPDATE users SET userName=#{userName},nick_name=#{nickName} WHERE id =#{id}&quot;)
    void update(UserEntity user);

    @Delete(&quot;DELETE FROM users WHERE id =#{id}&quot;)
    void delete(Long id);

}
</code></pre><p>为了更接近生产我特地将user_sex、nick_name两个属性在数据库加了下划线和实体类属性名不一致，另外user_sex使用了枚举<br>@Select 是查询类的注解，所有的查询均使用这个<br>@Result 修饰返回的结果集，关联实体类属性和数据库字段一一对应，如果实体类属性和数据库属性名保持一致，就不需要这个属性来修饰。<br>@Insert 插入数据库使用，直接传入实体类会自动解析属性到对应的值<br>@Update 负责修改，也可以直接传入对象<br>@delete 负责删除<br><strong>注意，使用#符号和$符号的不同：</strong>  </p>
<pre><code>// This example creates a preparedstatement, something like select * from teacher where name = ?;
@Select(&quot;Select * from teacher where name = #{name}&quot;)
Teacher selectTeachForGivenName(@Param(&quot;name&quot;) String name);

// This example creates n inlined statement, something like select * from teacher where name = &#39;someName&#39;;
@Select(&quot;Select * from teacher where name = &#39;${name}&#39;&quot;)
Teacher selectTeachForGivenName(@Param(&quot;name&quot;) String name);

</code></pre><p>4、使用<br>上面三步就基本完成了相关dao层开发，使用的时候当作普通的类注入进入就可以了  </p>
<pre><code>@RunWith(SpringRunner.class)
@SpringBootTest
public class UserMapperTest {

    @Autowired
    private UserMapper UserMapper;

    @Test
    public void testInsert() throws Exception {
        UserMapper.insert(new UserEntity(&quot;aa&quot;, &quot;a123456&quot;, UserSexEnum.MAN));
        UserMapper.insert(new UserEntity(&quot;bb&quot;, &quot;b123456&quot;, UserSexEnum.WOMAN));
        UserMapper.insert(new UserEntity(&quot;cc&quot;, &quot;b123456&quot;, UserSexEnum.WOMAN));

        Assert.assertEquals(3, UserMapper.getAll().size());
    }

    @Test
    public void testQuery() throws Exception {
        List&lt;UserEntity&gt; users = UserMapper.getAll();
        System.out.println(users.toString());
    }

    @Test
    public void testUpdate() throws Exception {
        UserEntity user = UserMapper.getOne(3l);
        System.out.println(user.toString());
        user.setNickName(&quot;neo&quot;);
        UserMapper.update(user);
        Assert.assertTrue((&quot;neo&quot;.equals(UserMapper.getOne(3l).getNickName())));
    }
}

</code></pre><p>源码中controler层有完整的增删改查，这里就不贴了</p>
<h2 id="第二种：极简xml版本"><a href="#第二种：极简xml版本" class="headerlink" title="第二种：极简xml版本"></a><strong>第二种：极简xml版本</strong></h2><p>极简xml版本保持映射文件的老传统，优化主要体现在不需要实现dao的是实现层，系统会自动根据方法名在映射文件中找对应的sql.   </p>
<p>1、配置<br>pom文件和上个版本一样，只是application.properties新增以下配置   </p>
<pre><code>mybatis.config-locations=classpath:mybatis/mybatis-config.xml
mybatis.mapper-locations=classpath:mybatis/mapper/*.xml
</code></pre><p>指定了mybatis基础配置文件和实体类映射文件的地址  </p>
<p>mybatis-config.xml 配置   </p>
<pre><code>&lt;configuration&gt;
    &lt;typeAliases&gt;
        &lt;typeAlias alias=&quot;Integer&quot; type=&quot;java.lang.Integer&quot; /&gt;
        &lt;typeAlias alias=&quot;Long&quot; type=&quot;java.lang.Long&quot; /&gt;
        &lt;typeAlias alias=&quot;HashMap&quot; type=&quot;java.util.HashMap&quot; /&gt;
        &lt;typeAlias alias=&quot;LinkedHashMap&quot; type=&quot;java.util.LinkedHashMap&quot; /&gt;
        &lt;typeAlias alias=&quot;ArrayList&quot; type=&quot;java.util.ArrayList&quot; /&gt;
        &lt;typeAlias alias=&quot;LinkedList&quot; type=&quot;java.util.LinkedList&quot; /&gt;
    &lt;/typeAliases&gt;
&lt;/configuration&gt;
</code></pre><p>这里也可以添加一些mybatis基础的配置  </p>
<p>2、添加User的映射文件  </p>
<pre><code>&lt;mapper namespace=&quot;com.neo.mapper.UserMapper&quot; &gt;
    &lt;resultMap id=&quot;BaseResultMap&quot; type=&quot;com.neo.entity.UserEntity&quot; &gt;
        &lt;id column=&quot;id&quot; property=&quot;id&quot; jdbcType=&quot;BIGINT&quot; /&gt;
        &lt;result column=&quot;user_name&quot; property=&quot;userName&quot; jdbcType=&quot;VARCHAR&quot; /&gt;
        &lt;result column=&quot;pass_word&quot; property=&quot;passWord&quot; jdbcType=&quot;VARCHAR&quot; /&gt;
        &lt;result column=&quot;user_sex&quot;  property=&quot;userSex&quot;  javaType=&quot;com.neo.enums.UserSexEnum&quot;/&gt;
        &lt;result column=&quot;nick_name&quot; property=&quot;nickName&quot; jdbcType=&quot;VARCHAR&quot; /&gt;
    &lt;/resultMap&gt;

    &lt;sql id=&quot;Base_Column_List&quot; &gt;
        id, userName, passWord, user_sex, nick_name
    &lt;/sql&gt;

    &lt;select id=&quot;getAll&quot; resultMap=&quot;BaseResultMap&quot;  &gt;
       SELECT 
       &lt;include refid=&quot;Base_Column_List&quot; /&gt;
       FROM users
    &lt;/select&gt;

    &lt;select id=&quot;getOne&quot; parameterType=&quot;java.lang.Long&quot; resultMap=&quot;BaseResultMap&quot; &gt;
        SELECT 
       &lt;include refid=&quot;Base_Column_List&quot; /&gt;
       FROM users
       WHERE id = #{id}
    &lt;/select&gt;

    &lt;insert id=&quot;insert&quot; parameterType=&quot;com.neo.entity.UserEntity&quot; &gt;
       INSERT INTO 
               users
               (userName,passWord,user_sex) 
           VALUES
               (#{userName}, #{passWord}, #{userSex})
    &lt;/insert&gt;

    &lt;update id=&quot;update&quot; parameterType=&quot;com.neo.entity.UserEntity&quot; &gt;
       UPDATE 
               users 
       SET 
           &lt;if test=&quot;userName != null&quot;&gt;userName = #{userName},&lt;/if&gt;
           &lt;if test=&quot;passWord != null&quot;&gt;passWord = #{passWord},&lt;/if&gt;
           nick_name = #{nickName}
       WHERE 
               id = #{id}
    &lt;/update&gt;

    &lt;delete id=&quot;delete&quot; parameterType=&quot;java.lang.Long&quot; &gt;
       DELETE FROM
                users 
       WHERE 
                id =#{id}
    &lt;/delete&gt;
&lt;/mapper&gt;
</code></pre><p>其实就是把上个版本中mapper的sql搬到了这里的xml中了  </p>
<p>3、编写Dao层的代码   </p>
<pre><code>public interface UserMapper {

    List&lt;UserEntity&gt; getAll();

    UserEntity getOne(Long id);

    void insert(UserEntity user);

    void update(UserEntity user);

    void delete(Long id);

}
</code></pre><p>对比上一步这里全部只剩了接口方法</p>
<h1 id="运行SpringBoot"><a href="#运行SpringBoot" class="headerlink" title="运行SpringBoot"></a>运行SpringBoot</h1><h3 id="第一种方式"><a href="#第一种方式" class="headerlink" title="第一种方式"></a><strong>第一种方式</strong></h3><p>1.在UserController中加上@EnableAutoConfiguration开启自动配置<br>2.然后通过SpringApplication.run(UserController.class);运行这个控制器<br><strong>使用场景：</strong>这种方式在运行一个控制器比较方便<br>代码如下：  </p>
<pre><code>@RestController
@EnableAutoConfiguration
public class Application {
@RequestMapping(&quot;user&quot;)
public static StringSayHello() {
        return&quot;Hello Word!&quot;;
}
public static voidmain(String[] args){
        SpringApplication.run(Application.class,args);
}
}
</code></pre><h3 id="第二种方式"><a href="#第二种方式" class="headerlink" title="第二种方式"></a><strong>第二种方式</strong></h3><p>@Configuration+@ComponentScan开启注解扫描并自动注册相应的注解Bean<br>代码如下  </p>
<pre><code>@Configuration
@ComponentScan
@EnableAutoConfiguration
public class Application {
public static voidmain(String[] args){
        SpringApplication.run(Application.class,args);
}
</code></pre><h3 id="第三种：将工程打包成独立运行jar包"><a href="#第三种：将工程打包成独立运行jar包" class="headerlink" title="第三种：将工程打包成独立运行jar包"></a><strong>第三种：将工程打包成独立运行jar包</strong></h3><p>进入cmd 定位到项目目录下然后执行   </p>
<pre><code>mvn clean  package –DskipTests
</code></pre><p>执行成功后在项目的target文件夹下出现jar包，例如（spingboot-demo-0.0.1-SNAPSHOT.jar）<br>然后再cmd 的C盘 用户目录下执行命令  </p>
<pre><code>$ java –jar （jar包的目录）E:\program\spingboot-demo\target\spingboot-demo-0.0.1-SNAPSHOT.jar  
</code></pre><p>回车运行会有如下图<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101012.png?raw=true" alt="enter description
here"><br>出现下图表示运行成功<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101013.png?raw=true" alt="enter description
here"><br>然后在浏览器中输入端口号和地址进行访问。<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101014.png?raw=true" alt="enter description
here"><br><strong>spring boot 优势:</strong>  一个jar 包和java 环境就能运行web 项目</p>
<h2 id="远程下载并启动Spring-boot项目"><a href="#远程下载并启动Spring-boot项目" class="headerlink" title="远程下载并启动Spring boot项目"></a><strong>远程下载并启动Spring boot项目</strong></h2><pre><code>git clone git@github.com:hengyunabc/spring-boot-demo.git  
mvn spring-boot-demo  
java -jar target/demo-0.0.1-SNAPSHOT.jar  
</code></pre><h3 id="部署spring-boot应用"><a href="#部署spring-boot应用" class="headerlink" title="部署spring boot应用"></a><strong>部署spring boot应用</strong></h3><p>要部署运行spring boot应用，首选要打包spring boot应用，你在pom文件中看到的spring-boot-maven-plugin插件就是打包spring boot应用的。<br>进入工程目录   运行mvn package 进行打包<br><img src="https://github.com/54321decba/tu/blob/master/201811/20181108.png?raw=true" alt="enter description
here"><br>打包之后的文件在工程目录的target目录  使用java的原生命令执行生成的jar文件<br>java  -jar  spring-boot-demo01.jar –server.port=9090  启动spring boot 项目</p>
<h1 id="注解EnableAutoConfiguration-和-SpringApplication"><a href="#注解EnableAutoConfiguration-和-SpringApplication" class="headerlink" title="注解EnableAutoConfiguration 和 SpringApplication"></a>注解EnableAutoConfiguration 和 SpringApplication</h1><h3 id="EnableAutoConfiguration-1"><a href="#EnableAutoConfiguration-1" class="headerlink" title="@EnableAutoConfiguration"></a><strong>@EnableAutoConfiguration</strong></h3><p>用于自动配置。根据你的pom配置（实际上应该是根据具体的依赖）来判断这是一个什么应用，并创建相应的环境。<br>在上面这个例子中，@EnableAutoConfiguration 会判断出这是一个web应用，所以会创建相应的web环境。  </p>
<h3 id="SpringApplication"><a href="#SpringApplication" class="headerlink" title="SpringApplication"></a><strong>SpringApplication</strong></h3><p>用于从main方法启动Spring应用的类。默认，它会执行以下步骤：  </p>
<pre><code>1.创建一个合适的ApplicationContext实例 （取决于classpath）。  
2.注册一个CommandLinePropertySource，以便将命令行参数作为Spring properties。  
3.刷新application context，加载所有单例beans。  
4.激活所有CommandLineRunner beans。  
默认，直接使用SpringApplication 的静态方法run()即可。但也可以创建实例，并自行配置需要的设置。
# SpringBoot访问时怎么没有项目路径？
### **按照之前的web项目习惯，你可能会问，SpringBoot怎么没有项目路径？**  
这就是Spring Boot的默认设置了，将项目路径直接设为根路径。  
当然，我们也可以设置自己的项目路径 -- 在classpath下的 application.properties 或者 application.yaml 文件中设置即可。  
内容如下：  
``` java
# application.yaml
# Server settings (ServerProperties)
server:
  port: 8080
  address: 127.0.0.1
  sessionTimeout: 30
  contextPath: /aaa
  # Tomcat specifics
  tomcat:
    accessLogEnabled: false
    protocolHeader: x-forwarded-proto
    remoteIpHeader: x-forwarded-for
    basedir:
    backgroundProcessorDelay: 30 # secs
</code></pre><pre class=" language-java"><code class="language-java"># application<span class="token punctuation">.</span>properties
# Server <span class="token function">settings</span> <span class="token punctuation">(</span>ServerProperties<span class="token punctuation">)</span>
server<span class="token punctuation">.</span>port<span class="token operator">=</span><span class="token number">8080</span>
server<span class="token punctuation">.</span>address<span class="token operator">=</span><span class="token number">127.0</span><span class="token punctuation">.</span><span class="token number">0.1</span>
#server<span class="token punctuation">.</span>sessionTimeout<span class="token operator">=</span><span class="token number">30</span>
server<span class="token punctuation">.</span>contextPath<span class="token operator">=</span><span class="token operator">/</span>aaa
# Tomcat specifics
#server<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>accessLogEnabled<span class="token operator">=</span><span class="token boolean">false</span>
server<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>protocolHeader<span class="token operator">=</span>x<span class="token operator">-</span>forwarded<span class="token operator">-</span>proto
server<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>remoteIpHeader<span class="token operator">=</span>x<span class="token operator">-</span>forwarded<span class="token operator">-</span><span class="token keyword">for</span>
server<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>basedir<span class="token operator">=</span>
server<span class="token punctuation">.</span>tomcat<span class="token punctuation">.</span>backgroundProcessorDelay<span class="token operator">=</span><span class="token number">30</span>
</code></pre>
<p>上面， server.contextPath=/aaa 就是设置了项目路径。所以现在需要访问 <a href="http://localhost:8080/aaa/" target="_blank" rel="noopener">http://localhost:8080/aaa/</a> 才行。  </p>
<h1 id="SpringBoot的配置文件application-properties"><a href="#SpringBoot的配置文件application-properties" class="headerlink" title="SpringBoot的配置文件application.properties"></a><strong>SpringBoot的配置文件application.properties</strong></h1><p>用来配置数据库连接、日志相关配置等<br>自定义属性与加载<br>我们在使用Spring Boot的时候，通常也需要定义一些自己使用的属性，我们可以如下方式直接定义：  </p>
<pre><code>com.didispace.blog.name=程序猿DD
com.didispace.blog.title=Spring Boot教程
</code></pre><p>然后通过@Value(“${属性名}”)注解来加载对应的配置属性，具体如下：  </p>
<pre><code>@Component
public class BlogProperties {
    @Value(&quot;${com.didispace.blog.name}&quot;)
    private String name;
    @Value(&quot;${com.didispace.blog.title}&quot;)
    private String title;
    // 省略getter和setter
}
</code></pre><p>按照惯例，通过单元测试来验证BlogProperties中的属性是否已经根据配置文件加载了。  </p>
<pre><code>@RunWith(SpringJUnit4ClassRunner.class)
@SpringApplicationConfiguration(Application.class)
public class ApplicationTests {
    @Autowired
    private BlogProperties blogProperties;
    @Test
    public void getHello() throws Exception {
        Assert.assertEquals(blogProperties.getName(), &quot;程序猿DD&quot;);
        Assert.assertEquals(blogProperties.getTitle(), &quot;Spring Boot教程&quot;);
    }
}
</code></pre><h4 id="配置文件里参数间可以互相引用"><a href="#配置文件里参数间可以互相引用" class="headerlink" title="配置文件里参数间可以互相引用"></a><strong>配置文件里参数间可以互相引用</strong></h4><p>在application.properties中的各个参数之间也可以直接引用来使用，就像下面的设置：  </p>
<pre><code>com.didispace.blog.name=程序猿DD
com.didispace.blog.title=Spring Boot教程
com.didispace.blog.desc=${com.didispace.blog.name}正在努力写《${com.didispace.blog.title}》
</code></pre><p>com.didispace.blog.desc参数引用了上文中定义的name和title属性，最后该属性的值就是程序猿DD正在努力写《Spring Boot教程》。</p>
<h3 id="配置文件的使用方法"><a href="#配置文件的使用方法" class="headerlink" title="配置文件的使用方法"></a><strong>配置文件的使用方法</strong></h3><h4 id="使用随机数"><a href="#使用随机数" class="headerlink" title="使用随机数"></a><strong>使用随机数</strong></h4><p>在一些情况下，有些参数我们需要希望它不是一个固定的值，比如密钥、服务端口等。Spring Boot的属性配置文件中可以通过${random}来产生int值、long值或者string字符串，来支持属性的随机值。  </p>
<h4 id="随机字符串"><a href="#随机字符串" class="headerlink" title="随机字符串"></a><strong>随机字符串</strong></h4><p>com.didispace.blog.value=${random.value}  </p>
<h4 id="随机int"><a href="#随机int" class="headerlink" title="随机int"></a><strong>随机int</strong></h4><p>com.didispace.blog.number=${random.int}  </p>
<h4 id="随机long"><a href="#随机long" class="headerlink" title="随机long"></a><strong>随机long</strong></h4><p>com.didispace.blog.bignumber=${random.long}</p>
<h4 id="10以内的随机数"><a href="#10以内的随机数" class="headerlink" title="10以内的随机数"></a><strong>10以内的随机数</strong></h4><p>com.didispace.blog.test1=${random.int(10)}  </p>
<h4 id="10-20的随机数"><a href="#10-20的随机数" class="headerlink" title="10-20的随机数"></a><strong>10-20的随机数</strong></h4><p>com.didispace.blog.test2=${random.int[10,20]}  </p>
<h2 id="SpringBoot能集成的视图技术"><a href="#SpringBoot能集成的视图技术" class="headerlink" title="SpringBoot能集成的视图技术"></a><strong>SpringBoot能集成的视图技术</strong></h2><p>spring boot 在springmvc的视图解析器方面默认集成ContentNegotiatingViewResolver和BeanNameViewResolver<br>在视图引擎上就已经集成自动配置的模版引擎，如下： </p>
<ol>
<li>FreeMarker </li>
<li>Groovy </li>
<li>Thymeleaf </li>
<li>Velocity (deprecated in 1.4) </li>
<li>Mustache</li>
</ol>
<p>JSP技术spring boot 官方是不推荐的，原因有三： </p>
<ol>
<li>在tomcat上，jsp不能在嵌套的tomcat容器解析即不能在打包成可执行的jar的情况下解析 </li>
<li>Jetty 嵌套的容器不支持jsp </li>
<li>Undertow</li>
</ol>
<p>而其他的模版引擎spring boot 都支持，并默认会到classpath的templates里面查找模版引擎</p>
<h3 id="集成freemarker模版引擎"><a href="#集成freemarker模版引擎" class="headerlink" title="集成freemarker模版引擎"></a><strong>集成freemarker模版引擎</strong></h3><p>1.现在pom.xml启动freemarker模版引擎视图</p>
<pre><code>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-freemarker&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><p>2.定义一个模版后缀是ftp,注意是在classpath的templates目录下<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101016.png?raw=true" alt="enter description
here"><br>3.在controller上返回视图路径</p>
<pre><code>@RestController
@RequestMapping(&quot;/task&quot;)
public class TaskController {

    @RequestMapping(&quot;/mvc1&quot;)
    public ModelAndView mvc1() {
        return new ModelAndView(&quot;index&quot;);
    }
}
</code></pre><p>@RestController默认就会在每个方法上加上@Responsebody,方法返回值会直接被httpmessageconverter转化，如果想直接返回视图，需要直接指定modelAndView。<br>虽然，jsp技术，spring boot 官方不推荐，但考虑到是常用的技术，这里也来集成下jsp技术<br>1.首先，需要在你项目上加上webapp标准的web项目文件夹<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101017.png?raw=true" alt="enter description
here"><br>2.在配置文件上配置，jsp的前缀和后缀<br>spring.mvc.view.prefix=/WEB-INF/<br>spring.mvc.view.suffix=.jsp<br>3.然后直接在controller中返回视图</p>
<pre><code>@RestController
@RequestMapping(&quot;/task&quot;)
public class TaskController {

    @RequestMapping(&quot;/mvc1&quot;)
    public ModelAndView mvc1() {
        return new ModelAndView(&quot;index&quot;);
    }
</code></pre><p>这里要注意，只能是打成war包在非嵌套的tomcat容器才能看到效果，直接在嵌套的tomcat容器是看不到效果的，因为不支持，例如在IDE直接右键run main函数或者打成可执行的jar包都不行。<br>例外，如果出现freemarker模版引擎和jsp技术同时存在的话，springmvc会根据解析器的优先级来返回具体的视图，默认，FreeMarkerViewResolver的优先级大于InternalResourceViewResolver的优先级，所以同时存在的话，会返回freemarker视图</p>
<h1 id="SpringBoot更换容器："><a href="#SpringBoot更换容器：" class="headerlink" title="SpringBoot更换容器："></a><strong>SpringBoot更换容器：</strong></h1><p>在pom.xml中编辑</p>
<pre><code># 01 去除springboot中默认的嵌入式tomcat依赖
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;
        &lt;exclusions&gt;
            &lt;exclusion&gt;
                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;
        &lt;/exclusion&gt;
    &lt;/exclusions&gt;
&lt;/dependency&gt;

# 02 添加jetty依赖
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-jetty&lt;/artifactId&gt;
&lt;/dependency&gt;

</code></pre><p><strong>更换端口：</strong>编辑application.properties文件，添加如下行：</p>
<pre><code># server.servlet.context-path=/helloboot
# logging.file=D:/mylog/log.log
# logging.level.org.springframework.web= DEBUG
# book.author=wxh
# book.name=20
# debug=true
# spring.profiles.active=dev
server.port=8888
</code></pre><h2 id="spring-boot的启动原理"><a href="#spring-boot的启动原理" class="headerlink" title="spring boot的启动原理"></a><strong>spring boot的启动原理</strong></h2><p>maven打包之后，会生成两个jar文件：<br><strong>demo-0.0.1-SNAPSHOT.jar spring boot</strong><br>由maven插件生成，里面包含了应用的依赖，以及spring boot相关的类<br><strong>demo-0.0.1-SNAPSHOT.jar.original</strong><br>默认的maven-jar-plugin生成的包<br><strong>spring boot打好的包的目录结构</strong>  </p>
<pre><code>├── META-INF
│   ├── MANIFEST.MF
├── application.properties
├── com
│   └── example
│       └── SpringBootDemoApplication.class
├── lib
│   ├── aopalliance-1.0.jar
│   ├── spring-beans-4.2.3.RELEASE.jar
│   ├── ...
└── org
    └── springframework
        └── boot
            └── loader
                ├── ExecutableArchiveLauncher.class
                ├── JarLauncher.class
                ├── JavaAgentDetector.class
                ├── LaunchedURLClassLoader.class
                ├── Launcher.class
                ├── MainMethodRunner.class
                ├── ...
</code></pre><h3 id="MANIFEST-MF"><a href="#MANIFEST-MF" class="headerlink" title="MANIFEST.MF"></a><strong>MANIFEST.MF</strong></h3><pre><code>Manifest-Version: 1.0
Start-Class: com.example.SpringBootDemoApplication
Implementation-Vendor-Id: com.example
Spring-Boot-Version: 1.3.0.RELEASE
Created-By: Apache Maven 3.3.3
Build-Jdk: 1.8.0_60
Implementation-Vendor: Pivotal Software, Inc.
Main-Class: org.springframework.boot.loader.JarLauncher
</code></pre><h3 id="Start-Class是com-example-SpringBootDemoApplication："><a href="#Start-Class是com-example-SpringBootDemoApplication：" class="headerlink" title="Start-Class是com.example.SpringBootDemoApplication："></a><strong>Start-Class是com.example.SpringBootDemoApplication：</strong></h3><p>这个是我们应用的Main函数：</p>
<pre><code>@SpringBootApplication
public class SpringBootDemoApplication {

    public static void main(String[] args) {
        SpringApplication.run(SpringBootDemoApplication.class, args);
    }
}
</code></pre><h3 id="com-example-目录"><a href="#com-example-目录" class="headerlink" title="com/example 目录"></a><strong>com/example 目录</strong></h3><p>应用的.class文件</p>
<h3 id="lib目录"><a href="#lib目录" class="headerlink" title="lib目录"></a><strong>lib目录</strong></h3><p>应用的Maven依赖的jar包文件，比如spring-beans，spring-mvc等jar。  </p>
<h3 id="org-springframework-boot-loader-目录"><a href="#org-springframework-boot-loader-目录" class="headerlink" title="org/springframework/boot/loader 目录"></a><strong>org/springframework/boot/loader 目录</strong></h3><p>Spring boot loader的.class文件  </p>
<h3 id="spring-boot应用打包之后，生成的fat-jar"><a href="#spring-boot应用打包之后，生成的fat-jar" class="headerlink" title="spring boot应用打包之后，生成的fat_jar"></a><strong>spring boot应用打包之后，生成的fat_jar</strong></h3><p>包含应用依赖的jar包，还有Spring boot loader相关的类<br>Fat jar的启动Main函数是JarLauncher，它负责创建LaunchedURLClassLoader加载/lib下面的jar，并以一个新线程启动应用的Main函数。<br><strong>LaunchedURLClassLoader和普通的URLClassLoader的不同之处是</strong><br>它提供了从Archive里加载.class的能力。结合Archive提供的getEntries函数，就可以获取到Archive里的Resource。</p>
<h2 id="加载流程"><a href="#加载流程" class="headerlink" title="加载流程"></a><strong>加载流程</strong></h2><p>1.JarLauncher以demo-0.0.1-SNAPSHOT.jar创建一个Archive<br>2.JarLauncher创建好Archive之后，通过getNestedArchives函数来获取到demo-0.0.1-SNAPSHOT.jar/lib下面的所有jar文件，并创建为List，数组里是lib目录下面的jar的URL，用这个来构造一个自定义的ClassLoader：LaunchedURLClassLoader。<br>3.基本环境搭建好之后，从MANIFEST.MF里读取到Start-Class，即com.example.SpringBootDemoApplication，然后创建一个新的线程来启动应用的Main函数。  </p>
<h2 id="springboot-热部署的两种方式"><a href="#springboot-热部署的两种方式" class="headerlink" title="springboot 热部署的两种方式"></a><strong>springboot 热部署的两种方式</strong></h2><h3 id="第一种：使用spring-boot-run"><a href="#第一种：使用spring-boot-run" class="headerlink" title="第一种：使用spring-boot:run"></a><strong>第一种：使用spring-boot:run</strong></h3><p><strong>在pom.xml文件添加依赖包</strong>  </p>
<pre><code>&lt;plugin&gt;
                      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
                      &lt;artifactId&gt;spring-boot-maven-plugin &lt;/artifactId&gt;
                      &lt;dependencies&gt;  
                       &lt;!--springloaded  hot deploy --&gt;  
                       &lt;dependency&gt;  
                           &lt;groupId&gt;org.springframework&lt;/groupId&gt;  
                           &lt;artifactId&gt;springloaded&lt;/artifactId&gt;  
                           &lt;version&gt;1.2.4.RELEASE&lt;/version&gt;
                       &lt;/dependency&gt;  
                    &lt;/dependencies&gt;  
                    &lt;executions&gt;  
                       &lt;execution&gt;  
                           &lt;goals&gt;  
                               &lt;goal&gt;repackage&lt;/goal&gt;  
                           &lt;/goals&gt;  
                           &lt;configuration&gt;  
                               &lt;classifier&gt;exec&lt;/classifier&gt;  
                           &lt;/configuration&gt;  
                       &lt;/execution&gt;  
                       &lt;/executions&gt;
                &lt;/plugin&gt;
</code></pre><p><strong>PS</strong><br>如果使用的run as – java application，还需要做一些处理:<br>把spring-loader-1.2.4.RELEASE.jar下载下来，放到项目的lib目录中<br>然后把IDEA的run参数里VM参数设置为： -javaagent:.\lib\springloaded-1.2.4.RELEASE.jar -noverify 然后启动就可以了<br>这样在run as的时候，也能进行热部署      </p>
<h3 id="第二种：springboot-devtools（热部署）"><a href="#第二种：springboot-devtools（热部署）" class="headerlink" title="第二种：springboot + devtools（热部署）"></a><strong>第二种：springboot + devtools（热部署）</strong></h3><p>问题的提出： 通过使用springloaded进行热部署，但是一些代码修改了，并不会进行热部署。<br>spring-boot-devtools<br>spring-boot-devtools 自动应用代码更改到最新的App上面去。<br><strong>原理:</strong><br>发现代码有更改后重新启动应用，但是速度比手动停止后再启动还要更快，更快指的不是节省出来的手工操作的时间。<br><strong>其深层原理是</strong>使用了两个ClassLoader，一个Classloader加载那些不会改变的类（第三方Jar包），另一个ClassLoader加载会更改的类，称为 restart ClassLoader  ,在代码更改时，原来的restart ClassLoader 被丢弃，重新创建一个restart ClassLoader，由于需要加载的类相比较少，所以实现了较快的重启时间（5秒以内）。<br><strong>1、添加依赖包：</strong>  </p>
<pre><code>&lt;dependency&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;
            &lt;optional&gt;true&lt;/optional&gt;&lt;!-- optional=true,依赖不会传递，该项目依赖devtools；之后依赖myboot项目的项目如果想要使用devtools，需要重新引入 --&gt;  
            &lt;scope&gt;true&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre><p><strong>2、添加spring-boot-maven-plugin：</strong>  </p>
<pre><code>&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;fork&gt;true&lt;/fork&gt;     &lt;!--fork :  如果没有该项配置，肯呢个devtools不会起作用，即应用不会restart --&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;
</code></pre><p><strong>测试方法</strong><br>修改类–&gt;保存：应用会重启<br>修改配置文件–&gt;保存：应用会重启<br>修改页面–&gt;保存：应用会重启，页面会刷新（原理是将spring.thymeleaf.cache设为false）  </p>
<h1 id="MVC"><a href="#MVC" class="headerlink" title="MVC"></a>MVC</h1><h2 id="MVC模式（Struts2源码）"><a href="#MVC模式（Struts2源码）" class="headerlink" title="MVC模式（Struts2源码）"></a><strong>MVC模式（Struts2源码）</strong></h2><p> <strong>MVC全名是Model ViewController</strong>  是模型(model)－视图(view)－控制器(controller)的缩写，一种软件设计典范。它主要是实现了层与层之间的屏蔽  </p>
<h3 id="Model（模型）"><a href="#Model（模型）" class="headerlink" title="Model（模型）"></a><strong>Model（模型）</strong></h3><p> 通常负责在数据库中存取数据CURD。使用的框架：Hibernate、Mybatis  </p>
<h3 id="View（视图）"><a href="#View（视图）" class="headerlink" title="View（视图）"></a><strong>View（视图）</strong></h3><p>前端数据的展示，是应用程序中处理数据显示的部分。通常视图是依据模型数据创建的。  使用的技术：JSP  </p>
<h3 id="Controller（控制器）"><a href="#Controller（控制器）" class="headerlink" title="Controller（控制器）"></a><strong>Controller（控制器）</strong></h3><p>是应用程序中处理用户交互的部分。通常控制器负责从视图读取数据，控制用户输入，并向模型发送数据。使用的框架：SpringMVC、Struts2<br><img src="https://github.com/54321decba/tu/blob/master/jpg/mvc.png?raw=true" alt="mvc"></p>
<h2 id="springMVC的执行流程"><a href="#springMVC的执行流程" class="headerlink" title="springMVC的执行流程"></a><strong>springMVC的执行流程</strong></h2><p>springMVC是由dispatchservlet为核心的分层控制框架。<br>首先客户端发出一个请求web服务器解析请求url并去匹配dispatchservlet的映射url，如果匹配上就将这个请求放入到dispatchservlet，dispatchservlet根据mapping映射配置去寻找相对应的handel<br>然后把处理权交给找到的handel，handel封装了处理业务逻辑的代码，当handel处理完后会返回一个逻辑视图modelandview给dispatchservlet，此时的modelandview是一个逻辑视图不是一个正式视图，所以dispatchservlet会通过viewresource视图资源去解析modelandview，然后将解析后的参数放到view中返回到客户端并展现。</p>
<h1 id="Hibernate"><a href="#Hibernate" class="headerlink" title="Hibernate"></a>Hibernate</h1><h2 id="Hibernate工作原理如下"><a href="#Hibernate工作原理如下" class="headerlink" title="Hibernate工作原理如下"></a><strong>Hibernate工作原理如下</strong></h2><p>读取配置文件里的映射信息，创建SessionFactory<br>打开Session  ，创建事务Transaction<br>持久化操作，存到数据库，提交事务<br>关闭Session和SessionFactory </p>
<h1 id="未用到"><a href="#未用到" class="headerlink" title="未用到"></a>未用到</h1><h2 id="Hibernate有3中查询方式："><a href="#Hibernate有3中查询方式：" class="headerlink" title="Hibernate有3中查询方式："></a><strong>Hibernate有3中查询方式：</strong></h2><p>HQL: Hibernate Query Language<br>Criteria Query,以对象的方式添加查询条件<br>SQL,直接使用SQL语句操作数据库。</p>
<h2 id="什么是ORM？"><a href="#什么是ORM？" class="headerlink" title="什么是ORM？"></a><strong>什么是ORM？</strong></h2><p>答：对象关系映射（Object-Relational Mapping，简称ORM）是一种为了解决程序的面向对象模型与数据库的关系模型互不匹配问题的技术；简单的说，ORM是通过使用描述对象和数据库之间映射的元数据（在Java中可以用XML或者是注解），将程序中的对象自动持久化到关系数据库中或者将关系数据库表中的行转换成Java对象，其本质上就是将数据从一种形式转换到另外一种形式。</p>
<h2 id="hibernate的核心思想"><a href="#hibernate的核心思想" class="headerlink" title="hibernate的核心思想"></a><strong>hibernate的核心思想</strong></h2><p>Hibernate的核心思想是ROM对象关系映射机制。即通过对象之间的交互替代数据库表之间的操作</p>
<h2 id="一对一-单向-外键-关联"><a href="#一对一-单向-外键-关联" class="headerlink" title="一对一 单向_外键 关联"></a><strong>一对一 单向_外键 关联</strong></h2><p>1.husband的id是参考wife的;<br>2.husband有个wifiId字段是参考wife的id<br>husband有一个外键wifeid,只需要在husband配置即可<br>husabnd.java中有个属性:wife,而wife.java没有husband这个属性<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092854.png?raw=true" alt=""><br>或者<br><strong>xml方式配置【不推荐】</strong>  </p>
<pre><code>studentIdCard有student的id而student没有StudentIdCard的id  
在StuIdCard.xml中配置即可，使用studentId的字段存储来自student的id  
</code></pre><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092855.png?raw=true" alt="">  </p>
<h2 id="一对一双向外键关联"><a href="#一对一双向外键关联" class="headerlink" title="一对一双向外键关联"></a><strong>一对一双向外键关联</strong></h2><p>husband.java中有wife属性，表中有wifeid，而wife.java中有husband属性,数据库没有husbandId<br>mappyedby=(“wife”)指得是wife.java中的husband是由husband.java中的wife(对应mappedby中的wife)属性映射，不需要在数据库join husbandId<br>在husband.java中注解  @GeneratedValue id自动增长<br>双向表示双方通过属性.属性能互相访问到 mappedby一方被拥有的一方<br>如果没有mappedby 那么双方都生成了对方的主键 任何一张表都无法插入数据<br>只有其中一方设置 mappedby 它先插入数据 另一张表才能成功插入数据<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092856.png?raw=true" alt=""><br><strong>在wife.java中注解</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092857.png?raw=true" alt=""><br>或者<br><strong>xml方式配置</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092858.png?raw=true" alt="">  </p>
<h2 id="一对一单向主键关联"><a href="#一对一单向主键关联" class="headerlink" title="一对一单向主键关联"></a><strong>一对一单向主键关联</strong></h2><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092859.png?raw=true" alt=""><br>或者<br><strong>xml方式配置</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092860.png?raw=true" alt=""><br>这里的id参考的是 student里的 id</p>
<h2 id="一对一双向主键关联"><a href="#一对一双向主键关联" class="headerlink" title="一对一双向主键关联"></a><strong>一对一双向主键关联</strong></h2><p><strong>在husband.java设置</strong><br>因为2个表的ID是一致的 所以 不用哪一方先插入数据都可以<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092861.png?raw=true" alt=""><br><strong>在wife.java设置</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092862.png?raw=true" alt=""><br>或者<br><strong>xml方式配置</strong><br>在student.xml<br>name=”stuIdCard”中的stuIdCard就是指student中的属性名 ref+””指定由studentIdCard.java中的student属性映射<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092863.png?raw=true" alt=""><br>在studentIdCard.xml<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092864.png?raw=true" alt="">  </p>
<h2 id="一对一单向外键（联合主键）"><a href="#一对一单向外键（联合主键）" class="headerlink" title="一对一单向外键（联合主键）"></a><strong>一对一单向外键（联合主键）</strong></h2><p>编写wifePK.java<br>注意implements Serializable<br>在wife.java加注解<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092865.png?raw=true" alt=""><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092866.png?raw=true" alt=""><br>在husband.java加注解<br>表示在数据库表中的字段为 wife Id 和wifeName<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092867.png?raw=true" alt="">  </p>
<h2 id="组件映射"><a href="#组件映射" class="headerlink" title="组件映射"></a><strong>组件映射</strong></h2><p>只需要在husband配置注解即可把wife作为组件，而wife.java无需修改<br>2个对象组装为一个表  没有对应关系<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092868.png?raw=true" alt=""><br><strong>xml方式配置</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092869.png?raw=true" alt="">  </p>
<h2 id="多对一单向"><a href="#多对一单向" class="headerlink" title="多对一单向"></a><strong>多对一单向</strong></h2><p>在user.java中配置对group.java的多对一关系 在多的一方加Many2one<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092870.png?raw=true" alt=""><br>或者<br><strong>xml方式配置</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092871.png?raw=true" alt="">  </p>
<h2 id="一对多单向关联"><a href="#一对多单向关联" class="headerlink" title="一对多单向关联"></a><strong>一对多单向关联</strong></h2><p>在group.java中配置对user.java的一对多关联即可，user.java不需要配置<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092872.png?raw=true" alt=""><br>或者<br><strong>xml方式配置</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092873.png?raw=true" alt="">  </p>
<h2 id="一对多，多对一双向关联"><a href="#一对多，多对一双向关联" class="headerlink" title="一对多，多对一双向关联"></a><strong>一对多，多对一双向关联</strong></h2><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092874.png?raw=true" alt=""><br>xml:<br>user.xml<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092875.png?raw=true" alt=""><br>group.xml<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092876.png?raw=true" alt="">  </p>
<h2 id="多对多单向关联"><a href="#多对多单向关联" class="headerlink" title="多对多单向关联"></a><strong>多对多单向关联</strong></h2><p>先建立中间表teacher_student 里面的teacher_id student_id分别参考teacher 和student表的id<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092877.png?raw=true" alt=""><br>xml<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092878.png?raw=true" alt=""><br>这里有student的路径：指明teacher里能找到student 而student找不到teacher</p>
<h2 id="多对多双向关联"><a href="#多对多双向关联" class="headerlink" title="多对多双向关联"></a><strong>多对多双向关联</strong></h2><p>先建立中间表teacher_student 里面的teacher_id student_id分别参考teacher 和student表的id<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092879.png?raw=true" alt=""><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092880.png?raw=true" alt=""><br>xml<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092881.png?raw=true" alt=""><br>这里有student的路径：指明teacher里能找到student 而student找不到teacher<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092882.png?raw=true" alt="">  </p>
<h2 id="Hibernate如何实现分页查询"><a href="#Hibernate如何实现分页查询" class="headerlink" title="Hibernate如何实现分页查询"></a><strong>Hibernate如何实现分页查询</strong></h2><p>答：只需要提供HQL语句（调用Session的createQuery()方法）或查询条件（调用Session的createCriteria()方法）<br>设置查询起始行数和最大查询行数<br>并调用Query或Criteria接口的list()方法，Hibernate会自动生成分页查询的SQL语句。  </p>
<h3 id="getcurrentsession"><a href="#getcurrentsession" class="headerlink" title="getcurrentsession"></a><strong>getcurrentsession</strong></h3><p>不需要close，事务提交，自动clsoe，在commit前的session都是同一个   </p>
<h2 id="PS-1"><a href="#PS-1" class="headerlink" title="PS"></a><strong>PS</strong></h2><p>一般事务管理使用thread,但当需要跨数据库时需要使用JTA（使用transactionManager管理一个事务），如商品和财务分离的系统<br>一个管理商品，一个记账，使用JTA可以保证这一操作在同一个事务中<br>先opensession 在getcurrentsession 两个不是同一个，原因，session是一个接口，这两个是不同的实现类，所以不同</p>
<h2 id="Hibernate注解"><a href="#Hibernate注解" class="headerlink" title="Hibernate注解"></a><strong>Hibernate注解</strong></h2><h3 id="Transaction"><a href="#Transaction" class="headerlink" title="@Transaction"></a><strong>@Transaction</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092832.png?raw=true" alt="">  </p>
<h3 id="指定时间的精度-Temporal"><a href="#指定时间的精度-Temporal" class="headerlink" title="指定时间的精度@Temporal"></a><strong>指定时间的精度@Temporal</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092833.png?raw=true" alt="enter description
here">  </p>
<h3 id="枚举类型注解-Enumerated"><a href="#枚举类型注解-Enumerated" class="headerlink" title="枚举类型注解@Enumerated"></a><strong>枚举类型注解@Enumerated</strong></h3><p><strong>写好枚举类</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092834.png?raw=true" alt="enter description
here"><br><strong>引用枚举类并加上注解</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092835.png?raw=true" alt="enter description
here"><br><strong>EnumType.ORDINAL这是按枚举类型的下标插入表，而不是按他的值插入表</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092836.png?raw=true" alt="enter description
here">  </p>
<h3 id="Table"><a href="#Table" class="headerlink" title="@Table"></a><strong>@Table</strong></h3><p>当表名和类名不一致 还需在类上加上 @Table 指明 数据库中对应的表的表名<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092837.png?raw=true" alt="enter description
here">  </p>
<h3 id="ID生成策略"><a href="#ID生成策略" class="headerlink" title="ID生成策略"></a><strong>ID生成策略</strong></h3><p>在xml.让所使用的数据库选择ID策略（在mysql中，使用uuid,此时的实体类id改为String类型,如果是native（自动增长）则类型是int）选native和uuid方便数据库跨平台<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092838.png?raw=true" alt="enter description
here"><br>最后在插入数据时，不要求设置ID,只需要用户提供name 和age即可<br>Annotation版：<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092839.png?raw=true" alt="enter description
here"><br>同样，最后xml配置版的需要在配置文件加上映射 注解版则不需要<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092840.png?raw=true" alt="enter description
here">  </p>
<h3 id="联合主键"><a href="#联合主键" class="headerlink" title="联合主键"></a><strong>联合主键</strong></h3><h4 id="编写联合主键类"><a href="#编写联合主键类" class="headerlink" title="编写联合主键类"></a><strong>编写联合主键类</strong></h4><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092841.png?raw=true" alt="enter description
here"><br>重写equal和hashcode原因：数据库区分实体使用的是主键，但在内存中也需要使用类似的hashcode算法来区分不同的实体</p>
<h4 id="修改实体类"><a href="#修改实体类" class="headerlink" title="修改实体类"></a><strong>修改实体类</strong></h4><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092842.png?raw=true" alt="enter description
here">  </p>
<h4 id="修改xml映射文件"><a href="#修改xml映射文件" class="headerlink" title="修改xml映射文件"></a><strong>修改xml映射文件</strong></h4><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092843.png?raw=true" alt="">  </p>
<h3 id="Annotation版联合主键"><a href="#Annotation版联合主键" class="headerlink" title="Annotation版联合主键"></a><strong>Annotation版联合主键</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092844.png?raw=true" alt="">  </p>
<h3 id="LOAD-and-GET"><a href="#LOAD-and-GET" class="headerlink" title="LOAD and GET"></a><strong>LOAD and GET</strong></h3><p>session get 获取的是实际的对象，发出sql语句，有实际的数据<br>而session load 获取对象的代理，commit后通过代理取不到相应的对象，只有在commit之前，需要用到数据才会发出sql语句，所以没有实际数据<br>比如Teacher t = (Teacher)session.load(Teacher.class, 1000);即使数据库没有id=1000的记录，依旧不会报错，因为没有执行sql，而get会报错，因为它执行了sql </p>
<h2 id="update-persist对象"><a href="#update-persist对象" class="headerlink" title="update persist对象"></a><strong>update persist对象</strong></h2><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092848.png?raw=true" alt=""><br><strong>问题：</strong> commit时会匹配session和数据库是否一致，不一致就update,所有字段都会更新即使只有一个不同</p>
<h3 id="解决方法：xml中在属性的get方法设置-uptable为false"><a href="#解决方法：xml中在属性的get方法设置-uptable为false" class="headerlink" title="解决方法：xml中在属性的get方法设置@uptable为false"></a><strong>解决方法：xml中在属性的get方法设置@uptable为false</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092849.png?raw=true" alt=""><br><strong>问题：</strong>跨session时不好使，还是会把属性全部更新<br> <strong>解决方法：使用merge()</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092850.png?raw=true" alt=""><br><strong>问题：会先select相应的记录再和session的对象匹配</strong><br><strong>解决方法：</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092851.png?raw=true" alt=""> </p>
<h3 id="对象的三种状态"><a href="#对象的三种状态" class="headerlink" title="对象的三种状态"></a><strong>对象的三种状态</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092847.png?raw=true" alt=""><br>save之后session中有指向实体的引用（persist）缓存，数据库有id<br>commit之后数据库中有实体（detach），session中对其的缓存销毁了<br>save 之后的数据都暂时保存在session中  persist状态<br>只有事务提交了 才保存在数据库中  detach 状态     </p>
<h3 id="清除缓存session"><a href="#清除缓存session" class="headerlink" title="清除缓存session"></a><strong>清除缓存session</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092852.png?raw=true" alt="enter description
here">  </p>
<h3 id="强制session与数据库做同步：即flush一次相当于commit一次"><a href="#强制session与数据库做同步：即flush一次相当于commit一次" class="headerlink" title="强制session与数据库做同步：即flush一次相当于commit一次"></a><strong>强制session与数据库做同步：即flush一次相当于commit一次</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092853.png?raw=true" alt="enter description
here">  </p>
<h2 id="使用hibernatetemplate"><a href="#使用hibernatetemplate" class="headerlink" title="使用hibernatetemplate"></a><strong>使用hibernatetemplate</strong></h2><h3 id="使用hibernatetemplate示例"><a href="#使用hibernatetemplate示例" class="headerlink" title="使用hibernatetemplate示例"></a><strong>使用hibernatetemplate示例</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928131.png?raw=true" alt="">  </p>
<h2 id="为dao注入hibernateTemplate"><a href="#为dao注入hibernateTemplate" class="headerlink" title="为dao注入hibernateTemplate"></a><strong>为dao注入hibernateTemplate</strong></h2><p><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring21.png?raw=true" alt="">  </p>
<h2 id="为hibernateTemplate注入session-Factory"><a href="#为hibernateTemplate注入session-Factory" class="headerlink" title="为hibernateTemplate注入session Factory"></a><strong>为hibernateTemplate注入session Factory</strong></h2><p><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring22.png?raw=true" alt="">  </p>
<h2 id="sessionFactory注入配置文件"><a href="#sessionFactory注入配置文件" class="headerlink" title="sessionFactory注入配置文件"></a><strong>sessionFactory注入配置文件</strong></h2><p><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring23.png?raw=true" alt="">  </p>
<h3 id="查询所有记录"><a href="#查询所有记录" class="headerlink" title="查询所有记录"></a><strong>查询所有记录</strong></h3><p>使用hibernateTemplate的类必须先继承HibernateDaoSupport<code>public class CategoryDao extends HibernateDaoSupport</code></p>
<pre><code>public List&lt;Category&gt; findAll() {
        String hql = &quot;from Category&quot;;
        List&lt;Category&gt; list = this.getHibernateTemplate().find(hql);
        return list;
    }
</code></pre><h3 id="DetachedCriteria离线条件查询热门商品"><a href="#DetachedCriteria离线条件查询热门商品" class="headerlink" title="DetachedCriteria离线条件查询热门商品"></a><strong>DetachedCriteria离线条件查询<code>热门商品</code></strong></h3><p>从product表中查询<br>条件为 is_hot = 1<br>结果按日期的倒序排序输出<br>从第0条记录开始，往后查询20条记录<br>然后组装成list返回</p>
<pre class=" language-stata"><code class="language-stata">// 首页上热门商品查询
    public List<product> findHot() {
        // 使用离线条件查询.
        DetachedCriteria criteria = DetachedCriteria.forClass(Product.class);
        // 查询热门的商品,条件就是is_host = 1
        criteria.add(Restrictions.eq("is_hot", 1));
        // 按日期倒序排序输出:
        criteria.addOrder(Order.desc("pdate"));
        // 执行查询:
        List<product> list = this.getHibernateTemplate().findByCriteria(criteria, 0, 20);
        return list;
    }
</product></product></code></pre>
<h3 id="查询最新商品"><a href="#查询最新商品" class="headerlink" title="查询最新商品"></a><strong>查询最新商品</strong></h3><p><code>这里有个业务逻辑</code>：处理查询最新商品的业务，只需要查询所有记录，然后按日期倒序输出即可<br>从第0条记录开始，往后查询10条记录<br>然后组装成list返回</p>
<pre class=" language-stata"><code class="language-stata">// 首页上最新商品的查询
    public List<product> findNew() {
        // 使用离线条件查询:
        DetachedCriteria criteria = DetachedCriteria.forClass(Product.class);
        // 按日期进行倒序排序:
        criteria.addOrder(Order.desc("pdate"));
        // 执行查询:
        List<product> list = this.getHibernateTemplate().findByCriteria(criteria, 0, 10);
        return list;
    }
</product></product></code></pre>
<h3 id="从后台session获取列表并迭代列表里的元素"><a href="#从后台session获取列表并迭代列表里的元素" class="headerlink" title="从后台session获取列表并迭代列表里的元素"></a><strong>从后台session获取列表并迭代列表里的元素</strong></h3><p>迭代的每个元素p<br>获取该元素的id  image<br>p.id    p.image</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>s<span class="token operator">:</span>iterator var<span class="token operator">=</span><span class="token string">"p"</span> value<span class="token operator">=</span><span class="token string">"hList"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>li<span class="token operator">></span>
                <span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"${ pageContext.request.contextPath }/product_findByPid.action?pid=&lt;s:property value="</span>#p<span class="token punctuation">.</span>pid<span class="token string">"/>"</span>target<span class="token operator">=</span><span class="token string">"_blank"</span><span class="token operator">></span>
                        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> src<span class="token operator">=</span><span class="token string">"当前面目录下 即webroot下/图片的地址"</span>data<span class="token operator">-</span>original 可以暂时不管，他只是图片的真实存放地址，用于延迟加载<span class="token operator">--</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token string">"${pageContext.request.contextPath}/&lt;s:property value="</span>#p<span class="token punctuation">.</span>image<span class="token string">"/>"</span> data<span class="token operator">-</span>original<span class="token operator">=</span><span class="token string">"http://storage.shopxx.net/demo-image/3.0/201301/0ff130db-0a1b-4b8d-a918-ed9016317009-thumbnail.jpg"</span> style<span class="token operator">=</span><span class="token string">"display: block;"</span><span class="token operator">></span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>s<span class="token operator">:</span>iterator<span class="token operator">></span>    
</code></pre>
<h2 id="级联保存CascadeType"><a href="#级联保存CascadeType" class="headerlink" title="级联保存CascadeType"></a><strong>级联保存CascadeType</strong></h2><p>mappedby设置在一的一方，解决了当多的一方增加，不需要修改一的一方的代码<br>保存transient对象出问题<br>如下图g 没有被save    many2one     one2many     user保存 group不会跟着自动保存<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092883.png?raw=true" alt="">   </p>
<h3 id="解决方法1"><a href="#解决方法1" class="headerlink" title="解决方法1"></a><strong>解决方法1</strong></h3><p>把上图注释打开，先存g 再存 a</p>
<h3 id="解决方法2"><a href="#解决方法2" class="headerlink" title="解决方法2"></a><strong>解决方法2</strong></h3><p>在group.java 保存group时自动保存其关联对象<br><strong>设置group能级联保存</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092884.png?raw=true" alt=""><br><strong>测试</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092885.png?raw=true" alt=""><br>【不建议，因为一的一方设置了mappedby，在它的表中不用保存多的一方，所以自动保存一的一方那个不会出现null，而自动保存多的一方会出现null值】同理，可以在user.java即多的这一方设置 保存user时自动保存其关联对象g<br><strong>解决方法</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092886.png?raw=true" alt=""><br><strong>问题：在数据库里u没有g的数据</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092887.png?raw=true" alt=""><br><strong>解决方法：user设置group属性</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092888.png?raw=true" alt="">      </p>
<h2 id="结论"><a href="#结论" class="headerlink" title="结论"></a><strong>结论</strong></h2><p>存储时在save多的一方较容易只需要设多的一方即可 如果save一的一方则后需要 把多地一方再设一遍<br>many-to-one默认取多的一方user会把一的一方group取出来，即使不设置cascade为ALL而取一的一方group不会把多的一方user取出来<br><strong>测试</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092890.png?raw=true" alt="">    </p>
<h2 id="结论-1"><a href="#结论-1" class="headerlink" title="结论"></a><strong>结论</strong></h2><p>cascade管增删改 而fetch管读取<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092891.png?raw=true" alt=""><br>group的fetch是eager user是lazy 则在用user .getGroup时会发2条sql，一次是取user和group联合的,另一次因为group是eager的所以在第一次取group时，会顺带着把user再取一遍<br>在xml中懒加载设置<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092892.png?raw=true" alt=""><br>一对多设置eager情况：查看用户的权限；  </p>
<h2 id="update"><a href="#update" class="headerlink" title="update"></a><strong>update</strong></h2><p>(一般cascade设为all，否则可能更新其他的方法不成功，比如设为merge,就只有用merge方法时能更新)<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092893.png?raw=true" alt="">  </p>
<h3 id="delete"><a href="#delete" class="headerlink" title="delete"></a><strong>delete</strong></h3><p>在删除前如果不先删除其级联对象会把一个一方group也给删了，如果此时有其他对象级联了group，那么该对象也被清除，才能清除group<br>解决方法1：打破级联关系 先把级联对象设为空<br>解决方法二：使用sql语句<br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092894.png?raw=true" alt="">  </p>
<h3 id="deletegroup"><a href="#deletegroup" class="headerlink" title="deletegroup"></a><strong>deletegroup</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092895.png?raw=true" alt="">  </p>
<h3 id="list和iterate区别"><a href="#list和iterate区别" class="headerlink" title="list和iterate区别"></a><strong>list和iterate区别</strong></h3><p>list取的是id+所有信息 iterate取的是id 当用到的时候再根据id取相应的值<br>list每执行一次都会发出sql语句，而iterate会利用session级的缓存，只会发出一次sql语句</p>
<h3 id="pageBean的作用"><a href="#pageBean的作用" class="headerlink" title="pageBean的作用"></a><strong>pageBean的作用</strong></h3><p>主要用来存储页面的相关元素的信息</p>
<pre><code>public String findAll(){
        PageBean&lt;Employee&gt; pageBean = employeeService.findByPage(currPage);
        // 将pageBean存入栈中，以便于页面上通过struts标签来获取值
        ActionContext.getContext().getValueStack().push(pageBean);
        return &quot;findAll&quot;;
    }
</code></pre><pre><code>    public List&lt;Employee&gt; findByPage(int begin, int pageSize) {

        DetachedCriteria criteria = DetachedCriteria.forClass(Employee.class);
        @SuppressWarnings(&quot;unchecked&quot;)
        List&lt;Employee&gt; list = (List&lt;Employee&gt;) hibernateTemplate.findByCriteria(criteria, begin,pageSize);
        return list;
    }
</code></pre><h1 id="主键生成机制"><a href="#主键生成机制" class="headerlink" title="主键生成机制"></a><strong>主键生成机制</strong></h1><h2 id="Hibernate-的的不同属性含义"><a href="#Hibernate-的的不同属性含义" class="headerlink" title="Hibernate 的的不同属性含义"></a><strong>Hibernate 的的不同属性含义</strong></h2><h3 id="assigned"><a href="#assigned" class="headerlink" title="assigned"></a><strong>assigned</strong></h3><p>主键由外部程序生成。</p>
<h3 id="hilo"><a href="#hilo" class="headerlink" title="hilo"></a><strong>hilo</strong></h3><p>通过hi/lo 算法生成主键，需要额外的数据库表保存主键生成历史状态。</p>
<h3 id="seqhilo"><a href="#seqhilo" class="headerlink" title="seqhilo"></a><strong>seqhilo</strong></h3><p>与hilo 类似，通过hi/lo 算法生成主键，只是主键历史状态保存在Sequence中，适用于支持Sequence的数据库，如Oracle。</p>
<h3 id="increment"><a href="#increment" class="headerlink" title="increment"></a><strong>increment</strong></h3><p>主键按数值顺序递增<br>这种方式可能产生的问题是：如果有多个实例访问同一个数据库，那么由于各个实例各自维护主键状态，造成主键重复异常。</p>
<h3 id="identity"><a href="#identity" class="headerlink" title="identity"></a><strong>identity</strong></h3><p>数据库提供的主键生成机制。如DB2、SQL Server、MySQL </p>
<h3 id="sequence"><a href="#sequence" class="headerlink" title="sequence"></a><strong>sequence</strong></h3><p>采用数据库提供的sequence 机制生成主键。如Oralce的Sequence。  </p>
<h3 id="native"><a href="#native" class="headerlink" title="native"></a><strong>native</strong></h3><p>由Hibernate根据底层数据库自行采用identity、hilo、sequence其中一种主键生成方式。</p>
<h3 id="uuid-hex"><a href="#uuid-hex" class="headerlink" title="uuid.hex"></a><strong>uuid.hex</strong></h3><p>由Hibernate基于128 位唯一值产生算法生成16 进制数值（编码后以长度32 的字符串表示）作为主键。  </p>
<h3 id="uuid-string"><a href="#uuid-string" class="headerlink" title="uuid.string"></a><strong>uuid.string</strong></h3><p>与uuid.hex 类似，只是生成的主键未进行编码（长度16）。在某些数据库中可能出现问题（如PostgreSQL）。</p>
<h3 id="foreign"><a href="#foreign" class="headerlink" title="foreign"></a><strong>foreign</strong></h3><p>使用外部表的字段作为主键。<br><strong>PS</strong></p>
<pre><code>一般而言，利用uuid.hex方式生成主键将提供最好的性能和数据库平台适 应性。   
另外由于常用的数据库，如Oracle、DB2、SQLServer、MySql 等，都提 
供了易用的主键生成机制（Auto-Increase 字段或者Sequence）。我们可以在数 
据库提供的主键生成机制上，采用generator-class=native的主键生成方式。      
数据库提供的主键生成机制，往往是通过在一个内部表中保存当前主键状 
态（如对于自增型主键而言，此内部表中就维护着当前的最大值和递增量）， 
之后每次插入数据会读取这个最大值，然后加上递增量作为新记录的主键，之 
后再把这个新的最大值更新回内部表中，这样，一次Insert操作可能导致数据 
库内部多次表读写操作和数据的加锁解锁操作.
</code></pre><h1 id="Spring"><a href="#Spring" class="headerlink" title="Spring"></a>Spring</h1><h1 id="AOP与IOC的概念"><a href="#AOP与IOC的概念" class="headerlink" title="AOP与IOC的概念"></a><strong>AOP与IOC的概念</strong></h1><ul>
<li>通过控制反转（IOC）的技术达到松耦合的目的    </li>
<li>包含并管理应用对象的配置和生命周期，这个意义上是一种容器。<br>a) IOC：IOC控制反转主要强调的是程序之间的关系是由容器控制的，容器控制对象，控制了对外部资源的获取。而反转即为，在传统的编程中都是由我们创建对象获取依赖对象，而在IOC中是容器帮我们创建对象并注入依赖对象。<br>b) AOP：面向切面编程，主要是管理系统层的业务，比如日志，权限，事物等。AOP是将封装好的对象剖开，找出其中对多个对象产生影响的公共行为，并将其封装为一个可重用的模块，这个模块被命名为切面（aspect），切面将那些与业务逻辑无关，却被业务模块共同调用的逻辑提取并封装起来，减少了系统中的重复代码，降低了模块间的耦合度，同时提高了系统的可维护性。<h1 id="Spring事务"><a href="#Spring事务" class="headerlink" title="Spring事务"></a><strong>Spring事务</strong></h1>编程式事务管理  声明式事务管理  <h3 id="原子性"><a href="#原子性" class="headerlink" title="原子性"></a><strong>原子性</strong></h3>事务要么一致完成，要么全部回滚。ps：一家人就要整整齐齐<h3 id="一致性"><a href="#一致性" class="headerlink" title="一致性"></a><strong>一致性</strong></h3>事务开始前和结束后的状态保持一致<br>eg . A向B转账过程出错，钱能原路返回，A和B的金额总和不变。<h3 id="持久性"><a href="#持久性" class="headerlink" title="持久性"></a><strong>持久性</strong></h3>事务一经提交 不可改变。<h3 id="隔离性"><a href="#隔离性" class="headerlink" title="隔离性"></a><strong>隔离性</strong></h3>不同事务互不干扰。<br>Spring是非侵入性的，不改动原有代码<h2 id="事务的隔离级别"><a href="#事务的隔离级别" class="headerlink" title="事务的隔离级别"></a><strong>事务的隔离级别</strong></h2><h3 id="不可重复读"><a href="#不可重复读" class="headerlink" title="不可重复读"></a><strong>不可重复读</strong></h3>A事务在进行中，不能有B事务参与<br>否则，A事务的提交或者回滚会使B事务的更新丢失，相当于做了无用功  <h3 id="脏读"><a href="#脏读" class="headerlink" title="脏读"></a><strong>脏读</strong></h3>A事务读取到了B事务正在进行中未提交的数据，如果B事务回滚，该数据就是脏数据  <h3 id="幻读"><a href="#幻读" class="headerlink" title="幻读"></a><strong>幻读</strong></h3>A事务2次读取相同数据不一致，第一次是在B事物未开启时的数据第二次是在B事务开启后的数据<br><img src="https://github.com/54321decba/tu/blob/master/2018-09-24/2018092402.png?raw=true" alt="">  <h2 id="事务的传播行为"><a href="#事务的传播行为" class="headerlink" title="事务的传播行为"></a><strong>事务的传播行为</strong></h2>控制多种操作是否处于同一个事务，方便回滚事务<br>eg.取款业务=取钱+打印凭条。<br>虽然这两个操作处于同一个业务中，但不能是同一事务，因为取钱后，如果打印凭条出错，不能把取钱的操作回滚，因为钱已经取出了。<br>eg.删除用户=删除基本信息+删除订单信息。 这两个操作必须处于同一事务，因为在删除订单信息出错，前面的没有回滚，那么订单信息就成了垃圾数据，无法正常删除<br><img src="https://github.com/54321decba/tu/blob/master/2018-09-24/2018092403.png?raw=true" alt=""><br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928129.png?raw=true" alt="">    <h1 id="事务的应用"><a href="#事务的应用" class="headerlink" title="事务的应用"></a>事务的应用</h1><h3 id="平时一般怎么处理事务呢？"><a href="#平时一般怎么处理事务呢？" class="headerlink" title="平时一般怎么处理事务呢？"></a><strong>平时一般怎么处理事务呢？</strong></h3>spring的事务是通过“声明式事务”的方式对事务进行管理，即在配置文件中进行声明，通过AOP将事务切面切入程序，最大的好处是大大减少了代码量，提高了工作效率。<h3 id="Spring整合ORM框架时事务管理用的是"><a href="#Spring整合ORM框架时事务管理用的是" class="headerlink" title="Spring整合ORM框架时事务管理用的是"></a><strong>Spring整合ORM框架时事务管理用的是</strong></h3>由相应ORM框架的事务管理器类如Hibernate对应于HibernateTransactionManager<br>整合过后可配置由Spring控制事务的提交。  <h2 id="环绕通知"><a href="#环绕通知" class="headerlink" title="环绕通知"></a><strong>环绕通知</strong></h2><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring8.png?raw=true" alt="">  <h3 id="织入"><a href="#织入" class="headerlink" title="织入"></a><strong>织入</strong></h3>是一个动作 即在被代理的方法前后 执行拦截逻辑的动作<h3 id="连接点"><a href="#连接点" class="headerlink" title="连接点"></a><strong>连接点</strong></h3>没有被拦截的方法+被拦截的方法<h3 id="切入点"><a href="#切入点" class="headerlink" title="切入点"></a><strong>切入点</strong></h3>特殊的连接点 被拦截的方法<h3 id="通知"><a href="#通知" class="headerlink" title="通知"></a><strong>通知</strong></h3>拦截后执行的逻辑<br>在aop：config中写入拦截的方法aop:before<br><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring9.png?raw=true" alt=""><br><strong>切入点的写法</strong><br><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring10.png?raw=true" alt="">  <h3 id="通用切入点-必须配置在切面的前面"><a href="#通用切入点-必须配置在切面的前面" class="headerlink" title="通用切入点 必须配置在切面的前面"></a><strong>通用切入点 必须配置在切面的前面</strong></h3><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring11.png?raw=true" alt=""><br><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring12.png?raw=true" alt=""><br><strong>后置只有被拦截的方法正确执行后才会执行</strong><h2 id="开始配置事务"><a href="#开始配置事务" class="headerlink" title="开始配置事务"></a><strong>开始配置事务</strong></h2><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring24.png?raw=true" alt="">  <h2 id="配置事务"><a href="#配置事务" class="headerlink" title="配置事务"></a><strong>配置事务</strong></h2><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring25.png?raw=true" alt="">  <h3 id="配置事务的通知"><a href="#配置事务的通知" class="headerlink" title="配置事务的通知"></a><strong>配置事务的通知</strong></h3><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring26.png?raw=true" alt="">  <h3 id="配置aop"><a href="#配置aop" class="headerlink" title="配置aop"></a><strong>配置aop</strong></h3><img src="https://github.com/54321decba/tu/blob/master/2018-09-17/spring27.png?raw=true" alt="">  <h2 id="AOP切面拦截器"><a href="#AOP切面拦截器" class="headerlink" title="AOP切面拦截器"></a><strong>AOP切面拦截器</strong></h2><strong>AOP是一种编程范式解决特定问题，不能解决所有问题<br>是OOP的补充，不是替代</strong><br><strong>编程范式概览</strong>  </li>
</ul>
<pre><code>面向过程编程  
面向对象编程  
面向函数编程（函数式编程）  
事件驱动编程（GUI开发中比较常见）  
面向切面编程  
</code></pre><p> <strong>AOP的应用场景</strong>  </p>
<pre><code>权限控制
缓存控制
事务控制
审计日志
性能监控
分布式追踪
异常处理
</code></pre><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928117.png?raw=true" alt=" "><br>源码无需改变 编写自己的切面逻辑<br>pointCut指定对哪些方法加切面逻辑<br>本来是写在@Before的括号内的 但为了方便 统一定义为 一个 myMethod(){}并在前指定对哪些方法加切面逻辑<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928118.png?raw=true" alt=""><br>也可以在xml中实现AOP<br>①编写自己的切面逻辑<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928119.png?raw=true" alt=" "><br>②在xml中指定为哪些方法加切面逻辑<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928120.png?raw=true" alt=" "><br>配置事务管理<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928126.png?raw=true" alt=""><br>在service加注解<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928127.png?raw=true" alt=""><br>也可以使用XML进行事务管理<br>先指定对哪些方法 进行事务管理 再具体细分各种方法对应的事务管理<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928128.png?raw=true" alt="">  </p>
<h1 id="事务策略定义事务传播行为和隔离级别-再编写切面行为"><a href="#事务策略定义事务传播行为和隔离级别-再编写切面行为" class="headerlink" title="事务策略定义事务传播行为和隔离级别 再编写切面行为"></a>事务策略定义事务传播行为和隔离级别 再编写切面行为</h1><p>java程序中如何使用事务<br>在java操作数据库时，为了保证数据的一致性，比如账户操作(1)从一个账户中减掉10$(2)在另一个账户上加入10$,我们看看如何使用事务？   </p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> junit<span class="token punctuation">.</span>test<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DriverManager<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Statement<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransationTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 1.加载驱动</span>
            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"oracle.jdbc.driver.OracleDriver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 2.得到连接</span>
            conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:oracle:thin:@127.0.0.1:1521:orcl"</span><span class="token punctuation">,</span> <span class="token string">"scott"</span><span class="token punctuation">,</span> <span class="token string">"oracle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Statement sm <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 从scott的sal中减去100</span>
            sm<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token string">"update emp set sal=sal-100 where ename='SCOTT'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">7</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//报java.lang.ArithmeticException: / by zero异常</span>
            <span class="token comment" spellcheck="true">// 给smith的sal加上100</span>
            sm<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token string">"update emp set sal=sal+100 where ename='SMITH'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 关闭打开的资源</span>
            sm<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 如果发生异常，就回滚</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                conn<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre>
<p>运行，会出现异常，查看数据库，SCOTT 的sal 减了100，但是SMITH 的sal 却不变，很可怕。。。<br>我们怎样才能保证，这两个操作要么同时成功，要么同时失败呢？<br>设置sql不自动提交：conn.setAutoCommit(false);// 设置不能默认提交  </p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> junit<span class="token punctuation">.</span>test<span class="token punctuation">;</span>

<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Connection<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>DriverManager<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>SQLException<span class="token punctuation">;</span>
<span class="token keyword">import</span> java<span class="token punctuation">.</span>sql<span class="token punctuation">.</span>Statement<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TransationTest</span> <span class="token punctuation">{</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span>String<span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        Connection conn <span class="token operator">=</span> null<span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 1.加载驱动</span>
            Class<span class="token punctuation">.</span><span class="token function">forName</span><span class="token punctuation">(</span><span class="token string">"oracle.jdbc.driver.OracleDriver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 2.得到连接</span>
            conn <span class="token operator">=</span> DriverManager<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token string">"jdbc:oracle:thin:@127.0.0.1:1521:orcl"</span><span class="token punctuation">,</span> <span class="token string">"scott"</span><span class="token punctuation">,</span> <span class="token string">"oracle"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 加入事务处理</span>
            conn<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true">// 设置不能默认提交</span>
            Statement sm <span class="token operator">=</span> conn<span class="token punctuation">.</span><span class="token function">createStatement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 从scott的sal中减去100</span>
            sm<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token string">"update emp set sal=sal-100 where ename='SCOTT'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">7</span> <span class="token operator">/</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 给smith的sal加上100</span>
            sm<span class="token punctuation">.</span><span class="token function">executeUpdate</span><span class="token punctuation">(</span><span class="token string">"update emp set sal=sal+100 where ename='SMITH'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 提交事务</span>
            conn<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// 关闭打开的资源</span>
            sm<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            conn<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// 如果发生异常，就回滚</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                conn<span class="token punctuation">.</span><span class="token function">rollback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e1<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e1<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre>
<h2 id="给session配置自动扫描"><a href="#给session配置自动扫描" class="headerlink" title="给session配置自动扫描"></a><strong>给session配置自动扫描</strong></h2><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928123.png?raw=true" alt="">  </p>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a><strong>使用方法</strong></h2><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928125.png?raw=true" alt="">  </p>
<h1 id="装备bean的多种方式"><a href="#装备bean的多种方式" class="headerlink" title="装备bean的多种方式"></a>装备bean的多种方式</h1><h3 id="第一种autowired-需要写bean"><a href="#第一种autowired-需要写bean" class="headerlink" title="第一种autowired,需要写bean"></a><strong>第一种autowired,需要写bean</strong></h3><p>byname 是和 service的属性名相同的bean<br>bytype 是和servicec属性类型相同的bean<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928103.png?raw=true" alt=""></p>
<h3 id="第一种autowired-不需要写bean，只需要开启注解配置"><a href="#第一种autowired-不需要写bean，只需要开启注解配置" class="headerlink" title="第一种autowired,不需要写bean，只需要开启注解配置"></a><strong>第一种autowired,不需要写bean，只需要开启注解配置</strong></h3><p> 在beans.xml中<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928107.png?raw=true" alt=""><br>然后便可以在service 的setDao方法上加注解<br>默认bytype 即按照service的 DAO属性类型注入<br>如果按名称需要像下面在serUserDao括号里写明<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928108.png?raw=true" alt="">  </p>
<h3 id="或者不写autowired注解，加resource注解"><a href="#或者不写autowired注解，加resource注解" class="headerlink" title="或者不写autowired注解，加resource注解"></a><strong>或者不写autowired注解，加resource注解</strong></h3><p>默认byname<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928109.png?raw=true" alt=""><br>但这只是指明了各个组件之间的关系 ，仍需要把各个bean 如service， daoimpl写到xml中<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928110.png?raw=true" alt="">  </p>
<h3 id="第二种：使用自动扫描"><a href="#第二种：使用自动扫描" class="headerlink" title="第二种：使用自动扫描"></a><strong>第二种：使用自动扫描</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928111.png?raw=true" alt=""><br>在类上配置bean<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928112.png?raw=true" alt=""><br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928113.png?raw=true" alt=""><br>而UserDaoImpl是userservice的一个资源<br>在serviceimpl的setUserDaoimol上加resource注解<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928114.png?raw=true" alt="">  </p>
<h1 id="bean的scope"><a href="#bean的scope" class="headerlink" title="bean的scope"></a><strong>bean的scope</strong></h1><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928101.png?raw=true" alt=""><br><img src="https://github.com/54321decba/tu/blob/master/201811/20181113.png?raw=true" alt=""><br>prototype:原始类型，每次用都是全新的<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928102.png?raw=true" alt="">  </p>
<p>###<br><strong>BeanFactory:</strong><br>延迟加载思想创建对象，即用到bean时才创建bean<br>ApplicationContext:<br>立即加载思想创建对象，即解析完配置文件就创建bean<br>⑴. 继承了 BeanFactory，拥有了基本的 IoC 功能；<br>⑵. 除此之外，ApplicationContext 还提供了以下功能：<br>① 支持国际化；② 支持消息机制；③ 支持统一的资源加载；④ 支持AOP功能；<br><strong>•注意：</strong><br>如果 Bean 没有完全注入，BeanFactory 加载后，会在你第一次调用 getBean 方法找不到依赖才会抛出异常；<br>而 ApplicationContext 会在初始化的时候就加载并且检查，这样的好处是可以及时检查依赖是否完全注入；所以通常我们会选择 ApplicationContext。</p>
<p>###<br>【推荐使用】ClassPathXmlApplicationContext:<br>只能加载类路径下的配置文件<br>FileSystemXmlApplicationContext：<br>可以加载磁盘任意位置的配置文件    </p>
<h1 id="Spring-xml"><a href="#Spring-xml" class="headerlink" title="Spring.xml"></a><strong>Spring.xml</strong></h1><h2 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a><strong>第一种</strong></h2><p><strong>总结：</strong>该文件主要是配置Hibernate事务（而事务需要sessionFactory，sessionFactory需要数据源等信息）</p>
<ul>
<li>配置Hibernate事务(需要sessionFactory)  </li>
<li>配置sessionFactory(需要数据源及其他配置，如指定数据库方言、显示sql语句和自动建表)</li>
<li><p>配置数据源:设置驱动、数据库的URL、数据库的用户名及密码</p>
<h3 id="将hibernate的SessionFactory交由spring管理-sessionFactory需要dataSource"><a href="#将hibernate的SessionFactory交由spring管理-sessionFactory需要dataSource" class="headerlink" title="将hibernate的SessionFactory交由spring管理:sessionFactory需要dataSource"></a><strong>将hibernate的SessionFactory交由spring管理:sessionFactory需要dataSource</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928122.png?raw=true" alt="">  </p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
  xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns<span class="token operator">:</span>aop<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/aop"</span>
  xmlns<span class="token operator">:</span>tx<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/tx"</span>
  xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"
          http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">.</span>xsd
          http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop<span class="token operator">/</span>spring<span class="token operator">-</span>aop<span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">.</span>xsd
          http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx<span class="token operator">/</span>spring<span class="token operator">-</span>tx<span class="token operator">-</span><span class="token number">2.5</span><span class="token punctuation">.</span>xsd"<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置数据源 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"dataSource"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.jdbc.datasource.DriverManagerDataSource"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 驱动名称oracle<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>driver<span class="token punctuation">.</span>OracleDriver <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"driverClassName"</span> value<span class="token operator">=</span><span class="token string">"com.mysql.jdbc.Driver"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 连接数据库的URL jdbc<span class="token operator">:</span>oracle<span class="token operator">:</span>thin<span class="token operator">:</span><span class="token annotation punctuation">@localhost</span><span class="token operator">:</span><span class="token number">1521</span><span class="token operator">:</span>orcl <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"url"</span> value<span class="token operator">=</span><span class="token string">"jdbc:mysql://localhost:3306/test1"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 连接数据库的用户名 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"username"</span> value<span class="token operator">=</span><span class="token string">"root"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 连接数据库的密码 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"password"</span> value<span class="token operator">=</span><span class="token string">"135246"</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置SessionFactory <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"sessionFactory"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定数据源 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"dataSource"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定hibernate的相关属性 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"hibernateProperties"</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>props<span class="token operator">></span>
              <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定数据库方言org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>dialect<span class="token punctuation">.</span>Oracle10gDialect <span class="token operator">--</span><span class="token operator">></span>
              <span class="token operator">&lt;</span>prop key<span class="token operator">=</span><span class="token string">"hibernate.dialect"</span><span class="token operator">></span>org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>dialect<span class="token punctuation">.</span>MySQLInnoDBDialect<span class="token operator">&lt;</span><span class="token operator">/</span>prop<span class="token operator">></span>
              <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 显示SQL语句 <span class="token operator">--</span><span class="token operator">></span>
              <span class="token operator">&lt;</span>prop key<span class="token operator">=</span><span class="token string">"hibernate.show_sql"</span><span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>prop<span class="token operator">></span>
              <span class="token operator">&lt;</span>prop key<span class="token operator">=</span><span class="token string">"hibernate.hbm2ddl.auto"</span><span class="token operator">></span>create<span class="token operator">&lt;</span><span class="token operator">/</span>prop<span class="token operator">></span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>props<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>

      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 指定ORM映射文件 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"mappingResources"</span><span class="token operator">></span>
          <span class="token operator">&lt;</span>list<span class="token operator">></span>
              <span class="token operator">&lt;</span>value<span class="token operator">></span>com<span class="token operator">/</span>pb<span class="token operator">/</span>entity<span class="token operator">/</span>User<span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span>
          <span class="token operator">&lt;</span><span class="token operator">/</span>list<span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Hibernate声明式事务 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"transactionManager"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.orm.hibernate3.HibernateTransactionManager"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 注入sessionFactory属性 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 数据访问层<span class="token punctuation">(</span>DAO<span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 基类Dao <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"baseDao"</span> <span class="token keyword">abstract</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.pb.dao.impl.BaseDaoImpl"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 注入SessionFactory属性 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 注入ptm属性 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"ptm"</span> ref<span class="token operator">=</span><span class="token string">"transactionManager"</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> UserDao <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"userDao"</span> parent<span class="token operator">=</span><span class="token string">"baseDao"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.pb.dao.impl.UserDaoImpl"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 业务逻辑层<span class="token punctuation">(</span>BIZ<span class="token punctuation">)</span> <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> UserBiz <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"userBiz"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.pb.biz.impl.UserBizImpl"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dao"</span> ref<span class="token operator">=</span><span class="token string">"userDao"</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 控制层 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 基类Action <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"baseAction"</span> <span class="token keyword">abstract</span><span class="token operator">=</span><span class="token string">"true"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.pb.web.action.BaseAction"</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置UserAction <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"userAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.pb.web.action.UserAction"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"biz"</span> ref<span class="token operator">=</span><span class="token string">"userBiz"</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">></span>
</code></pre>
<h2 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a><strong>第二种</strong></h2></li>
</ul>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
    xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    xmlns<span class="token operator">:</span>context<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/context"</span>
    xmlns<span class="token operator">:</span>aop<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/aop"</span>
    xmlns<span class="token operator">:</span>tx<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/tx"</span>
    xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token operator">-</span><span class="token number">3.1</span><span class="token punctuation">.</span>xsd
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context<span class="token operator">/</span>spring<span class="token operator">-</span>context<span class="token punctuation">.</span>xsd
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop<span class="token operator">/</span>spring<span class="token operator">-</span>aop<span class="token punctuation">.</span>xsd
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx<span class="token operator">/</span>spring<span class="token operator">-</span>tx<span class="token punctuation">.</span>xsd"<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置连接池<span class="token operator">:</span> <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 引入外部属性文件 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>context<span class="token operator">:</span>property<span class="token operator">-</span>placeholder location<span class="token operator">=</span><span class="token string">"classpath:jdbc.properties"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置C3P0连接池<span class="token operator">:</span> <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"dataSource"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.mchange.v2.c3p0.ComboPooledDataSource"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"driverClass"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.driver}"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"jdbcUrl"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.url}"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"user"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.user}"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"password"</span> value<span class="token operator">=</span><span class="token string">"${jdbc.password}"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Hibernate的相关信息 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"sessionFactory"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.orm.hibernate3.LocalSessionFactoryBean"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 注入连接池 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"dataSource"</span> ref<span class="token operator">=</span><span class="token string">"dataSource"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置Hibernate的其他的属性 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"hibernateProperties"</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>props<span class="token operator">></span>
                <span class="token operator">&lt;</span>prop key<span class="token operator">=</span><span class="token string">"hibernate.dialect"</span><span class="token operator">></span>org<span class="token punctuation">.</span>hibernate<span class="token punctuation">.</span>dialect<span class="token punctuation">.</span>MySQLDialect<span class="token operator">&lt;</span><span class="token operator">/</span>prop<span class="token operator">></span>
                <span class="token operator">&lt;</span>prop key<span class="token operator">=</span><span class="token string">"hibernate.show_sql"</span><span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>prop<span class="token operator">></span>
                <span class="token operator">&lt;</span>prop key<span class="token operator">=</span><span class="token string">"hibernate.format_sql"</span><span class="token operator">></span><span class="token boolean">true</span><span class="token operator">&lt;</span><span class="token operator">/</span>prop<span class="token operator">></span>
                <span class="token operator">&lt;</span>prop key<span class="token operator">=</span><span class="token string">"hibernate.connection.autocommit"</span><span class="token operator">></span><span class="token boolean">false</span><span class="token operator">&lt;</span><span class="token operator">/</span>prop<span class="token operator">></span>
                <span class="token operator">&lt;</span>prop key<span class="token operator">=</span><span class="token string">"hibernate.hbm2ddl.auto"</span><span class="token operator">></span>update<span class="token operator">&lt;</span><span class="token operator">/</span>prop<span class="token operator">></span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>props<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置Hibernate的映射文件 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"mappingResources"</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>list<span class="token operator">></span>
                <span class="token operator">&lt;</span>value<span class="token operator">></span>cn<span class="token operator">/</span>itcast<span class="token operator">/</span>shop<span class="token operator">/</span>user<span class="token operator">/</span>vo<span class="token operator">/</span>User<span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span>
                <span class="token operator">&lt;</span>value<span class="token operator">></span>cn<span class="token operator">/</span>itcast<span class="token operator">/</span>shop<span class="token operator">/</span>category<span class="token operator">/</span>vo<span class="token operator">/</span>Category<span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span>
                <span class="token operator">&lt;</span>value<span class="token operator">></span>cn<span class="token operator">/</span>itcast<span class="token operator">/</span>shop<span class="token operator">/</span>product<span class="token operator">/</span>vo<span class="token operator">/</span>Product<span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span>
                <span class="token operator">&lt;</span>value<span class="token operator">></span>cn<span class="token operator">/</span>itcast<span class="token operator">/</span>shop<span class="token operator">/</span>categorysecond<span class="token operator">/</span>vo<span class="token operator">/</span>CategorySecond<span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span>
                <span class="token operator">&lt;</span>value<span class="token operator">></span>cn<span class="token operator">/</span>itcast<span class="token operator">/</span>shop<span class="token operator">/</span>order<span class="token operator">/</span>vo<span class="token operator">/</span>Order<span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span>
                <span class="token operator">&lt;</span>value<span class="token operator">></span>cn<span class="token operator">/</span>itcast<span class="token operator">/</span>shop<span class="token operator">/</span>order<span class="token operator">/</span>vo<span class="token operator">/</span>OrderItem<span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span>
                <span class="token operator">&lt;</span>value<span class="token operator">></span>cn<span class="token operator">/</span>itcast<span class="token operator">/</span>shop<span class="token operator">/</span>adminuser<span class="token operator">/</span>vo<span class="token operator">/</span>AdminUser<span class="token punctuation">.</span>hbm<span class="token punctuation">.</span>xml<span class="token operator">&lt;</span><span class="token operator">/</span>value<span class="token operator">></span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>list<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>property<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 事务管理<span class="token operator">:</span> <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 事务管理器 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"transactionManager"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.orm.hibernate3.HibernateTransactionManager"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 开启注解事务 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>tx<span class="token operator">:</span>annotation<span class="token operator">-</span>driven transaction<span class="token operator">-</span>manager<span class="token operator">=</span><span class="token string">"transactionManager"</span><span class="token operator">/</span><span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Action的配置 <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">--</span><span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 首页访问的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"indexAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.index.action.IndexAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"categoryService"</span> ref<span class="token operator">=</span><span class="token string">"categoryService"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"productService"</span> ref<span class="token operator">=</span><span class="token string">"productService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置验证码Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"checkImgAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.user.action.CheckImgAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 用户模块的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"userAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.user.action.UserAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 注入Service <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"userService"</span> ref<span class="token operator">=</span><span class="token string">"userService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 商品模块的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"productAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.product.action.ProductAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"productService"</span> ref<span class="token operator">=</span><span class="token string">"productService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 购物车的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"cartAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.cart.action.CartAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"productService"</span> ref<span class="token operator">=</span><span class="token string">"productService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置OrderAction <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"orderAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.order.action.OrderAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"orderService"</span> ref<span class="token operator">=</span><span class="token string">"orderService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置后台登录的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"adminUserAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.adminuser.action.AdminUserAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"adminUserService"</span> ref<span class="token operator">=</span><span class="token string">"adminUserService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置后台一级管理的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"adminCategoryAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.category.adminaction.AdminCategoryAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"categoryService"</span> ref<span class="token operator">=</span><span class="token string">"categoryService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置后台二级分类管理的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"adminCategorySecondAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.categorysecond.adminaction.AdminCategorySecondAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"categorySecondService"</span> ref<span class="token operator">=</span><span class="token string">"categorySecondService"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"categoryService"</span> ref<span class="token operator">=</span><span class="token string">"categoryService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置后台商品管理的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"adminProductAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.product.adminaction.AdminProductAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"productService"</span> ref<span class="token operator">=</span><span class="token string">"productService"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"categorySecondService"</span> ref<span class="token operator">=</span><span class="token string">"categorySecondService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置后台订单管理的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"adminOrderAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.order.adminaction.AdminOrderAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"orderService"</span> ref<span class="token operator">=</span><span class="token string">"orderService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置后台用户管理的Action <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"userAdminAction"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.user.adminaction.UserAdminAction"</span> scope<span class="token operator">=</span><span class="token string">"prototype"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"userService"</span> ref<span class="token operator">=</span><span class="token string">"userService"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>


    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Service的配置  <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"userService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.user.service.UserService"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"userDao"</span> ref<span class="token operator">=</span><span class="token string">"userDao"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"categoryService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.category.service.CategoryService"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"categoryDao"</span> ref<span class="token operator">=</span><span class="token string">"categoryDao"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"productService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.product.service.ProductService"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"productDao"</span> ref<span class="token operator">=</span><span class="token string">"productDao"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"orderService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.order.service.OrderService"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"orderDao"</span> ref<span class="token operator">=</span><span class="token string">"orderDao"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"adminUserService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.adminuser.service.AdminUserService"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"adminUserDao"</span> ref<span class="token operator">=</span><span class="token string">"adminUserDao"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"categorySecondService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.categorysecond.service.CategorySecondService"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"categorySecondDao"</span> ref<span class="token operator">=</span><span class="token string">"categorySecondDao"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Dao的配置  <span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">=</span><span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"userDao"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.user.dao.UserDao"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"categoryDao"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.category.dao.CategoryDao"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>    

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"productDao"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.product.dao.ProductDao"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"orderDao"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.order.dao.OrderDao"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"adminUserDao"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.adminuser.dao.AdminUserDao"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>

    <span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"categorySecondDao"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"cn.itcast.shop.categorysecond.dao.CategorySecondDao"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"sessionFactory"</span> ref<span class="token operator">=</span><span class="token string">"sessionFactory"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">></span>

</code></pre>
<p>jdbc.properties</p>
<pre class=" language-java"><code class="language-java">jdbc<span class="token punctuation">.</span>driver <span class="token operator">=</span> com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
jdbc<span class="token punctuation">.</span>url <span class="token operator">=</span> jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token comment" spellcheck="true">//shop</span>
jdbc<span class="token punctuation">.</span>user <span class="token operator">=</span> root
jdbc<span class="token punctuation">.</span>password <span class="token operator">=</span><span class="token number">135246</span>
</code></pre>
<h3 id="beans-xml文件"><a href="#beans-xml文件" class="headerlink" title="beans.xml文件"></a><strong>beans.xml文件</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092897.png?raw=true" alt="">  </p>
<h1 id="Spring的ContextLoaderListener"><a href="#Spring的ContextLoaderListener" class="headerlink" title="Spring的ContextLoaderListener"></a><strong>Spring的ContextLoaderListener</strong></h1><p><strong>在配置文件中的配置示例：</strong></p>
<pre class=" language-java"><code class="language-java">  <span class="token operator">&lt;</span>listener<span class="token operator">></span>
    <span class="token operator">&lt;</span>listener<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>context<span class="token punctuation">.</span>ContextLoaderListener<span class="token operator">&lt;</span><span class="token operator">/</span>listener<span class="token operator">-</span><span class="token keyword">class</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>listener<span class="token operator">></span>
</code></pre>
<p><strong>解析</strong><br><code>public class ContextLoaderListener extends Object implements ServletContextListener</code><br><strong>部署配置文件、创建Bean</strong><br>实现Servlet的上下文监听器，在启动Web容器时，自动装配Spring applicationContext.xml<br>如果在web.xml中不写任何参数配置信息，默认的路径是”/WEB-INF/applicationContext.xml，在WEB-INF目录下创建的xml文件的名称必须是applicationContext.xml。如果是要自定义文件名可以在web.xml里加入contextConfigLocation这个context参数：</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>context<span class="token operator">-</span>param<span class="token operator">></span>
<span class="token operator">&lt;</span>param<span class="token operator">-</span>name<span class="token operator">></span>contextConfigLocation<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>name<span class="token operator">></span>
<span class="token operator">&lt;</span>param<span class="token operator">-</span>value<span class="token operator">></span>
<span class="token operator">/</span>WEB<span class="token operator">-</span>INF<span class="token operator">/</span>classes<span class="token operator">/</span>applicationContext<span class="token operator">-</span><span class="token operator">*</span><span class="token punctuation">.</span>xml
<span class="token operator">&lt;</span><span class="token operator">/</span>param<span class="token operator">-</span>value<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>context<span class="token operator">-</span>param<span class="token operator">></span>
</code></pre>
<h2 id="2种常用的注入方式"><a href="#2种常用的注入方式" class="headerlink" title="2种常用的注入方式"></a><strong>2种常用的注入方式</strong></h2><h3 id="设值注入"><a href="#设值注入" class="headerlink" title="设值注入"></a><strong>设值注入</strong></h3><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"injectionService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.aaa.service.Serviceimpl"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"injectionDAO"</span> ref<span class="token operator">=</span><span class="token string">"injectionDAO"</span><span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
<span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"injectionDAO"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.aaa.dao.DAOimpl"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
</code></pre>
<h3 id="构造方法注入"><a href="#构造方法注入" class="headerlink" title="构造方法注入"></a><strong>构造方法注入</strong></h3><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"injectionService"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.aaa.service.Serviceimpl"</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>consructor<span class="token operator">-</span>arg name<span class="token operator">=</span><span class="token string">"injectionDAO"</span> ref<span class="token operator">=</span><span class="token string">"injectionDAO"</span><span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
<span class="token operator">&lt;</span>bean id<span class="token operator">=</span><span class="token string">"injectionDAO"</span> <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"com.aaa.dao.DAOimpl"</span><span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
</code></pre>
<h3 id="构造方法注入和设值注入有什么区别？"><a href="#构造方法注入和设值注入有什么区别？" class="headerlink" title="构造方法注入和设值注入有什么区别？"></a><strong>构造方法注入和设值注入有什么区别？</strong></h3><p>请注意以下明显的区别：<br>在设值注入方法支持大部分的依赖注入，对于基本类型，不用设值注入，可以设置默认值。    <strong>在对象创建前调用</strong><br>在构造方法注入不支持大部分的依赖注入，因为在调用构造方法中必须传入正确的构造参数，否则的话为报错。 <strong>在对象创建时调用</strong><br>设值注入是为了解决构造方法注入遇到的<strong>2个对象互相依赖无法注入</strong>的问题</p>
<h3 id="为impl中的简单属性的注入初始值"><a href="#为impl中的简单属性的注入初始值" class="headerlink" title="为impl中的简单属性的注入初始值"></a><strong>为impl中的简单属性的注入初始值</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/2018092898.png?raw=true" alt=""><br><img src="https://github.com/54321decba/tu/blob/master/blog/2018092899.png?raw=true" alt="">  </p>
<h3 id="为impl注入集合类"><a href="#为impl注入集合类" class="headerlink" title="为impl注入集合类"></a><strong>为impl注入集合类</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928105.png?raw=true" alt="">  </p>
<h3 id="service的初始化以及结束方法"><a href="#service的初始化以及结束方法" class="headerlink" title="service的初始化以及结束方法"></a><strong>service的初始化以及结束方法</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928104.png?raw=true" alt="">  </p>
<h3 id="bean的生命周期用注解"><a href="#bean的生命周期用注解" class="headerlink" title="bean的生命周期用注解"></a><strong>bean的生命周期用注解</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/blog/20180928115.png?raw=true" alt=""><br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928116.png?raw=true" alt="">  </p>
<h1 id="一些凤毛麟角的解释"><a href="#一些凤毛麟角的解释" class="headerlink" title="一些凤毛麟角的解释"></a><font color="red"><strong>一些凤毛麟角的解释</strong></font></h1><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span>

</code></pre>
<p>每个XML文档都由XML序言开始，在前面的代码中的第一行便是XML序言，&lt;?xml version=”1.0”?&gt;。这一行代码会告诉解析器和浏览器，这个文件应该按照1.0版本的XML规则进行解析。<br>encoding = “utf-8”表示此xml文件采用utf-8的编码格式。</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>beans xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span>
    xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
    xmlns<span class="token operator">:</span>context<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/context"</span>
    xmlns<span class="token operator">:</span>aop<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/aop"</span>
    xmlns<span class="token operator">:</span>tx<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/tx"</span>
    xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token operator">-</span><span class="token number">4.2</span><span class="token punctuation">.</span>xsd 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context<span class="token operator">/</span>spring<span class="token operator">-</span>context<span class="token operator">-</span><span class="token number">4.2</span><span class="token punctuation">.</span>xsd 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>aop<span class="token operator">/</span>spring<span class="token operator">-</span>aop<span class="token operator">-</span><span class="token number">4.2</span><span class="token punctuation">.</span>xsd 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx 
    http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>tx<span class="token operator">/</span>spring<span class="token operator">-</span>tx<span class="token punctuation">.</span>xsd"<span class="token operator">></span>
</code></pre>
<p>xml规范与namespace</p>
<h2 id="mybatis-xml"><a href="#mybatis-xml" class="headerlink" title="mybatis.xml"></a><strong>mybatis.xml</strong></h2><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span> <span class="token operator">?</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">!</span>DOCTYPE configuration
PUBLIC <span class="token string">"-//mybatis.org//DTD Config 3.0//EN"</span>
<span class="token string">"http://mybatis.org/dtd/mybatis-3-config.dtd"</span><span class="token operator">></span>
<span class="token operator">&lt;</span>configuration<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 开启驼峰命名规则 <span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>settings<span class="token operator">></span>
        <span class="token operator">&lt;</span>setting name<span class="token operator">=</span><span class="token string">"mapUnderscoreToCamelCase"</span> value<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>settings<span class="token operator">></span>

    <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置别名 实体类的位置 方便引用<span class="token operator">--</span><span class="token operator">></span>
    <span class="token operator">&lt;</span>typeAliases<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token keyword">package</span> name<span class="token operator">=</span><span class="token string">"com.crud.dao"</span><span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>typeAliases<span class="token operator">></span>

    <span class="token operator">&lt;</span>plugins<span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> com<span class="token punctuation">.</span>github<span class="token punctuation">.</span>pagehelper为PageHelper类所在包名 <span class="token operator">--</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>plugin interceptor<span class="token operator">=</span><span class="token string">"com.github.pagehelper.PageInterceptor"</span><span class="token operator">></span>
            <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 不到达不正确的页码 <span class="token operator">--</span><span class="token operator">></span>
            <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"reasonable"</span> value<span class="token operator">=</span><span class="token string">"true"</span><span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>plugin<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>plugins<span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>configuration<span class="token operator">></span>
</code></pre>
<h1 id="jdbc-properties文件"><a href="#jdbc-properties文件" class="headerlink" title="jdbc.properties文件"></a><strong>jdbc.properties文件</strong></h1><pre class=" language-java"><code class="language-java">jdbc<span class="token punctuation">.</span>driver<span class="token operator">=</span>com<span class="token punctuation">.</span>mysql<span class="token punctuation">.</span>jdbc<span class="token punctuation">.</span>Driver
jdbc<span class="token punctuation">.</span>url<span class="token operator">=</span>jdbc<span class="token operator">:</span>mysql<span class="token operator">:</span><span class="token operator">/</span><span class="token comment" spellcheck="true">//ssmcurd?useSSL=true</span>
jdbc<span class="token punctuation">.</span>username<span class="token operator">=</span>root
jdbc<span class="token punctuation">.</span>password<span class="token operator">=</span><span class="token number">135246</span>
</code></pre>
<h1 id="spring-mvc-xml文件"><a href="#spring-mvc-xml文件" class="headerlink" title="spring-mvc.xml文件"></a><strong>spring-mvc.xml文件</strong></h1><p><strong>总结</strong>  </p>
<ul>
<li>contriller的自动扫描包</li>
<li><p>视图解析器 即页面的前缀和后缀</p>
<pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span><span class="token operator">?</span>xml version<span class="token operator">=</span><span class="token string">"1.0"</span> encoding<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">?</span><span class="token operator">></span>
<span class="token operator">&lt;</span>beans xmlns<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/beans"</span>
  xmlns<span class="token operator">:</span>xsi<span class="token operator">=</span><span class="token string">"http://www.w3.org/2001/XMLSchema-instance"</span> xmlns<span class="token operator">:</span>p<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/p"</span>
  xmlns<span class="token operator">:</span>context<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/context"</span>
  xmlns<span class="token operator">:</span>mvc<span class="token operator">=</span><span class="token string">"http://www.springframework.org/schema/mvc"</span>
  xsi<span class="token operator">:</span>schemaLocation<span class="token operator">=</span>"http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>beans<span class="token operator">/</span>spring<span class="token operator">-</span>beans<span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">.</span>xsd
      http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>mvc http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>mvc<span class="token operator">/</span>spring<span class="token operator">-</span>mvc<span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">.</span>xsd
      http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>www<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>org<span class="token operator">/</span>schema<span class="token operator">/</span>context<span class="token operator">/</span>spring<span class="token operator">-</span>context<span class="token operator">-</span><span class="token number">4.0</span><span class="token punctuation">.</span>xsd"<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 跳转逻辑的配置 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 扫描业务逻辑组件，配置组件扫描器，注解式使用，只扫描控制器<span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>context<span class="token operator">:</span>component<span class="token operator">-</span>scan base<span class="token operator">-</span><span class="token keyword">package</span><span class="token operator">=</span><span class="token string">"com.crud.controller"</span> <span class="token operator">/</span><span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token number">2</span><span class="token punctuation">.</span>配置视图解析器 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>bean <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 前缀 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"prefix"</span> value<span class="token operator">=</span><span class="token string">"/WEB-INF/views/"</span> <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 后缀 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token operator">&lt;</span>property name<span class="token operator">=</span><span class="token string">"suffix"</span> value<span class="token operator">=</span><span class="token string">".jsp"</span> <span class="token operator">/</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>bean<span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 两个标准配置 <span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 把spirngmvc不能处理的请求交给tomcat 比如静态资源图片等<span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>mvc<span class="token operator">:</span><span class="token keyword">default</span><span class="token operator">-</span>servlet<span class="token operator">-</span>handler<span class="token operator">/</span><span class="token operator">></span>

  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 配置注解驱动 映射动态请求 支持springmvc一些高级功能，比如JSR303校验，快捷AJAX请求<span class="token operator">--</span><span class="token operator">></span>
  <span class="token operator">&lt;</span>mvc<span class="token operator">:</span>annotation<span class="token operator">-</span>driven<span class="token operator">/</span><span class="token operator">></span>
<span class="token operator">&lt;</span><span class="token operator">/</span>beans<span class="token operator">></span>
</code></pre>
</li>
</ul>
<h1 id="Service文件"><a href="#Service文件" class="headerlink" title="Service文件"></a><strong>Service文件</strong></h1><h2 id="Service"><a href="#Service" class="headerlink" title="@Service "></a><font color="red"><strong>@Service</strong> </font></h2><p>如果一个类带了@Service注解，将自动注册到Spring容器，不需要再在applicationContext.xml文件定义bean了</p>
<h2 id="Autowired-1"><a href="#Autowired-1" class="headerlink" title=" @Autowired   "></a><font color="red"><strong> @Autowired  </strong> </font></h2><p>@Autowired 注释，它可以对类成员变量、方法及构造函数进行标注，完成自动装配的工作。 通过 @Autowired的使用来消除 set ，get方法。在使用@Autowired之前，我们对一个bean配置起属性时，是这用用的</p>
<h1 id="Cacheable注解"><a href="#Cacheable注解" class="headerlink" title="Cacheable注解"></a>Cacheable注解</h1><p>@Cacheable可以标记在一个方法上，也可以标记在一个类上。当标记在一个方法上时表示该方法是支持缓存的，当标记在一个类上时则表示该类所有的方法都是支持缓存的。<br> 对于一个支持缓存的方法，Spring会在其被调用后将其返回值缓存起来，以保证下次利用同样的参数来执行该方法时可以直接从缓存中获取结果，而不需要再次执行该方法。<br> Spring在缓存方法的返回值时是以键值对进行缓存的，值就是方法的返回结果，至于键的话，Spring又支持两种策略，默认策略和自定义策略，这个稍后会进行说明。<br> 需要注意的是当一个支持缓存的方法在对象内部被调用时是不会触发缓存功能的。@Cacheable可以指定三个属性，value、key和condition<br> <a href="https://www.cnblogs.com/fashflying/p/6908028.html" target="_blank" rel="noopener">详情参照</a></p>
<h1 id="swagger注释"><a href="#swagger注释" class="headerlink" title="swagger注释"></a>swagger注释</h1><p>作用范围    API    使用位置<br>对象属性    @ApiModelProperty    用在参数对象的字段上<br>协议集描述    @Api    用于controller类上<br>协议描述    @ApiOperation    用在controller的方法上<br>Response集    @ApiResponses    用在controller的方法上<br>Response    @ApiResponse    用在 @ApiResponses里边<br>非对象参数集    @ApiImplicitParams    用在controller的方法上<br>非对象参数描述    @ApiImplicitParam    用在@ApiImplicitParams的方法里边<br>描述返回对象的意义    @ApiModel    用在返回对象类上  </p>
<h1 id="Springboot-tomcat-embed-jasper"><a href="#Springboot-tomcat-embed-jasper" class="headerlink" title="Springboot tomcat-embed-jasper"></a>Springboot tomcat-embed-jasper</h1><p>编译jsp的jasper包</p>
<h1 id="题外话"><a href="#题外话" class="headerlink" title="题外话"></a>题外话</h1><p>使用过Springboot的同学都知道其已内置tomcat（spring-boot-starter-web），无需打war包，打成jar包直接运行。最近学习使用Springboot发现项目中的pom文件引入了tomcat-embed-jasper（对jsp的支持的依赖）但scope为provided。<br>于是不明白感觉springboot的tomcat应该自带了tomcat-embed-jasper吧，遂将pom文件该依赖删掉，eclipse启动项目无报错，访问页面发现所有的jsp页面都会被下载而不能被访问。但是又一个令我疑惑的问题是其依赖scope为provided,也就是说打包时该依赖不会被包含在lib包内，但是我的jar启动的页面访问却没有问题。<br>以上说明一个问题：springboot自带的tomcat并没有携带tomcat-embed-jasper的依赖。<br>又做了一个实验：将tomcat-embed-jasper的scope去掉后，打成jar包，启动项目时报错==&gt;jasper的jar包冲突。<br>  结论猜测：检查pom文件后，猜测一定是spring-boot-maven-plugin（1.4.2.RELEASE）插件在打包时自动额外的添加tomcat-embed-jasper的支持。而我们在工具中启动项目时并没有打包，所以需要该依赖对我们eclipse中项目jsp的支持，为防止其打包冲突，遂设置其scope为provided。</p>
<h1 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h1><h2 id="Hibernate和Mybatis的区别"><a href="#Hibernate和Mybatis的区别" class="headerlink" title="Hibernate和Mybatis的区别"></a><strong>Hibernate和Mybatis的区别</strong></h2><p>首先Hibernate和Mybatis都是对数据库的封装。<br>区别只是在于封装得彻不彻底。<br>hibernate封装得很彻底,屏蔽了sql语句的编写，更加面向对象，但导致了sql调优的困难，怎么设计O/R映射，在性能和对象模型之间如何权衡，以及怎样用好Hibernate需要具有很强的经验和能力才行。<br>而mybatis则部分屏蔽，是一个不完全ORM框架，sql语句需要自己写，而且把sql写在了配置文件里与代码分离开，通过XML或注解方式配置要运行的sql语句，并将java对象和sql映射生成最终执行的sql，最后将sql执行结果映射成java对象，可严格控制sql执行性能，但是灵活的前提是mybatis无法做到数据库无关性，如果需要实现支持多种数据库的软件则需要自定义多套sql映射文件，工作量大。<br><img src="https://github.com/54321decba/tu/blob/master/all/2018092902.png?raw=true" alt=""></p>
<h2 id="引入hibernate的原因"><a href="#引入hibernate的原因" class="headerlink" title="引入hibernate的原因"></a><strong>引入hibernate的原因</strong></h2><p> 面向对象是从软件工程基本原则(如耦合、聚合、封装)的基础上发展起来的，而关系数据库则是从数学理论发展而来的.  引入hibernate解决了关系数据库技术与面向对象不匹配的现象</p>
<h2 id="什么是Mybatis"><a href="#什么是Mybatis" class="headerlink" title="什么是Mybatis"></a><strong>什么是Mybatis</strong></h2><p>MyBatis 可以使用简单的 XML 或注解来配置和映射原生信息，将接口和 Java 的 POJOs(Plain Ordinary Java Object,普通的 Java对象)映射成数据库中的记录。  </p>
<h2 id="Mybatis是如何进行分页的？分页插件的原理是什么？"><a href="#Mybatis是如何进行分页的？分页插件的原理是什么？" class="headerlink" title="Mybatis是如何进行分页的？分页插件的原理是什么？"></a><strong>Mybatis是如何进行分页的？分页插件的原理是什么？</strong></h2><p>Mybatis使用RowBounds对象进行分页，它是针对ResultSet结果集执行的内存分页，而非物理分页，可以在sql内直接书写带有物理分页的参数来完成物理分页功能，也可以使用分页插件来完成物理分页。<br>分页插件的基本原理是使用Mybatis提供的插件接口，实现自定义插件，在插件的拦截方法内拦截待执行的sql，然后重写sql，根据dialect方言，添加对应的物理分页语句和物理分页参数。<br>举例：select <em> from student，拦截sql后重写为：select t.</em> from （select * from student）t limit 0，10<br>简述Mybatis的插件运行原理，以及如何编写一个插件<br>Mybatis仅可以编写针对ParameterHandler、ResultSetHandler、StatementHandler、Executor这4种接口的插件，Mybatis使用JDK的动态代理，为需要拦截的接口生成代理对象以实现接口方法拦截功能，每当执行这4种接口对象的方法时，就会进入拦截方法，具体就是InvocationHandler的invoke()方法，当然，只会拦截那些你指定需要拦截的方法。<br>实现Mybatis的Interceptor接口并复写intercept()方法，然后在给插件编写注解，指定要拦截哪一个接口的哪些方法即可，记住，别忘了在配置文件中配置你编写的插件。  </p>
<h3 id="和-的区别是什么？"><a href="#和-的区别是什么？" class="headerlink" title="#{}和${}的区别是什么？"></a><strong>#{}和${}的区别是什么？</strong></h3><p>在Mybatis中，有两种占位符<br><strong>#{}解析传递进来的参数数据</strong><br>${}对传递进来的参数原样拼接在SQL中<br><strong>#{}是预编译处理，${}是字符串替换。</strong><br>使用#{}可以有效的防止SQL注入，提高系统安全性</p>
<h1 id="dao接口与xml映射文件"><a href="#dao接口与xml映射文件" class="headerlink" title="dao接口与xml映射文件"></a>dao接口与xml映射文件</h1><h3 id="Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？"><a href="#Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？" class="headerlink" title="Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？"></a><strong>Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？</strong></h3><p>Dao接口即Mapper接口<br>接口的全限名=映射文件中的namespace的值<br>接口的方法名=映射文件中MappedStatement的id值<br>接口方法内的参数=传递给sql的参数<br>Mapper接口是没有实现类的，当调用接口方法时，接口全限名+方法名拼接字符串作为key值，可唯一定位一个MappedStatement<br><strong>举例：</strong><br>在Mybatis中，每一个select、insert、update、delete标签，都会被解析为一个MappedStatement对象。<br>com.mybatis3.mappers.StudentDao.findStudentById，<br>可以唯一找到namespace为com.mybatis3.mappers.StudentDao中id = findStudentById的MappedStatement。<br><strong>注意：</strong><br>Dao接口里的方法，是不能重载的，因为是全限名+方法名的保存和寻找策略。<br><strong>Dao接口的工作原理：</strong><br>JDK动态代理，Mybatis运行时使用JDK动态代理为Dao接口生成代理proxy对象，代理对象proxy会拦截接口方法，转而执行MappedStatement所代表的sql，然后将sql执行结果返回  </p>
<h3 id="Mybatis的Xml映射文件中，不同的Xml映射文件，id是否可以重复？"><a href="#Mybatis的Xml映射文件中，不同的Xml映射文件，id是否可以重复？" class="headerlink" title="Mybatis的Xml映射文件中，不同的Xml映射文件，id是否可以重复？"></a><strong>Mybatis的Xml映射文件中，不同的Xml映射文件，id是否可以重复？</strong></h3><p>namespace不同可以重复，因为我们的Statement实际上就是namespace+id</p>
<h3 id="Mybatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？"><a href="#Mybatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？" class="headerlink" title="Mybatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？"></a><strong>Mybatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？</strong></h3><p>完成逻辑判断和动态拼接sql的功能。<br>Mybatis提供了9种动态sql标签：trim|where|set|foreach|if|choose|when|otherwise|bind。<br><strong>执行原理</strong><br>使用OGNL从sql参数对象中计算表达式的值，根据表达式的值动态拼接sql，以此来完成动态sql的功能。</p>
<h1 id="Mybatis延迟加载"><a href="#Mybatis延迟加载" class="headerlink" title="Mybatis延迟加载"></a>Mybatis延迟加载</h1><h2 id="Mybatis是否支持延迟加载？实现原理是什么？"><a href="#Mybatis是否支持延迟加载？实现原理是什么？" class="headerlink" title="Mybatis是否支持延迟加载？实现原理是什么？"></a><strong>Mybatis是否支持延迟加载？实现原理是什么？</strong></h2><p>association关联对象，association指的就是一对一<br>collection关联集合对象，collection指的就是一对多查询。<br>在Mybatis配置文件中，可以配置是否启用延迟加载<code>lazyLoadingEnabled=true|false</code></p>
<p><strong>原理:</strong><br>使用cglib创建代理对象，当调用目标方法时，进入拦截器方法。<br><strong>比如</strong><br>调用a.getB().getName()，拦截器invoke()方法发现a.getB()是null值，那么就会单独发送事先保存好的查询关联B对象的sql，把B查询上来，然后调用a.setB(b)，于是a的对象b属性就有值了，接着完成a.getB().getName()方法的调用。这就是延迟加载的基本原理。  </p>
<p>除了Mybatis，几乎所有的包括Hibernate，支持延迟加载的原理都是一样的。</p>
<h1 id="Mybatis接口绑定的实现方式"><a href="#Mybatis接口绑定的实现方式" class="headerlink" title="Mybatis接口绑定的实现方式"></a>Mybatis接口绑定的实现方式</h1><p>一种是通过注解绑定,就是在接口的方法上面加上@Select@Update等注解里面包含Sql语句来绑定<br>另外一种就是通过xml里面写SQL来绑定,在这种情况下,要指定xml映射文件里面的namespace必须为接口的全路径名 </p>
<h1 id="在mapper中如何传递多个参数"><a href="#在mapper中如何传递多个参数" class="headerlink" title="在mapper中如何传递多个参数"></a><strong>在mapper中如何传递多个参数</strong></h1><p><strong>第一种：使用占位符</strong><br>在映射文件中使用#{0},#{1}代表传递进来的第几个参数<br>在java代码中使用@param注解:来命名参数<br><strong>#{0},#{1}方式</strong><br>//对应的xml,#{0}代表接收的是dao层中的第一个参数，#{1}代表dao层中第二参数   </p>
<pre><code>&lt;select id=&quot;selectUser&quot;resultMap=&quot;BaseResultMap&quot;&gt;  
    select *  fromuser_user_t   whereuser_name = #{0} anduser_area=#{1}  
&lt;/select&gt;  
</code></pre><p><strong>@param注解方式</strong></p>
<pre><code>        public interface usermapper { 
         user selectuser(@param(“username”) string username, 
         @param(“hashedpassword”) string hashedpassword); 
        }
 &lt;select id=”selectuser” resulttype=”user”&gt; 
         select id, username, hashedpassword 
         from some_table 
         where username = #{username} 
         and hashedpassword = #{hashedpassword} 
    &lt;/select&gt;
</code></pre><p>【当参数超过2个时使用】<strong>第二种：使用Map集合作为参数来装载</strong></p>
<pre><code>  try{
            //映射文件的命名空间.SQL片段的ID，就可以调用对应的映射文件中的SQL
            /**
             * 由于我们的参数超过了两个，而方法中只有一个Object参数收集
             * 因此我们使用Map集合来装载我们的参数
             */
            Map&lt;String, Object&gt; map = new HashMap();
            map.put(&quot;start&quot;, start);
            map.put(&quot;end&quot;, end);
            return sqlSession.selectList(&quot;StudentID.pagination&quot;, map);
        }catch(Exception e){
            e.printStackTrace();
            sqlSession.rollback();
            throw e;
        }finally{
            MybatisUtil.closeSqlSession();
        }        
</code></pre><pre><code>&lt;!--分页查询--&gt;
    &lt;select id=&quot;pagination&quot; parameterType=&quot;map&quot; resultMap=&quot;studentMap&quot;&gt;
        /*根据key自动找到对应Map集合的value*/
        select * from students limit #{start},#{end};
    &lt;/select&gt;
</code></pre><h1 id="Config配置"><a href="#Config配置" class="headerlink" title="Config配置"></a>Config配置</h1><h2 id="properties"><a href="#properties" class="headerlink" title="properties"></a><strong>properties</strong></h2><p> <strong>3种配置方式：</strong>  </p>
<h2 id="第一种：property元素，配置代码示例如下"><a href="#第一种：property元素，配置代码示例如下" class="headerlink" title="第一种：property元素，配置代码示例如下"></a><strong>第一种：property元素，配置代码示例如下</strong></h2><pre><code>&lt;properties&gt;
    &lt;properties name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
    &lt;properties name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis&quot;/&gt;
    &lt;properties name=&quot;username&quot; value=&quot;root&quot;/&gt;
    &lt;properties name=&quot;password&quot; value=&quot;****&quot;/&gt;
&lt;/properties&gt;
</code></pre><h2 id="第二种：怎么使用？"><a href="#第二种：怎么使用？" class="headerlink" title="第二种：怎么使用？"></a><strong>第二种：怎么使用？</strong></h2><pre><code>&lt;dataSource type=&quot;POOLED&quot;&gt;
    &lt;properties name=&quot;driver&quot; value=&quot;${driver}&quot;/&gt;
    &lt;properties name=&quot;url&quot; value=&quot;{url}&quot;/&gt;
    &lt;properties name=&quot;username&quot; value=&quot;${username}&quot;/&gt;
    &lt;properties name=&quot;password&quot; value=&quot;${password}&quot;/&gt;
&lt;/dataSource&gt;
</code></pre><p><strong>properties配置文件作用：</strong>方便在多个配置文件中重复使用，便于修改和维护，有的时候为了数据的安全，在jdbc.properties配置密文，通过程序明文解密，保证系统的安全。<br> <strong>properties文件代码示例</strong><br><strong>第三种：数据库配置文件</strong>   </p>
<pre><code>driver=com.mysql.jdbc.Driver
url=jdbc:mysql://localhost:3306/mybatis
username=root
password=****
</code></pre><h2 id="如何使用？"><a href="#如何使用？" class="headerlink" title="如何使用？"></a><strong>如何使用？</strong></h2><p>将配置文件放到源包下即可  <code>&lt;properties resource=&quot;jdbc.properties&quot;/&gt;</code></p>
<h2 id="三种配置方式的优先级"><a href="#三种配置方式的优先级" class="headerlink" title="三种配置方式的优先级"></a><strong>三种配置方式的优先级</strong></h2><p>第三种通过程序方法参数传递的属性具有最高优先级，resource/url属性中指定的配置文件次之，最低优先级是properties元素中指定的属性。            </p>
<h2 id="settings"><a href="#settings" class="headerlink" title="settings"></a><strong>settings</strong></h2><p>settings是mybatis最复杂的配置，也是最重要的配置，配置内容繁多，这里不予总结，配置内容项自行了解，那么如何配置哪？ 完整的配置示例如下<br> <img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101031.png?raw=true" alt=""> </p>
<pre><code>&lt;settings&gt;
    &lt;settings name=&quot;cacheEnable&quot; value=&quot;true&quot;/&gt;
    &lt;settings name=&quot;lazyLoadingEnabled&quot; value=&quot;true&quot;/&gt;
    &lt;settings name=&quot;multipleResultSetsEnabled&quot; value=&quot;true&quot;/&gt;
    &lt;settings name=&quot;useColumnLabel&quot; value=&quot;true&quot;/&gt;
    &lt;settings name=&quot;useGeneratedKeys&quot; value=&quot;false&quot;/&gt;
    &lt;settings name=&quot;autoMappingBehavior&quot; value=&quot;PARTIAL&quot;/&gt;
    &lt;settings name=&quot;defaultExecutorType&quot; value=&quot;SIMPLE&quot;/&gt;
    &lt;settings name=&quot;defaultStatementTimeout&quot; value=&quot;25&quot;/&gt;
    &lt;settings name=&quot;safeRowBoundsEnabled&quot; value=&quot;false&quot;/&gt;
    &lt;settings name=&quot;mapUnderscoreToCamelCase&quot; value=&quot;false&quot;/&gt;
    &lt;settings name=&quot;localCacheScope&quot; value=&quot;SESSION&quot;/&gt;
    &lt;settings name=&quot;jdbcTypeForNull&quot; value=&quot;OTHER&quot;/&gt;
    &lt;settings name=&quot;lazyLoadTriggerMethods&quot; value=&quot;equals,clone,hashCode,toString&quot;/&gt;
&lt;/settings&gt;
</code></pre><h2 id="typeAliases"><a href="#typeAliases" class="headerlink" title="typeAliases"></a><strong>typeAliases</strong></h2><h2 id="作用："><a href="#作用：" class="headerlink" title="作用："></a><strong>作用：</strong></h2><p>别名可以代替过长类全限定名，在mybatis上下文中使用。  </p>
<h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a><strong>分类</strong></h2><p><strong>系统自定义别名：如下表</strong><br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101030.png?raw=true" alt=""><br><strong>自定义别名：</strong><br>示例代码如下，使用role代替其类的全路径，减少配置的复杂度               </p>
<pre><code>&lt;!--定义别名--!&gt;
&lt;typeAliases&gt;
    &lt;typeAlias alias=&quot;role&quot; type=&quot;com.liming.domain.po.Role&quot;/&gt;
&lt;/typeAlias&gt;
</code></pre><h2 id="typeHandler"><a href="#typeHandler" class="headerlink" title="typeHandler"></a><strong>typeHandler</strong></h2><h2 id="作用：-1"><a href="#作用：-1" class="headerlink" title="作用："></a><strong>作用：</strong></h2><p> 预处理语句（PreparedStatemen）中设置参数或者从结果集（ResultSet）中取值，都需要注册了的typeHandler进行类型转换。   </p>
<h2 id="分类："><a href="#分类：" class="headerlink" title="分类："></a><strong>分类：</strong></h2><p>（1）系统定义<br><strong>系统注册的TypeHandler</strong><br> <strong>代码示例</strong>                                          </p>
<pre><code>public TypeHandlerRegistry(){
    register(Boolean.class, new BooleanTypeHandler());
    register(boolean.class, new BooleanTypeHandler());
    register(JdbcType.BOOLEAN, new BooleanTypeHandler());
    register(JdbcType.BIT, new BooleanTypeHandler());
    ......
    register(Character.class, new CharacterTypeHandler());
    register(char.class, new CharacterTypeHandler());
}
</code></pre><p> <strong>常用配置</strong><br> java类型（javaType）、JDBC类型（jdbcType）。TypeHandler将参数从javaType转换为jdbcType，或者从数据库取出结果时把jdbcType转换为javaType   </p>
<h2 id="自定义"><a href="#自定义" class="headerlink" title="自定义"></a><strong>自定义</strong></h2><p> <strong>注册自定义typeHandler，重新覆盖字符串参数的typeHandler</strong>                                </p>
<pre><code>&lt;typeHandlers&gt;
    &lt;typeHandler jdbc=&quot;VARCHAR&quot; javaType=&quot;string&quot; 
handler=&quot;com.liming.domain.typeHandler.myStringTypeHandler&quot;/&gt;
&lt;/typeHandlers&gt;
</code></pre><p> <strong>通过扫描注册typeHandle</strong></p>
<pre><code>&lt;typeHandlers&gt;
    &lt;package name=&quot;com.liming.domain.typeHandler&quot;/&gt;
&lt;/typeHandlers&gt;                                     
</code></pre><h2 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a><strong>枚举</strong></h2><p>mybatis提供了俩个转化枚举类型的typeHandle：org.apache.ibatis.type.EnumTypeHandler和org.apache.ibatis.type.EnumOrdinalTypeHandler。</p>
<h2 id="ObjectFactory"><a href="#ObjectFactory" class="headerlink" title="ObjectFactory"></a><strong>ObjectFactory</strong></h2><h3 id="1-作用："><a href="#1-作用：" class="headerlink" title="1 作用："></a><strong>1 作用：</strong></h3><p>mybatis构建结果返回的时候，会使用ObjectFactory（对象工厂）构建POJO。</p>
<h3 id="2-分类-："><a href="#2-分类-：" class="headerlink" title="2 分类 ："></a><strong>2 分类 ：</strong></h3><p>（1）默认的，mybatis中默认的ObjectFactory是由org.apache.ibatis.reflection.factory.DefaultObjectFactory来提供服务的。<br>（2）自定义 ，定义新的ObjectFactory代码示例如下，实现代码的时候，我们新的ObjectFactory类直接继承DefaultObjectFactory来实现ObjectFactory的接口。  </p>
<pre><code>&lt;objectFactory type=&quot;com.liming.domain.objectFactory.MyObjectFactory&quot;&gt;
    &lt;property name=&quot;name&quot; value=&quot;MyObjectFactory&quot;/&gt;
&lt;/objectFactory&gt;
</code></pre><h2 id="plugins"><a href="#plugins" class="headerlink" title="plugins"></a>plugins</h2><h2 id="environments"><a href="#environments" class="headerlink" title="environments"></a>environments</h2><h3 id="1-作用：-1"><a href="#1-作用：-1" class="headerlink" title="1 作用："></a><strong>1 作用：</strong></h3><p>主要是用来配置连接池的数据源。</p>
<h3 id="2-数据源俩大部分："><a href="#2-数据源俩大部分：" class="headerlink" title="2 数据源俩大部分："></a><strong>2 数据源俩大部分：</strong></h3><p>（1）数据库源的配置，通过dataSource标签来配置数据源连接信息，通过子标签property来定义数据库的各类参数，type属性代表数据库连接方式的配置，提供如下四种：<br> 1）UNPOOLED，非连接池数据库（UnpooledDataSource）；<br> 2）POOLED，连接池数据库（PooledDataSource）；<br> 3）JNDI，JNDI数据源（JNDIDataSource）；<br> 4）自定义数据源，必须实现org.apache.ibatis.datasource.DataSourceFactory接口<br>（2）数据库事务的配置，通过transactionManager标签来配置，通过子标签property来配置数据源的各类属性，type属性包含如下三种配置方式<br> 1）JDBC，采用JDBC方式管理事务，在独立编码中常用；<br>  2）MANAGED，采用容器方式管理事务，在JNDI数据源中常用；<br> 3）自定义，由开发者自定义数据库事务管理方法，适用于特殊应用；<br>（3）一个数据源完整配置的代码示例    </p>
<pre><code>&lt;environments default=&quot;development&quot;&gt;
    &lt;environment id=&quot;development&quot;&gt;
        &lt;transactionManager type=&quot;JDBC&quot;&gt;
            &lt;property name=&quot;autoCommit&quot; value=&quot;false&quot;&gt;
        &lt;/transactionManager&gt;
        &lt;dataSource type=&quot;POOLED&quot;&gt;
            &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
            &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis&quot;/&gt;
            &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
            &lt;property name=&quot;password&quot; value=&quot;****&quot;/&gt;
        &lt;/dataSource&gt;
    &lt;/environment&gt;
&lt;/environments&gt;
</code></pre><p>备注：environment中的属性default，表明缺省情况下，我们启动哪个数据源配置。   </p>
<h2 id="databaseIdProvider："><a href="#databaseIdProvider：" class="headerlink" title="databaseIdProvider："></a>databaseIdProvider：</h2><p>它的作用在于指定SQL到对应的数据库厂商提供的数据库中运行，一般应用较少，使用不同厂商数据库的情况较少。mybatis也为数据库厂商标识提供系统默认规则和自定义规则俩种方式，有兴趣自行了解即可。</p>
<h1 id="discriminator鉴别器（一）"><a href="#discriminator鉴别器（一）" class="headerlink" title="discriminator鉴别器（一）"></a><strong>discriminator鉴别器（一）</strong></h1><p>有时一个单独的数据库查询也许返回很多不同（但是希望有些关联）数据类型的结果集。<br>鉴别器元素就是被设计来处理这个情况的，还有包括类的继承层次结构。鉴别器非常容易理<br>解，它很像 Java的 switch<br>定义鉴别器指定了 column 和 javaType 属性<br>列是 MyBatis 查找比较值的地方<br>JavaType是需要被用来保证等价测试的合适类型（尽管字符串在很多情形下都会有用）。比如：</p>
<pre><code>&lt;resultMap id=&quot;vehicleResult&quot; type=&quot;Vehicle&quot;&gt;
  &lt;id property=”id” column=&quot;id&quot; /&gt;
  &lt;result property=&quot;vin&quot; column=&quot;vin&quot;/&gt;
  &lt;result property=&quot;year&quot; column=&quot;year&quot;/&gt;
  &lt;result property=&quot;make&quot; column=&quot;make&quot;/&gt;
  &lt;result property=&quot;model&quot; column=&quot;model&quot;/&gt;
  &lt;result property=&quot;color&quot; column=&quot;color&quot;/&gt;
  &lt;discriminator javaType=&quot;int&quot; column=&quot;vehicle_type&quot;&gt;
    &lt;case value=&quot;1&quot; resultMap=&quot;carResult&quot;/&gt;
    &lt;case value=&quot;2&quot; resultMap=&quot;truckResult&quot;/&gt;
    &lt;case value=&quot;3&quot; resultMap=&quot;vanResult&quot;/&gt;
    &lt;case value=&quot;4&quot; resultMap=&quot;suvResult&quot;/&gt;
  &lt;/discriminator&gt;
&lt;/resultMap&gt;

&lt;resultMap id=&quot;carResult&quot; type=&quot;Car&quot;&gt;
  &lt;result property=&quot;doorCount&quot; column=&quot;door_count&quot; /&gt;
&lt;/resultMap&gt;
</code></pre><p>这个例子中，如果vehicle_type的值是1，则会使用carResult，即只加载doorCount属性，如果需要加载vehicleResult中的属性，则需要让carResult继承vehicleResult，使用如下：</p>
<pre><code>&lt;resultMap id=&quot;carResult&quot; type=&quot;Car&quot; extends=”vehicleResult”&gt;
  &lt;result property=”doorCount” column=&quot;door_count&quot; /&gt;
&lt;/resultMap&gt;
</code></pre><p><strong>discriminator鉴别器（二）</strong>  </p>
<p>还有一种方式可以实现上面的效果：</p>
<pre><code>&lt;resultMap id=&quot;vehicleResult&quot; type=&quot;Vehicle&quot;&gt;
  &lt;id property=”id” column=&quot;id&quot; /&gt;
  &lt;result property=&quot;vin&quot; column=&quot;vin&quot;/&gt;
  &lt;result property=&quot;year&quot; column=&quot;year&quot;/&gt;
  &lt;result property=&quot;make&quot; column=&quot;make&quot;/&gt;
  &lt;result property=&quot;model&quot; column=&quot;model&quot;/&gt;
  &lt;result property=&quot;color&quot; column=&quot;color&quot;/&gt;
  &lt;discriminator javaType=&quot;int&quot; column=&quot;vehicle_type&quot;&gt;
    &lt;case value=&quot;1&quot; resultType=&quot;carResult&quot;&gt;
      &lt;result property=”doorCount” column=&quot;door_count&quot; /&gt;
    &lt;/case&gt;
    &lt;case value=&quot;2&quot; resultType=&quot;truckResult&quot;&gt;
      &lt;result property=”boxSize” column=&quot;box_size&quot; /&gt;
      &lt;result property=”extendedCab” column=&quot;extended_cab&quot; /&gt;
    &lt;/case&gt;
    &lt;case value=&quot;3&quot; resultType=&quot;vanResult&quot;&gt;
      &lt;result property=”powerSlidingDoor” column=&quot;power_sliding_door&quot; /&gt;
    &lt;/case&gt;
    &lt;case value=&quot;4&quot; resultType=&quot;suvResult&quot;&gt;
      &lt;result property=”allWheelDrive” column=&quot;all_wheel_drive&quot; /&gt;
    &lt;/case&gt;
  &lt;/discriminator&gt;
&lt;/resultMap&gt;
</code></pre><h1 id="mapper-xml文件sql语句编写"><a href="#mapper-xml文件sql语句编写" class="headerlink" title="mapper.xml文件sql语句编写"></a>mapper.xml文件sql语句编写</h1><h3 id="resultType和resultMap区别"><a href="#resultType和resultMap区别" class="headerlink" title="resultType和resultMap区别"></a><strong>resultType和resultMap区别</strong></h3><p>resultType是自定义除实体额外的pojo来接收查询结果<br>resultMap是在xml组装好的映射结果，不需要额外的pojo<br>一对一查询（resulttype）<br>    需要些pojo 来接收查询结果 可以继承属性较多的一方 这样子类可以少写一些属性<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928141.png?raw=true" alt="enter description
here"><br>一对一查询（resultMap）<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928142.png?raw=true" alt="enter description
here"><br>column是指数据库里的字段 而property是po里的属性名<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928143.png?raw=true" alt="enter description
here"><br>延迟加载<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928144.png?raw=true" alt="enter description
here"><br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928145.png?raw=true" alt="enter description
here"><br>开启延迟加载 在sqlmapconfig.xml<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928146.png?raw=true" alt="enter description
here"><br>测试<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928147.png?raw=true" alt="enter description
here"><br>测试环境<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928148.png?raw=true" alt="enter description
here">  </p>
<h1 id="association-查询结果的一对一关联："><a href="#association-查询结果的一对一关联：" class="headerlink" title="association 查询结果的一对一关联："></a>association 查询结果的一对一关联：</h1><pre><code>&lt;resultMap id=&quot;blogResult&quot; type=&quot;Blog&quot;&gt;
  &lt;id property=”blog_id” column=&quot;id&quot; /&gt;

  &lt;result property=&quot;title&quot; column=&quot;blog_title&quot;/&gt;

  &lt;association property=&quot;author&quot; column=&quot;blog_author_id&quot; javaType=&quot;Author&quot;&gt;
    &lt;id property=&quot;id&quot; column=&quot;author_id&quot;/&gt;
    &lt;result property=&quot;username&quot; column=&quot;author_username&quot;/&gt;
    &lt;result property=&quot;password&quot; column=&quot;author_password&quot;/&gt;
    &lt;result property=&quot;email&quot; column=&quot;author_email&quot;/&gt;
    &lt;result property=&quot;bio&quot; column=&quot;author_bio&quot;/&gt;
  &lt;/association&gt;
&lt;/resultMap&gt;
</code></pre><h1 id="collection查询结果的一对多关联："><a href="#collection查询结果的一对多关联：" class="headerlink" title="collection查询结果的一对多关联："></a>collection查询结果的一对多关联：</h1><pre><code>&lt;resultMap id=&quot;blogResult&quot; type=&quot;Blog&quot;&gt;
  &lt;id property=”id” column=&quot;blog_id&quot; /&gt;
  &lt;result property=&quot;title&quot; column=&quot;blog_title&quot;/&gt;
  &lt;collection property=&quot;posts&quot; ofType=&quot;Post&quot;&gt;
    &lt;id property=&quot;id&quot; column=&quot;post_id&quot;/&gt;
    &lt;result property=&quot;subject&quot; column=&quot;post_subject&quot;/&gt;
    &lt;result property=&quot;body&quot; column=&quot;post_body&quot;/&gt;
  &lt;/collection&gt;
&lt;/resultMap&gt;
</code></pre><h3 id="Mapper配置"><a href="#Mapper配置" class="headerlink" title="Mapper配置"></a><strong>Mapper配置</strong></h3><p>Mybatis 的Mapper 是指Mybatis 执行数据库操作的接口类以及方法，在非注解模式下，还包含与类对应的 xml 配置文件。<br>第一种依据 Mapper 类 具体路径 配置 Mapper<br>这种情况下，如果是非注解模式的话xml配置文件必须和这个类在同一级目录，且与Mapper类同名  </p>
<pre><code>&lt;configuration&gt;
    &lt;mappers&gt;        
        &lt;!-- class 级别的指定 --&gt;
        &lt;mapper class=&quot;com.bestcxx.stu.springmvc.mapper.UserModelMapper&quot;/&gt;
        &lt;mapper class=&quot;com.bestcxx.stu.springmvc.mapper.UserModelTwoMapper&quot;/&gt;
    &lt;/mappers&gt;
&lt;/configuration&gt;
</code></pre><p>在存在 xml 配置文件的情况下，文件结构如下，没有 xml 配置文件的情况下，只有 Mapper 类<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101032.png?raw=true" alt=""><br>第二种依据 Mapper 类所在的package包路径 配置 Mapper<br>这种情况下，如果是非注解模式的话xml配置文件必须也处于同一级 package 下，且与Mapper类同名  </p>
<pre><code>&lt;configuration&gt;
    &lt;mappers&gt;
        &lt;package name=&quot;com.bestcxx.stu.springmvc.mapper&quot;/&gt;
    &lt;/mappers&gt;
&lt;/configuration&gt;
</code></pre><p>文件结构<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101033.png?raw=true" alt=""><br>第三种是把 Mapper 的xml配置文件单独放置到 resources 中，和Mapper 类分开了<br>这种方式的好处是便于统一管理 xml 配置文件，不好的的地方是无法使用注解模式了  </p>
<pre><code>&lt;configuration&gt;
    &lt;mappers&gt;
        &lt;!-- 使用这个方案，可以单独指定Mapper的位置 --&gt;
        &lt;mapper resource=&quot;mybatis/mappings/UserModelMapper.xml&quot;/&gt;
        &lt;mapper resource=&quot;mybatis/mappings/UserModelTwoMapper.xml&quot;/&gt;
    &lt;/mappers&gt;
&lt;/configuration&gt;
</code></pre><p>然后Mapper类还是呆在该在的位置<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101034.png?raw=true" alt=""><br>但是mapper 的 xml文件的位置如下<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101035.png?raw=true" alt=""><br>上面的配置在mybitas-config.xml（名字是可以自定义的）中集中管理，Mapper 的 xml 文件需要关联<br>第一，是mybatis-config.xml 文件负责加载 Mapper的xml文件，即上面所说的配置是在这个mybatis-config.xml文件中<br>第二，mapper对应的xml 配置文件内部要指定对应的Mapper类<br>下面是单独测试mybatis的mybatas的配置文件的内容  </p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;
    &lt;!-- 元素首次出现必须符合下面的顺序 --&gt;
    &lt;!-- (properties?,settings?,typeAliases?,typeHandlers?,objectFactory?,objectWrapperFactory?,reflectorFactory?,plugins?,environments?,databaseIdProvider?,mappers?) --&gt;

    &lt;!-- 加载常量配置信息 --&gt;
    &lt;!-- 可以覆盖重写，用于解密-http://www.mybatis.org/mybatis-3/zh/configuration.html
        ·在 properties 元素体内指定的属性首先被读取。
        ·然后根据 properties 元素中的 resource 属性读取类路径下属性文件或根据 url 属性指定的路径读取属性文件，并覆盖已读取的同名属性。
        ·最后读取作为方法参数传递的属性，并覆盖已读取的同名属性。 --&gt;
    &lt;properties resource=&quot;config/jdbc.properties&quot;/&gt;

    &lt;!-- 为实体类定义别名 --&gt;
    &lt;typeAliases&gt;
        &lt;typeAlias alias=&quot;userModel&quot;  type=&quot;com.bestcxx.stu.springmvc.model.UserModel&quot;/&gt;
        &lt;typeAlias alias=&quot;userModelTwo&quot;  type=&quot;com.bestcxx.stu.springmvc.model.UserModelTwo&quot;/&gt;
    &lt;/typeAliases&gt;
    &lt;!-- 使用 spring 配置数据库的时候，下面就可以注释掉了 --&gt;
    &lt;!-- 定义数据库信息，默认使用 development 数据库构建环境 --&gt;
    &lt;environments default=&quot;development&quot;&gt;
        &lt;environment id=&quot;development&quot;&gt;
            &lt;!-- 采用 jdbc 事务管理 --&gt;
            &lt;transactionManager type=&quot;JDBC&quot;/&gt;
            &lt;!-- 配置数据库链接信息 --&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;${jdbc.driverClassName}&quot;/&gt;
                &lt;property name=&quot;url&quot; value=&quot;${jdbc.url}&quot;/&gt;
                &lt;property name=&quot;username&quot; value=&quot;${jdbc.username}&quot;/&gt;
                &lt;property name=&quot;password&quot; value=&quot;${jdbc.password}&quot;/&gt;
            &lt;/dataSource&gt;
        &lt;/environment&gt;
    &lt;/environments&gt;

    &lt;!-- 定义映射器 --&gt;
    &lt;mappers&gt;
        &lt;!-- 使用这个方案，可以单独指定Mapper的位置 --&gt;
        &lt;!-- &lt;mapper resource=&quot;mybatis/mappings/UserModelMapper.xml&quot;/&gt;
        &lt;mapper resource=&quot;mybatis/mappings/UserModelTwoMapper.xml&quot;/&gt; --&gt;

        &lt;!-- 使用下面两个个方法，Mapper.xml 文件位置必须在和其内部 &lt;mapper namespace=&quot;&quot;&gt;的类在一起，当然，使用注解模式的话，Mapper.xml文件就没有必要存在了 --&gt;

        &lt;!-- 直接指定一个包去扫描-内保包含多个Mapper配置- --&gt;
        &lt;!-- &lt;package name=&quot;com.bestcxx.stu.springmvc.mapper&quot;/&gt; --&gt;

        &lt;!-- class 级别的指定 --&gt;
        &lt;mapper class=&quot;com.bestcxx.stu.springmvc.mapper.UserModelMapper&quot;/&gt;
        &lt;mapper class=&quot;com.bestcxx.stu.springmvc.mapper.UserModelTwoMapper&quot;/&gt;
    &lt;/mappers&gt;
&lt;/configuration&gt;

</code></pre><p>mapper的xml 配置文件的内容<br>注意  </p>
<pre><code>&lt;mapper namespace=&quot;com.bestcxx.stu.springmvc.mapper.UserModelMapper&quot;&gt;


&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE mapper
  PUBLIC &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;
  &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;
&lt;mapper namespace=&quot;com.bestcxx.stu.springmvc.mapper.UserModelMapper&quot;&gt;

    &lt;!-- 表字段显式 --&gt;
    &lt;sql id=&quot;userModelColumns&quot;&gt;
        u.userName AS &quot;userName&quot;,
        u.passWord AS &quot;passWord&quot;,
        u.createDate AS &quot;createDate&quot;,
        u.intNum AS &quot;intNum&quot;,
        u.decimalNum AS &quot;decimalNum&quot;
    &lt;/sql&gt;


    &lt;!-- 根据 userName 查询 --&gt;
    &lt;select id=&quot;getUserModel&quot; resultType=&quot;userModel&quot;&gt;
        SELECT
        &lt;include refid=&quot;userModelColumns&quot; /&gt;
        FROM
        userModel u
        WHERE
        u.userName = #{userName}
    &lt;/select&gt;

    &lt;!-- 插入 --&gt;
    &lt;insert id=&quot;addUserModel&quot; parameterType=&quot;userModel&quot; useGeneratedKeys=&quot;true&quot; keyProperty=&quot;userName&quot;&gt;
        INSERT INTO userModel (
        passWord,
        createDate,
        intNum,
        decimalNum
        )
        VALUES (
        #{passWord},
        #{createDate},
        #{intNum},
        #{decimalNum}
        )

    &lt;/insert&gt;

    &lt;!-- 搜索多条，返回List&lt;userModel&gt;-入参为111,222,333 格式 --&gt;
    &lt;select id=&quot;getUserModelListByStrs&quot; parameterType=&quot;string&quot; resultType=&quot;userModel&quot;&gt;
        SELECT 
        &lt;include refid=&quot;userModelColumns&quot; /&gt;
        FROM 
        userModel u
        WHERE
        u.userName in (${userNames})
    &lt;/select&gt;

    &lt;!-- 搜索多条，返回 List&lt;HashMap&lt;String,Object&gt;&gt;,入参为list--&gt;
    &lt;select id=&quot;getHashMapListByList&quot; parameterType=&quot;list&quot; resultType=&quot;map&quot;&gt;
        SELECT 
        &lt;include refid=&quot;userModelColumns&quot; /&gt;
        FROM 
        userModel u
        WHERE
        u.userName in 
        &lt;foreach item=&quot;item&quot; collection=&quot;userNamelist&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot; &gt;
            #{item}
         &lt;/foreach&gt;
    &lt;/select&gt;

    &lt;update id=&quot;update&quot;&gt;
        UPDATE userModel u
        SET
        u.passWord=#{passWord},u.createDate=#{createDate}
        WHERE
        u.userName=#{userName}
    &lt;/update&gt;

&lt;/mapper&gt;
</code></pre><p>第四种，直接在spring中配置Mapper的路径，但是mybatis.xml还是必不可少的<br>在sqlSessionFactory中设定 mybitas的xml和aliases  </p>
<pre><code>&lt;!-- MustConfigPoint MyBatis begin --&gt;
    &lt;bean id=&quot;sqlSessionFactory&quot; class=&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;&gt;
        &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot; /&gt;
        &lt;property name=&quot;typeAliasesPackage&quot; value=&quot;实体类包路径&quot; /&gt;
        &lt;property name=&quot;typeAliasesSuperType&quot; value=&quot;实体类顶级包路径&quot; /&gt;
        &lt;property name=&quot;mapperLocations&quot; value=&quot;classpath:/mybatis/mappings/**/*.xml&quot; /&gt;
        &lt;property name=&quot;configLocation&quot; value=&quot;classpath:/mybatis/mybatis-config.xml&quot;&gt;&lt;/property&gt;
    &lt;/bean&gt;
</code></pre><h1 id="设置Mapper类"><a href="#设置Mapper类" class="headerlink" title="设置Mapper类"></a>设置Mapper类</h1><pre><code>&lt;!-- MustConfigPoint 扫描basePackage下所有以@MyBatisDao注解的接口 --&gt;
    &lt;bean id=&quot;mapperScannerConfigurer&quot; class=&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;&gt;
        &lt;property name=&quot;basePackage&quot; value=&quot;mapper类的包路径&quot; /&gt;
        &lt;property name=&quot;sqlSessionFactoryBeanName&quot; value=&quot;sqlSessionFactory&quot; /&gt;
        &lt;property name=&quot;annotationClass&quot; value=&quot;com.msyd.framework.common.persistence.annotation.MyBatisDao&quot; /&gt;
    &lt;/bean&gt;
</code></pre><h1 id="Mybatis缓存"><a href="#Mybatis缓存" class="headerlink" title="Mybatis缓存"></a>Mybatis缓存</h1><h2 id="Hibernate二级缓存的注意要点"><a href="#Hibernate二级缓存的注意要点" class="headerlink" title="Hibernate二级缓存的注意要点"></a><strong>Hibernate二级缓存的注意要点</strong></h2><h2 id="一级缓存"><a href="#一级缓存" class="headerlink" title="一级缓存"></a><strong>一级缓存</strong></h2><p>是必需的，位于Session（是一个HashMap,存放对象的引用）在 session commit 时 清空一级缓存 (防止其他用户 读取到 修改的脏数据)    </p>
<h2 id="二级缓存"><a href="#二级缓存" class="headerlink" title="二级缓存"></a><strong>二级缓存</strong></h2><p>非必需，跨多个session，由SessionFactory控制<br>二级缓存可指定使用何种Cache工具，Hibernate 3以后的版本默认使用的是Ehcache，也可以切换为Oscache、JbossCache.  </p>
<h2 id="缓存策略："><a href="#缓存策略：" class="headerlink" title="缓存策略："></a><strong>缓存策略：</strong></h2><p>比如最大缓存数、缓存过期时间等，将这些参数降低至一个合理的范围<br>首先判断二级缓存有没有 再判断一级缓存有没有 都没有后 才执行sql语句<br>session 共享一个namespace为Usermapper二级缓存 但不共享 namespace为goodsmapper二级缓存<br>如果要这两个mapper.xml使用相同的namespace那么就共享同一个二级缓存   </p>
<h2 id="开启全部二级缓存"><a href="#开启全部二级缓存" class="headerlink" title="开启全部二级缓存"></a><strong>开启全部二级缓存</strong></h2><p><strong>在sqlmapconfig.xml中</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928137.png?raw=true" alt=""><br>仅开启一个mapper的二级缓存 usermapper,xml中<br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928138.png?raw=true" alt="">  </p>
<h2 id="整合echache"><a href="#整合echache" class="headerlink" title="整合echache"></a><strong>整合echache</strong></h2><p><strong>加入2个jar包</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928138_1.png?raw=true" alt=""><br><strong>usermapper.xml中加入</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928139.png?raw=true" alt=""><br><strong>echache配置文件classpath下</strong><br><img src="https://github.com/54321decba/tu/blob/master/blog/20180928140.png?raw=true" alt=""><br>po实体类 实现序列化接口(因为二级缓存 可能存在硬盘中  当从硬盘中读取需要反序列化读取)<br>只要sqlsession不提交 就不会清空二级缓存  </p>
<h2 id="何时清空二级缓存"><a href="#何时清空二级缓存" class="headerlink" title="何时清空二级缓存"></a><strong>何时清空二级缓存</strong></h2><p>请求频繁、对实时数据要求不高的数据 不要求每次都是最新数据  （设置刷新频率久一点 30分钟 24小时）<br>实时性高的 操作后会自动更新缓存 即把缓存清空了  </p>
<h2 id="二级缓存-局限性"><a href="#二级缓存-局限性" class="headerlink" title="二级缓存 局限性"></a><strong>二级缓存 局限性</strong></h2><p>A客户查询 了 a 商品 B客户查询了 b商品 …都存入了二级缓存 （有1w个商品）<br>当有一个更新商品的操作 那么二级缓存全部被清空了 因此可以说mybatis二级缓存只能针对整个mapper 而不是某一种操作设置二级缓存，粒度不够细<br><strong>缓存</strong><br>同hibernate一样，一级缓存（session级）是默认开启的，如果需要开启二级缓存，就需要加以下配置：  </p>
<pre><code>&lt;!-- 在核心配置文件中加入配置 --&gt;
&lt;setting name=&quot;cacheEnabled&quot; value=&quot;true&quot;/&gt;

&lt;!-- 在mapper文件中加入配置 --&gt;
&lt;cache /&gt;
</code></pre><p><code>&lt;cache /&gt;</code> 语句的效果如下：<br>映射语句文件中的所有 <code>select</code> 语句将会被缓存。<br>映射语句文件中的所有 <code>insert， update 和 delete</code>语句会刷新缓存。<br>缓存会使用 Least Recently Used（ LRU，最近最少使用的）算法来收回。<br>根据时间表（比如 no Flush Interval，没有刷新间隔），缓存不会以任何时间顺序来刷新。<br>缓存会存储列表集合或对象（无论查询方法返回什么）的 1024 个引用。<br>缓存会被视为是 read/write（可读/可写）的缓存，意味着对象检索不是共享的，而且可以安全地被调用者修改，而不干扰其他调用者或线程所做的潜在修改。<br>所有的这些属性都可以通过缓存元素的属性来修改。比如：     </p>
<pre><code>&lt;cache eviction=&quot;FIFO&quot; flushInterval=&quot;60000&quot; size=&quot;512&quot; readOnly=&quot;true&quot;/&gt;
</code></pre><p>这个配置创建了一个 FIFO 缓存，并每隔 60 秒刷新， 存数结果对象或列表的512 个引用，而且返回的对象是只读的，因此在不同线程中的调用者之间修改它们会导致冲突。<br>可用的收回策略有：<br>LRU – 最近最少使用的：移除最长时间不被使用的对象。<br>FIFO – 先进先出：按对象进入缓存的顺序来移除它们。<br>SOFT – 软引用：移除基于垃圾回收器状态和软引用规则的对象。<br>WEAK – 弱引用：更积极地移除基于垃圾收集器状态和弱引用规则的对象。<br>默认的是 LRU。<br><strong>flushInterval</strong>（刷新间隔）可以被设置为任意的正整数，它们代表一个合理的毫秒形式的时间段。默认不设置，即没有刷新间隔，缓存仅仅调用语句时刷新。<br><strong>size</strong>（引用数目）可以被设置为任意正整数，要记住你缓存的对象数目和你运行环境的可用内存资源数目。默认值是 1024。<br><strong>readOnly</strong>（只读）属性可以被设置为 true 或 false。只读的缓存会给所有调用者返回缓存对象的相同实例,可读写的缓存会返回缓存对象的拷贝（通过序列化）,默认是 false。   </p>
<h2 id="动态sql"><a href="#动态sql" class="headerlink" title="动态sql"></a><strong>动态sql</strong></h2><p><strong>if 和 choose when otherwise</strong>    </p>
<pre><code>&lt;select id=”findActiveBlogLike” parameterType=”Blog” resultType=”Blog”&gt;
  SELECT * FROM BLOG WHERE state = „ACTIVE‟
  &lt;choose&gt;
    &lt;when test=”title != null”&gt;
      AND title like #{title}
    &lt;/when&gt;
    &lt;when test=”author != null and author.name != null”&gt;
      AND title like #{author.name}
    &lt;/when&gt;
    &lt;otherwise&gt;
      AND featured = 1
    &lt;/otherwise&gt;
  &lt;/choose&gt;
&lt;/select&gt;
</code></pre><p>关键字<br><strong>where 和 set</strong>    </p>
<pre><code>&lt;!-- 取代where关键字，当所有if条件不成立时就不会出现where关键字 --&gt;
&lt;select id=”findActiveBlogLike” parameterType=”Blog” resultType=”Blog”&gt;
  SELECT * FROM BLOG
  &lt;where&gt;
    &lt;if test=”state != null”&gt;
      state = #{state}
    &lt;/if&gt;
    &lt;if test=”title != null”&gt;
      AND title like #{title}
    &lt;/if&gt;
    &lt;if test=”author != null and author.name != null”&gt;
      AND title like #{author.name}
    &lt;/if&gt;
  &lt;/where&gt;
&lt;/select&gt;
&lt;update id=&quot;updateAuthorIfNecessary&quot; parameterType=&quot;domain.blog.Author&quot;&gt;
  update Author
  &lt;set&gt;
    &lt;if test=&quot;username != null&quot;&gt;username=#{username},&lt;/if&gt;
    &lt;if test=&quot;password != null&quot;&gt;password=#{password},&lt;/if&gt;
    &lt;if test=&quot;email != null&quot;&gt;email=#{email},&lt;/if&gt;
    &lt;if test=&quot;bio != null&quot;&gt;bio=#{bio}&lt;/if&gt;
  &lt;/set&gt;
  where id=#{id}
&lt;/update&gt;
</code></pre><p><strong>foreach</strong>  </p>
<pre><code>&lt;select id=&quot;selectPostIn&quot; resultType=&quot;domain.blog.Post&quot;&gt;
  SELECT * FROM POST P WHERE ID in
  &lt;foreach item=&quot;item&quot; index=&quot;index&quot; collection=&quot;list&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;
    #{item}
  &lt;/foreach&gt;
&lt;/select&gt;
</code></pre><h1 id="动态SQL"><a href="#动态SQL" class="headerlink" title="动态SQL"></a><strong>动态SQL</strong></h1><p>动态SQL是在原先SQL基础上加上判断条件，例如if等语句<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101029.png?raw=true" alt="enter description
here"> </p>
<h3 id="if元素"><a href="#if元素" class="headerlink" title="if元素"></a><strong>if元素</strong></h3><p> <strong>示例：根据角色名称模糊匹配查询角色</strong>  </p>
<pre><code>       &lt;select id=&quot;findRoles&quot; parameterType=&quot;string&quot; resultMap=&quot;roleResultMap&quot;&gt;
    select role_no, role_name, note from t_role where 1 = 1
    &lt;if test=&quot;roleName !=null and roleName !=&#39;&#39; &quot;&gt;
        and role_name like concat(&#39;%&#39;, #{roleName}, &#39;%&#39;)
    &lt;/if&gt;
&lt;/select&gt;
</code></pre><h3 id="choose、when、otherwise元素"><a href="#choose、when、otherwise元素" class="headerlink" title="choose、when、otherwise元素"></a><strong>choose、when、otherwise元素</strong></h3><p><strong>判断条件结果不只是true或false，类似于java语言中的switch——case语句</strong></p>
<p>示例：当role编号为空，使用roleNo为条件查询；当role编号为空，而角色名称roleName不为空，则roleName作为条件进行模糊查询；若俩者都为空，要求备注不为空。三种查询情况，来看mybatis动态sql语句如何实现？</p>
<pre><code>&lt;select id=&quot;findRoles&quot; parameterType=&quot;string&quot; resultMap=&quot;roleResultMap&quot;&gt;
    select role_no, role_name, note from t_role where 1 = 1
    &lt;choose&gt;
        &lt;when test=&quot;testNO != null and roleNo !=&#39;&#39; &quot;&gt;
            and role_no = #{roleNo}
        &lt;/when&gt;
        &lt;when test=&quot;roleName !=null and roleName !=&#39;&#39; &quot;&gt;
            and role_name like concat(&#39;%&#39;, {roleName}, &#39;%&#39;)
        &lt;/when&gt;
        &lt;otherwise&gt;
            and note is not null
        &lt;/otherwise&gt;
    &lt;/choose&gt;
&lt;/select&gt;
</code></pre><h3 id="trim、where、set元素"><a href="#trim、where、set元素" class="headerlink" title="trim、where、set元素"></a><strong>trim、where、set元素</strong></h3><p><strong>where</strong><br>如果将if元素示例中的1=1去掉，SQL的语法就会异常，这时我们就可以用where元素起到同等作用。</p>
<pre><code>&lt;select id=&quot;findRoles&quot; parameterType=&quot;string&quot; resultMap=&quot;roleResultMap&quot;&gt;
    select role_no, role_name, note from t_role 
        &lt;where&gt;
        &lt;if test=&quot;roleName !=null and roleName !=&#39;&#39; &quot;&gt;
            and role_name like concat(&#39;%&#39;, {roleName}, &#39;%&#39;)
        &lt;/if&gt;
        &lt;/where&gt;
    &lt;/choose&gt;
&lt;/select&gt;
</code></pre><p><strong>trim</strong></p>
<pre><code>&lt;select id=&quot;findRoles&quot; parameterType=&quot;string&quot; resultMap=&quot;roleResultMap&quot;&gt;
    select role_no, role_name, note from t_role 
        &lt;trim prefix=&quot;where&quot; prefixOverrides=&quot;and&quot;&gt;
            &lt;if test=&quot;roleName !=null and roleName !=&#39;&#39; &quot;&gt;
            and role_name like concat(&#39;%&#39;, {roleName}, &#39;%&#39;)
            &lt;/if&gt;
        &lt;/trim&gt;
&lt;/select&gt;
</code></pre><p>trim元素用来去掉一些特殊的字符串，prefix代表是语句的前缀，而prefixOverrides代表你需要去掉的字符串，本实例中trim与where元素起到同样的效果。<br><strong>set</strong><br>使用场景：更新一条记录的一个字段，性能最佳的办法是把主键和更新字段的值传给sql进行更新。mybatis通过set来设置这样的更新操作，具体示例如下：    </p>
<pre><code>&lt;update id=&quot;updateRole&quot; parameterType=&quot;role&quot;&gt;
    update t_role
    &lt;set&gt;
        &lt;if test=&quot;roleName != null and roleName !=&#39;&#39;&quot;&gt;
            role_name = #{roleName},
        &lt;/if&gt;
        &lt;if test=&quot;note != null and note !=&#39;&#39; &quot;&gt;
            note = #{note}
        &lt;/if&gt;
    &lt;/set&gt;
    where role_no = #{roleNo}
&lt;/update&gt;
</code></pre><p><strong>foreach元素</strong><br>循环语句，用来遍历集合。能够很好的支持数组和List、Set接口的集合，对此提供遍历的功能</p>
<pre><code>&lt;select id=&quot;findUserBySex&quot; resultType=&quot;user&quot;&gt;
    select * from t_user where sex in
    &lt;foreach item=&quot;sex&quot; index=&quot;index&quot; collection=&quot;sexList&quot; open=&quot;(&quot;separator=&quot;,&quot; close=&quot;)&quot;&gt;
        #{sex}
    &lt;/foreach&gt;
&lt;/select&gt;
</code></pre><p>collection配置的sexList是传递进来的参数名称，可以是一个数组或List、Set等集合；item配置的是循环中当前的元素；index配置的是当前元素在集合的位置下标；open和close配置的是以什么符号将这些集合元素包装起来；separator是各个元素的间隔符。值得注意的是，sql中大量语句的in是非常消耗性能的，所以我们要预估一下collection对象的长度。<br> <strong>test属性</strong><br> 用于条件判断语句中，相当于判断真假，上面的示例基本是用它判断空和非空，我们还可以用它来判断字符串、数字和枚举等。</p>
<pre><code>&lt;select id=&quot;getRoleTest&quot; parameterType=&quot;string&quot; resultMap=&quot;roleResultMap&quot;&gt;
    select role_no, role_name, note from t_role 
    &lt;if test=&quot;type = &#39;Y&#39;&quot;&gt;
        where 1=1
    &lt;/if&gt;
&lt;/select&gt;
</code></pre><p><strong>bind元素</strong><br>通过OGNL表达式自定义一个上下文变量。例如模糊查询，mysql使用一个concat用“%”和参数相连接，然而oracle则是用连接符号“||”，这样就很难兼容，需要俩种形式。这样情况下，mybatis提供了bind元素，不必使用数据库的语言，只要使用mybatis的语言即可与所需参数相连，实现模糊查询。  </p>
<h3 id="1-使用bind绑定一个参数"><a href="#1-使用bind绑定一个参数" class="headerlink" title="1 使用bind绑定一个参数"></a><strong>1 使用bind绑定一个参数</strong></h3><pre><code>&lt;select id=&quot;findRole&quot; resultType=&quot;com.liming.domain.mybatis.bean.RoleBean&quot;&gt;
    &lt;bind name=&quot;pattern&quot; value=&quot;&#39;%&#39; + _parameter + &#39;%&#39;&quot;/&gt;
    select id, role_name as roleName, create_date as createDate, end_date as endDate From t_role
    where role_name like #{pattern}
&lt;/select&gt;
</code></pre><h3 id="2-多参数绑定"><a href="#2-多参数绑定" class="headerlink" title="2  多参数绑定"></a><strong>2  多参数绑定</strong></h3><p><strong>（1）定义接口方法</strong></p>
<pre><code>
/*
  * 查询角色
  * @param roleName 角色名称
  * @param note 备注
  * @return 符合条件的角色
 */
public List&lt;RoleBean&gt; findRole(@Param(&quot;roleName&quot;)String roleName, @Param(&quot;note&quot;)String note);
</code></pre><p><strong>（2）定义映射文件，定义俩个新的变量执行模糊查询</strong></p>
<pre><code>&lt;select id=&quot;findRole&quot; resultType=&quot;com.liming.domain.mybatis.bean.RoleBean&quot;&gt;
    &lt;bind name=&quot;pattern_roleName&quot; value=&quot;&#39;%&#39; + roleName + &#39;%&#39;&quot;/&gt;
    &lt;bind name=&quot;pattern_note&quot; value =&quot;&#39;%&#39; + note + &#39;%&#39;&quot;/&gt;
    select id, role_name as roleName, create_date as createDate, end_date as endDate from t_role
    where role_name like #{pattern_roleName}
    and note like #{pattern_note}
&lt;/select&gt;
</code></pre><p><strong>总结</strong><br>            mybatis通过条件判断的元素实现动态SQL语句查询功能，相对于静态的sql语句更加灵活，更全面满足开发人员的需求。</p>
<pre><code>        # 映射器是mybatis最复杂最核心的组件
</code></pre><h2 id="Sql-Mapper（映射器）"><a href="#Sql-Mapper（映射器）" class="headerlink" title="Sql Mapper（映射器）"></a><strong>Sql Mapper（映射器）</strong></h2><h3 id="作用：-2"><a href="#作用：-2" class="headerlink" title="作用："></a><strong>作用：</strong></h3><p>1）定义参数、2）描述缓存、3）描述SQL语句、4）定义查询结果和POJO的映射关系  </p>
<h3 id="主要元素："><a href="#主要元素：" class="headerlink" title="主要元素："></a><strong>主要元素：</strong></h3><p><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101028.png?raw=true" alt="enter description
here"> </p>
<h3 id="引入映射器mapper的方法"><a href="#引入映射器mapper的方法" class="headerlink" title="引入映射器mapper的方法"></a><strong>引入映射器mapper的方法</strong></h3><p><strong>用文件路径引入映射器</strong>                                   </p>
<pre><code>&lt;mappers&gt;
            &lt;mapper resource=&quot;对应mapper接口全路径的配置文件&quot;&gt;
&lt;/mappers&gt;
</code></pre><p><strong>用包名引入映射器</strong>                           </p>
<pre><code>&lt;mappers&gt;
            &lt;mapper resource=&quot;对应mapper接口包的全路基&quot;&gt;
&lt;/mappers&gt;
</code></pre><p><strong>用类注册引入映射器</strong>                          </p>
<pre><code>&lt;mappers&gt;
            &lt;mapper resource=&quot;对应mapper接口类的路径&quot;&gt;
&lt;/mappers&gt;
</code></pre><p><strong>用xml配置文件引入映射器</strong>                          </p>
<pre><code>&lt;mappers&gt;
            &lt;mapper url=&quot;file:///var/mappers+文件路径&quot;&gt;
&lt;/mappers&gt;
</code></pre><h3 id="引入映射器步骤"><a href="#引入映射器步骤" class="headerlink" title="引入映射器步骤"></a><strong>引入映射器步骤</strong></h3><p><strong>定义映射器接口RoleMapper.java</strong>                      </p>
<pre><code>package com.liming.domain.mapper;
import com.liming.domain.po.Role;
public interface RoleMapper{
    public Role getRole(Long id);
}
</code></pre><p> <strong>对应映射器接口的配置文件RoleMapper.xml：定义mapper映射规则和SQL语句</strong></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;  
    &lt;!DOCTYPE mapper PUBLIC   
        &quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;  
        &quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;&gt;  
    &lt;mapper namespace=&quot;com.liming.domain.mapper.RoleMapper&quot;&gt;  
        &lt;select id=&quot;getRole&quot; parameterType=&quot;long&quot; resultType=&quot;role&quot;&gt;  
            select id, role_name as roleName from t_role where id = #{id} 
        &lt;/select&gt;  
    &lt;/mapper&gt;  
</code></pre><p><strong>在核心配置SqlMapConfig.xml文件中引入映射器</strong></p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
&lt;!DOCTYPE configuration
PUBLIC &quot;-//mybatis.org//DTD Config 3.0//EN&quot;
&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;&gt;
&lt;configuration&gt;    
    &lt;!-- 别名定义 --&gt;
    &lt;typeAliases&gt;
        &lt;typeAlias alias=&quot;role&quot; type=&quot;com.liming.domain.po.Role&quot;/&gt;
    &lt;/typeAliases&gt;
    &lt;!--定义数据库信息，默认使用development数据库构建环境--&gt;
    &lt;environments default=&quot;development&quot;&gt;
        &lt;environment id=&quot;development&quot;&gt;
            &lt;!--采用jdbc事务管理--&gt;
            &lt;transactionMapper type=&quot;JDBC&quot;/&gt;
            &lt;!--配置数据库链接信息--&gt;
            &lt;dataSource type=&quot;POOLED&quot;&gt;
                &lt;property name=&quot;driver&quot; value=&quot;com.mysql.jdbc.Driver&quot;/&gt;
                &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/mybatis&quot;/&gt;
                &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt;
                &lt;property name=&quot;password&quot; value=&quot;****&quot;/&gt;
            &lt;/dataSource&gt;    
        &lt;/environment&gt;
    &lt;/environments&gt;
    &lt;!--定义映射器--&gt;
    &lt;mappers&gt;
        &lt;mapper resource=&quot;com/liming/domain/mapper/roleMapper.xml&quot;/&gt;
    &lt;/mappers&gt;
&lt;/configuration&gt;
</code></pre><h1 id="执行器Executor"><a href="#执行器Executor" class="headerlink" title="执行器Executor"></a>执行器Executor</h1><p>作用：调度StatementHandler、ParameterHandler、ResultHandler等来执行对应的SQL。  </p>
<h3 id="SimpleExecutor"><a href="#SimpleExecutor" class="headerlink" title="SimpleExecutor"></a><strong>SimpleExecutor</strong></h3><p>每执行一次update或select，就开启一个Statement对象，用完立刻关闭Statement对象。  </p>
<h3 id="ReuseExecutor"><a href="#ReuseExecutor" class="headerlink" title="ReuseExecutor"></a><strong>ReuseExecutor</strong></h3><p>执行update或select，以sql作为key查找Statement对象，存在就使用，不存在就创建，用完后，不关闭Statement对象，而是放置于Map&lt;String, Statement&gt;内，供下一次使用。   </p>
<h3 id="BatchExecutor"><a href="#BatchExecutor" class="headerlink" title="BatchExecutor"></a><strong>BatchExecutor</strong></h3><p>执行update（没有select，JDBC批处理不支持select），将所有sql都添加到批处理中（addBatch()），等待统一执行（executeBatch()），它缓存了多个Statement对象，每个Statement对象都是addBatch()完毕后，等待逐一执行executeBatch()批处理。与JDBC批处理相同。<br><strong>作用范围</strong>在SqlSession生命周期范围。</p>
<p>执行过程：步骤一，MyBatis根据Configuration来构建StatementHandler<br>                  步骤二，使用prepareStatement方法，对SQL编译并对参数进行初始化<br>                  步骤三，调用prepareStatement的prepare()进行预编译和基础设置，再通过StatementHandler的parameterize()来设置参数并执行<br>                  步骤四，resultHandler再组装查询结果返回给调用者。</p>
<h1 id="Mybatis-CDATA部件"><a href="#Mybatis-CDATA部件" class="headerlink" title="Mybatis_CDATA部件"></a>Mybatis_CDATA部件</h1><p>在使用mybatis 时我们sql是写在xml 映射文件中，如果写的sql中有一些特殊的字符的话，在解析xml文件的时候会被转义，但我们不希望他被转义，所以我们要使用<code>&lt;![CDATA[ ]]&gt;</code>来解决。<br><code>&lt;![CDATA[   ]]&gt;</code> 是什么：这是XML语法。在CDATA内部的所有内容都会被解析器忽略。<br>如果文本包含了很多的”&lt;”字符 &lt;=和”&amp;”字符——就象程序代码一样，那么最好把他们都放到CDATA部件中。<br>但是有个问题那就是<code>&lt;if test=&quot;&quot;&gt;   &lt;/if&gt;   &lt;where&gt;   &lt;/where&gt;  &lt;choose&gt;  &lt;/choose&gt;  &lt;trim&gt;  &lt;/trim&gt;</code>等这些标签都不会被解析，所以我们只把有特殊字符的语句放在 <code>&lt;![CDATA[   ]]&gt;</code>  尽量缩小 <code>&lt;![CDATA[  ]]&gt;</code> 的范围。<br>实例如下：</p>
<pre><code>&lt;select id=&quot;allUserInfo&quot; parameterType=&quot;java.util.HashMap&quot; resultMap=&quot;userInfo1&quot;&gt;
  &lt;![CDATA[
  SELECT newsEdit,newsId, newstitle FROM shoppingGuide  WHERE 1=1  AND  newsday &gt; #{startTime} AND newsday &lt;= #{endTime}
  ]]&gt;
  &lt;if test=&quot;etidName!=&#39;&#39;&quot;&gt;
   AND newsEdit=#{etidName}
  &lt;/if&gt;
 &lt;/select&gt;
</code></pre><p>因为这里有 “&gt;”  “&lt;=” 特殊字符所以要使用 <code>&lt;![CDATA[   ]]&gt;</code>来注释，但是有<code>&lt;if&gt;</code>标签，所以把<code>&lt;if&gt;</code>等 放外面</p>
<h1 id="sql-limit"><a href="#sql-limit" class="headerlink" title="sql_limit"></a>sql_limit</h1><p>在数据库中很多地方都会用到，比如当你数据库查询记录有几万、几十万时使用limit查询效率非常快，只需要查询出你需要的数据就可以了·再也不用全表查询导致查询数据库崩溃的情况。<br>select <em> from Customer LIMIT 10;–检索前10行数据，显示1-10条数据<br>select </em> from Customer LIMIT 1,10;–检索从第2行开始，累加10条id记录，共显示id为2….11<br>select <em> from Customer limit 5,10;–检索从第6行开始向前加10条数据，共显示id为6,7….15<br>select </em> from Customer limit 6,10;–检索从第7行开始向前加10条记录，显示id为7,8…16  </p>
<h1 id="dao向resultMap传值"><a href="#dao向resultMap传值" class="headerlink" title="dao向resultMap传值"></a>dao向resultMap传值</h1><h3 id="对应实体的各种属性"><a href="#对应实体的各种属性" class="headerlink" title="对应实体的各种属性"></a><strong>对应实体的各种属性</strong></h3><pre><code>    &lt;resultMap type=&quot;Article&quot; id=&quot;ArticleResult&quot;&gt;
        &lt;result property=&quot;id&quot; column=&quot;id&quot;/&gt;
        &lt;result property=&quot;articleTitle&quot; column=&quot;article_title&quot;/&gt;
        &lt;result property=&quot;articleCreateDate&quot; column=&quot;article_create_date&quot;/&gt;
        &lt;result property=&quot;articleContent&quot; column=&quot;article_content&quot;/&gt;
        &lt;result property=&quot;isTop&quot; column=&quot;is_top&quot;/&gt;
        &lt;result property=&quot;addName&quot; column=&quot;add_name&quot;/&gt;
    &lt;/resultMap&gt;
</code></pre><p>传入的参数是Map Mybatis会自动解析Map里的字段</p>
<pre><code>&lt;select id=&quot;findArticles&quot; parameterType=&quot;Map&quot; resultMap=&quot;ArticleResult&quot;&gt;
        select id,article_title,article_create_date,article_content,add_name from ssm_article
        &lt;where&gt;
            &lt;if test=&quot;articleTitle!=null and articleTitle!=&#39;&#39; &quot;&gt;
                and article_title like #{articleTitle}
            &lt;/if&gt;
        &lt;/where&gt;
        &lt;if test=&quot;start!=null and size!=null&quot;&gt;
            limit #{start},#{size}
        &lt;/if&gt;
    &lt;/select&gt;
</code></pre><h3 id="Mapper文件参数获取的方式"><a href="#Mapper文件参数获取的方式" class="headerlink" title="Mapper文件参数获取的方式"></a><strong>Mapper文件参数获取的方式</strong></h3><p>参数个数为1个（string或者int）<br>dao层方法为以下两种<br>单个int型  </p>
<pre><code>public List&lt;UserComment&gt; findByDepartmentId(int dapartmentId);
</code></pre><p>单个string型  </p>
<pre><code>public Source findByTitle(String title);
</code></pre><p><strong>对应的Mapper取值：</strong><br>取值时应当注意，参数名字应该与dao层传入的参数名字相同。<br><strong>单个int型</strong></p>
<pre><code>&lt;select id=&quot;findByDepartmentId&quot;  resultType=&quot;com.bonc.wechat.entity.publicserver.UserComment&quot;&gt;
    select * from wx_user_comment where 
    department_id=#{departmentId} 
    order by createtime desc;
&lt;/select&gt;
</code></pre><p><strong>单个string型</strong>  </p>
<pre><code>&lt;select id=&quot;findByTitle&quot;  parameterType=&quot;java.lang.String&quot; resultType=&quot;com.bonc.wechat.entity.publicserver.Source&quot;&gt;
    select * from wx_source where 
        title=#{title};
&lt;/select&gt;
</code></pre><p>2、参数个数为多个。<br>dao层方法：<br>1.正常传参</p>
<pre><code>public Dailyuserinfo findStutaByUserAndDaily(String username,String dailyid);

</code></pre><p>2.注解传参  </p>
<pre><code>public List&lt;UserTab&gt; selectUserListExceptUserId
(@Param(&quot;USER_ID&quot;)String USER_ID, 
 @Param(&quot;LIMIT_POS&quot;)int LIMIT_POS, 
 @Param(&quot;LIMIT_SIZE&quot;)int LIMIT_SIZE);
</code></pre><p>对应的Mapper取值：<br>取值时应当注意，参数名字应该与dao层传入的参数名字相同。</p>
<h3 id="正常传参方式参数获取"><a href="#正常传参方式参数获取" class="headerlink" title="正常传参方式参数获取"></a>正常传参方式参数获取</h3><pre><code>&lt;select id=&quot;findStutaByUserAndDaily&quot;
           parameterType=&quot;java.lang.String&quot; 
           resultType=&quot;com.thinkgem.jeesite.modules.dailynews.entity.Dailyuserinfo&quot;&gt;

    select * from daily_user_info 
    where login_name=#{username} 
    And daily_id=#{dailyid};

&lt;/select&gt;
</code></pre><h3 id="注解传参方式参数获取"><a href="#注解传参方式参数获取" class="headerlink" title="注解传参方式参数获取"></a>注解传参方式参数获取</h3><pre><code>&lt;select id=&quot;selectUserListExceptUserId&quot; 
            resultMap=&quot;userResMap&quot;&gt;

    select * from MH_USER 
        where USER_ID!=#{USER_ID} 
        and USER_STATE&gt;9 
        order by NICK_NAME 
        limit #{LIMIT_POS},#{LIMIT_SIZE}
&lt;/select&gt;
</code></pre><h3 id="3、参数为map的形式"><a href="#3、参数为map的形式" class="headerlink" title="3、参数为map的形式"></a>3、参数为map的形式</h3><p>mapper中使用map的key取值<br>dao中的方法  </p>
<h3 id="1-参数为map"><a href="#1-参数为map" class="headerlink" title="1.参数为map"></a>1.参数为map</h3><pre><code>public List&lt;Source&gt; search(Map&lt;String,Object&gt; param);
</code></pre><h3 id="2-map的内部封装"><a href="#2-map的内部封装" class="headerlink" title="2.map的内部封装"></a>2.map的内部封装</h3><pre><code> Map&lt;String,Object&gt; param=new HashMap&lt;String,Object&gt;();
    param.put(&quot;page&quot;, (page-1)*pageSize);
    param.put(&quot;pageSize&quot;,pageSize);
    param.put(&quot;keyword&quot;,&quot;%&quot;+keyword+&quot;%&quot;);
    param.put(&quot;type&quot;,type);
    List&lt;Source&gt; sources=sourceDao.search(param);
</code></pre><h3 id="对应的Mapper取值"><a href="#对应的Mapper取值" class="headerlink" title="对应的Mapper取值"></a><strong>对应的Mapper取值</strong></h3><pre><code>&lt;select id=&quot;search&quot; 
            parameterType=&quot;java.util.Map&quot; 
            resultType=&quot;com.bonc.wechat.entity.publicserver.Source&quot;&gt;
    select * from wx_source 
        where 
     &lt;if test=&quot;keyword != null and keyword != &#39;&#39;&quot;&gt;
        (title like #{keyword} or content like #{keyword}) and
         &lt;/if&gt;
          type=#{type}
      order by ordernum asc 
          limit #{page},#{pageSize};
&lt;/select&gt;
</code></pre><h2 id="参数为对象"><a href="#参数为对象" class="headerlink" title="参数为对象"></a><strong>参数为对象</strong></h2><p>mapper中使用对象中的属性直接取值，或者【对象.属性】取值。<br>dao中的方法  </p>
<h3 id="使用对象传参"><a href="#使用对象传参" class="headerlink" title="使用对象传参"></a><strong>使用对象传参</strong></h3><pre><code>public int addUserComment(UserComment UC);
</code></pre><p><strong>对象中的属性</strong>  </p>
<pre><code>private int id;
    private int department_id;        
    private String telphone;        
    private String content;            
    private String createtime; 

</code></pre><h3 id="对应的Mapper取值："><a href="#对应的Mapper取值：" class="headerlink" title="对应的Mapper取值："></a><strong>对应的Mapper取值：</strong></h3><pre><code>&lt;insert id=&quot;addUserComment&quot; 
            parameterType=&quot;com.bonc.wechat.entity.publicserver.UserComment&quot;&gt;
    insert into wx_user_comment
                   (department_id,
                    telphone,
                    content,
                    createtime) 
    values(#{department_id},
                   #{telphone},
                   #{content},
                   #{createtime});
&lt;/insert&gt;
</code></pre><h3 id="使用【对象-属性】取值"><a href="#使用【对象-属性】取值" class="headerlink" title="使用【对象.属性】取值"></a><strong>使用【对象.属性】取值</strong></h3><p><strong>dao层：</strong><br><strong>**</strong>此示例中直接省去dao层，service直接绑定mapper层<strong>**</strong></p>
<pre><code>public PageResult findPanoramaPage(Page page) throws Exception{
    List&lt;PageData&gt; panoramaList = new ArrayList&lt;PageData&gt;();
    try {
    panoramaList = (List&lt;PageData&gt;)dao.findForList(&quot;PanoramaMapper.findPagePanorama&quot;, page);
    } catch (Exception e) {
        e.printStackTrace();
        }
    PageResult pageResult = new PageResult(page.getTotalResult(),panoramaList);
    return pageResult;
}
</code></pre><p><strong>对应的Mapper取值：</strong></p>
<pre><code>&lt;select id=&quot;findPagePanorama&quot; 
            parameterType=&quot;page&quot; 
            resultType=&quot;pd&quot;&gt;

    SELECT 
        a.id as id,
        a.project_code as projectCode,
        a.project_name as projectName,
        a.project_addr as projectAddr,
        a.project_type as projectType
    FROM 
        calm_project a 
    WHERE 
        a.is_valid=1    
    &lt;if test=&quot;page.projectType != null and page.projectType != &#39;&#39;&quot;&gt;
        AND a.project_type = #{page.projectType} 
        &lt;/if&gt;
    &lt;if test=&quot;page.keyword != null and page.keyword != &#39;&#39;&quot;&gt;
       AND (a.project_name LIKE &#39;%${page.keyword}%&#39; OR a.project_code LIKE &#39;%${page.keyword}%&#39;)
        &lt;/if&gt;
        ORDER BY 
             a.sort
&lt;/select&gt;
</code></pre><h1 id="获取插入的数据的主键"><a href="#获取插入的数据的主键" class="headerlink" title="获取插入的数据的主键"></a>获取插入的数据的主键</h1><h3 id="一般插入数据后想知道插入的数据的主键是多少，我们可以通过以下的方式来获取"><a href="#一般插入数据后想知道插入的数据的主键是多少，我们可以通过以下的方式来获取" class="headerlink" title="一般插入数据后想知道插入的数据的主键是多少，我们可以通过以下的方式来获取"></a><strong>一般插入数据后想知道插入的数据的主键是多少，我们可以通过以下的方式来获取</strong></h3><p>需求：<br>user对象插入到数据库后，新记录的主键要通过user对象返回，通过user获取主键值。<br>解决思路：<br>通过LAST_INSERT_ID()获取刚插入记录的自增主键值，在insert语句执行后，执行select LAST_INSERT_ID()就可以获取自增主键。<br>mysql:</p>
<pre><code>    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
        &lt;selectKey keyProperty=&quot;id&quot; order=&quot;AFTER&quot; resultType=&quot;int&quot;&gt;
            select LAST_INSERT_ID()
        &lt;/selectKey&gt;
        INSERT INTO USER(username,birthday,sex,address) VALUES(#{username},#{birthday},#{sex},#{address})
    &lt;/insert&gt;
</code></pre><p>oracle:<br>实现思路：<br>先查询序列得到主键，将主键设置到user对象中，将user对象插入数据库。</p>
<pre><code>    &lt;!-- oracle
    在执行insert之前执行select 序列.nextval() from dual取出序列最大值，将值设置到user对象 的id属性
     --&gt;
    &lt;insert id=&quot;insertUser&quot; parameterType=&quot;cn.itcast.mybatis.po.User&quot;&gt;
        &lt;selectKey keyProperty=&quot;id&quot; order=&quot;BEFORE&quot; resultType=&quot;int&quot;&gt;
            select 序列.nextval() from dual
        &lt;/selectKey&gt;

        INSERT INTO USER(id,username,birthday,sex,address) VALUES( 序列.nextval(),#{username},#{birthday},#{sex},#{address})
    &lt;/insert&gt; 
</code></pre><h1 id="dao接口与xml映射文件-1"><a href="#dao接口与xml映射文件-1" class="headerlink" title="dao接口与xml映射文件"></a>dao接口与xml映射文件</h1><h3 id="Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？-1"><a href="#Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？-1" class="headerlink" title="Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？"></a><strong>Dao接口的工作原理是什么？Dao接口里的方法，参数不同时，方法能重载吗？</strong></h3><p>Dao接口即Mapper接口<br>接口的全限名=映射文件中的namespace的值<br>接口的方法名=映射文件中MappedStatement的id值<br>接口方法内的参数=传递给sql的参数<br>Mapper接口是没有实现类的，当调用接口方法时，接口全限名+方法名拼接字符串作为key值，可唯一定位一个MappedStatement<br><strong>举例：</strong><br>在Mybatis中，每一个select、insert、update、delete标签，都会被解析为一个MappedStatement对象。<br>com.mybatis3.mappers.StudentDao.findStudentById，<br>可以唯一找到namespace为com.mybatis3.mappers.StudentDao中id = findStudentById的MappedStatement。<br><strong>注意：</strong><br>Dao接口里的方法，是不能重载的，因为是全限名+方法名的保存和寻找策略。<br><strong>Dao接口的工作原理：</strong><br>JDK动态代理，Mybatis运行时使用JDK动态代理为Dao接口生成代理proxy对象，代理对象proxy会拦截接口方法，转而执行MappedStatement所代表的sql，然后将sql执行结果返回  </p>
<h3 id="Mybatis的Xml映射文件中，不同的Xml映射文件，id是否可以重复？-1"><a href="#Mybatis的Xml映射文件中，不同的Xml映射文件，id是否可以重复？-1" class="headerlink" title="Mybatis的Xml映射文件中，不同的Xml映射文件，id是否可以重复？"></a><strong>Mybatis的Xml映射文件中，不同的Xml映射文件，id是否可以重复？</strong></h3><p>namespace不同可以重复，因为我们的Statement实际上就是namespace+id</p>
<h3 id="Mybatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？-1"><a href="#Mybatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？-1" class="headerlink" title="Mybatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？"></a><strong>Mybatis动态sql是做什么的？都有哪些动态sql？能简述一下动态sql的执行原理不？</strong></h3><p>完成逻辑判断和动态拼接sql的功能。<br>Mybatis提供了9种动态sql标签：trim|where|set|foreach|if|choose|when|otherwise|bind。<br><strong>执行原理</strong><br>使用OGNL从sql参数对象中计算表达式的值，根据表达式的值动态拼接sql，以此来完成动态sql的功能。</p>
<h1 id="当实体类中的属性名和表中的字段名不一样-，怎么办-？"><a href="#当实体类中的属性名和表中的字段名不一样-，怎么办-？" class="headerlink" title="当实体类中的属性名和表中的字段名不一样 ，怎么办 ？"></a><strong>当实体类中的属性名和表中的字段名不一样 ，怎么办 ？</strong></h1><p>1.在sql中设置别名<br>2.在resultMap中通过属性映射数据库的字段<br><strong>示例</strong><br>第1种： 通过在查询的sql语句中定义字段名的别名，让字段名的别名和实体类的属性名一致</p>
<pre><code>&lt;select id=”selectorder” parametertype=”int” resultetype=”me.gacl.domain.order”&gt; 
       select order_id id, order_no orderno ,order_price price form orders where order_id=#{id}; 
    &lt;/select&gt; 
</code></pre><p>第2种： 通过<code>&lt;resultMap&gt;</code>来映射字段名和实体类属性名的一一对应的关系</p>
<pre><code> &lt;select id=&quot;getOrder&quot; parameterType=&quot;int&quot; resultMap=&quot;orderresultmap&quot;&gt;
        select * from orders where order_id=#{id}
    &lt;/select&gt;
   &lt;resultMap type=”me.gacl.domain.order” id=”orderresultmap”&gt; 
        &lt;!–用id属性来映射主键字段–&gt; 
        &lt;id property=”id” column=”order_id”&gt; 
        &lt;!–用result属性来映射非主键字段，property为实体类属性名，column为数据表中的属性–&gt; 
        &lt;result property = “orderno” column =”order_no”/&gt; 
        &lt;result property=”price” column=”order_price” /&gt; 
    &lt;/reslutMap&gt;
</code></pre><p>我认为第二种方式会好一点。</p>
<h1 id="SqlSessionFactoryBuilder、SqlSessionFactory、SqlSession、数据库会话器"><a href="#SqlSessionFactoryBuilder、SqlSessionFactory、SqlSession、数据库会话器" class="headerlink" title="SqlSessionFactoryBuilder、SqlSessionFactory、SqlSession、数据库会话器"></a>SqlSessionFactoryBuilder、SqlSessionFactory、SqlSession、数据库会话器</h1><h3 id="SqlSessionFactoryBuilder（构造器）"><a href="#SqlSessionFactoryBuilder（构造器）" class="headerlink" title="SqlSessionFactoryBuilder（构造器）"></a><strong>SqlSessionFactoryBuilder（构造器）</strong></h3><p><strong>用处：</strong>根据配置信息或者代码来生成SqlSessionFactory<br>该类有多个重载方法build()。如下图：<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101026.png?raw=true" alt="enter description
here"><br><strong>SqlSessionFactoryBuilder真正重载build方法只有如下三种：</strong><br>分别是InputStream（字节流）、Reader（字符流）、Configuration（类）<br><strong>字节流和字符流</strong>通过读取XML文件创建SqlSessionFactory    </p>
<pre><code>public SqlSessionFactory build(InputStream inputStream, String environment, Properties properties) 
</code></pre><pre><code>public SqlSessionFactory build(Reader reader, String environment, Properties properties)
</code></pre><p><strong>Configuration</strong>是java代码方式创建SqlSessionFactory  </p>
<pre><code>public SqlSessionFactory build(Configuration config)
</code></pre><p>最后一种读取xml构造SqlSessionFactory，构造过程中注入了configuration的实例对象，之后configuration实例对象解析XML文件来构建SqlSessionFactory，示例代码</p>
<pre><code>String resource = &quot;mybatis-config.xml&quot;;
    InputStream inputStream = Resources.getResourceAsStream(resource);
    SqlSessionFactory sqlSessionFactory = null;
    sqlSessionFactory = new SqlSessionFactoryBuilder().build(inputStream);
</code></pre><p>通过分析，SqlSessionFactoryBuilder创建SqlSessionFactory采用了建造者的设计模式<br>SqlSessionFactoryBuilder扮演具体的建造者，Configuration类则负责建造的细节工作，SqlSession则是构造出来的产品  </p>
<h3 id="SqlSessionFactory（工厂接口）"><a href="#SqlSessionFactory（工厂接口）" class="headerlink" title="SqlSessionFactory（工厂接口）"></a><strong>SqlSessionFactory（工厂接口）</strong></h3><p><strong>用处：</strong>生产SqlSession会话 即sqlSession = sqlSessionFactory.openSession();  </p>
<h3 id="SqlSession（会话）"><a href="#SqlSession（会话）" class="headerlink" title="SqlSession（会话）"></a><strong>SqlSession（会话）</strong></h3><p><strong>作用</strong><br>获取映射器，映射器通过命名空间和方法名称找到SQL，发送给数据库执行后返回结果；<br>通过update、insert、select、delete等方法，带上SQL的id来操作在XML中配置好的SQL，从而完成工作，与此同时它也支持事务，通过commit、rollback方法提交或者回滚事务。<br><strong>运行原理：</strong>SqlSession通过Executor（执行器）创建StatementHandler来运行的<br><img src="https://github.com/54321decba/tu/blob/master/2018-10-10/2018101027.png?raw=true" alt=""> </p>
<h3 id="数据库会话器（StatementHandler）："><a href="#数据库会话器（StatementHandler）：" class="headerlink" title="数据库会话器（StatementHandler）："></a><strong>数据库会话器（StatementHandler）：</strong></h3><p>使用数据库的Statement（PrepareStatement）执行操作<br>种类：SimpleStatementHandler：对应SIMPLE执行器<br>           PrepareStatementHandler：对应REUSE执行器<br>           CallableStatementHandler：对应BATCH执行器<br><strong>参数处理器（ParameterHandler）：</strong>用于SQL对参数的处理<br><strong>结果处理器（ResultSetHandler）：</strong>进行最后数据集（ResultSet）的封装返回处理。  </p>
<h3 id="总结-1"><a href="#总结-1" class="headerlink" title="总结"></a><strong>总结</strong></h3><p>mybatis的核心组件，重点是SqlSession和映射器。SqlSession的运行原理要有所了解，会使用SqlSession，同时也要理解mapper的原理，理解mybatis访问数据看的具体原理</p>
<h1 id="Mapper文件"><a href="#Mapper文件" class="headerlink" title="Mapper文件"></a>Mapper文件</h1><p>当只有一个参数时，没什么好说的，传进去一个值也只有一个参数可以匹配。当存在多个参数时，传进去的值就区分不开了，这时可以考虑用Map，例如接口</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>Role<span class="token operator">></span> <span class="token function">findRoleByMap</span><span class="token punctuation">(</span>Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="xml文件"><a href="#xml文件" class="headerlink" title="xml文件 "></a><font color="red"><strong>xml文件</strong> </font></h2><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"findRoleByMap"</span> parameterType<span class="token operator">=</span><span class="token string">"map"</span> resultType<span class="token operator">=</span><span class="token string">"role"</span><span class="token operator">></span>
    SELECT id<span class="token punctuation">,</span>name FROM t_role
    WHERE roleName<span class="token operator">=</span>#<span class="token punctuation">{</span>roleName<span class="token punctuation">}</span>
    AND note<span class="token operator">=</span>#<span class="token punctuation">{</span>note<span class="token punctuation">}</span>
<span class="token operator">&lt;</span>select<span class="token operator">></span>
</code></pre>
<h2 id="测试文件"><a href="#测试文件" class="headerlink" title="测试文件 "></a><font color="red"><strong>测试文件</strong> </font></h2><pre class=" language-java"><code class="language-java"> RoleMapper roleMapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span>RoleMapper<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    Map<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> Object<span class="token operator">></span> parameter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    parameter<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"roleName"</span><span class="token punctuation">,</span> <span class="token string">"剑士"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    parameter<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">"note"</span><span class="token punctuation">,</span> <span class="token string">"决战紫禁之巅"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    List<span class="token operator">&lt;</span>Role<span class="token operator">></span> roles <span class="token operator">=</span> roleMapper<span class="token punctuation">.</span><span class="token function">findRolesByMap</span><span class="token punctuation">(</span>parameter<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="使用-Param"><a href="#使用-Param" class="headerlink" title="使用@Param "></a><font color="red"><strong>使用@Param</strong> </font></h2><p>很明显上面的缺点就在于可读性差，每次必须阅读他的键，才能明白其中的作用，并且不能限定其传递的数据类型，下面是使用@Param的情况，需要将接口改为</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> List<span class="token operator">&lt;</span>Role<span class="token operator">></span> <span class="token function">findRoleByAnnotation</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"roleName"</span><span class="token punctuation">)</span> String roleName<span class="token punctuation">,</span> <span class="token annotation punctuation">@Param</span><span class="token punctuation">(</span><span class="token string">"note"</span><span class="token punctuation">)</span> String note<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>这样我们就可以直接传入对应的值了</p>
<h2 id="sql"><a href="#sql" class="headerlink" title="sql"></a>sql</h2><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>sql id<span class="token operator">=</span><span class="token string">"Base_Column_List"</span> <span class="token operator">></span>
    id<span class="token punctuation">,</span> title<span class="token punctuation">,</span> parent_id<span class="token punctuation">,</span> is_parentId
  <span class="token operator">&lt;</span><span class="token operator">/</span>sql<span class="token operator">></span>
<span class="token operator">&lt;</span>select id<span class="token operator">=</span><span class="token string">"selectByPrimaryKey"</span> resultMap<span class="token operator">=</span><span class="token string">"BaseResultMap"</span> parameterType<span class="token operator">=</span><span class="token string">"java.lang.Integer"</span> <span class="token operator">></span>
    select 
    <span class="token operator">&lt;</span>include refid<span class="token operator">=</span><span class="token string">"Base_Column_List"</span> <span class="token operator">/</span><span class="token operator">></span>
    from menu
    where id <span class="token operator">=</span> #<span class="token punctuation">{</span>id<span class="token punctuation">,</span>jdbcType<span class="token operator">=</span>INTEGER<span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">></span>
</code></pre>
<h1 id="RegisterMapper"><a href="#RegisterMapper" class="headerlink" title="@RegisterMapper"></a>@RegisterMapper</h1><p>增加该注解后会自动注册该接口到通用 Mapper（不需要配置 mappers 参数指定该接口了）</p>
<h1 id="resultMap示例"><a href="#resultMap示例" class="headerlink" title="resultMap示例"></a>resultMap示例</h1><pre class=" language-java"><code class="language-java"><span class="token operator">&lt;</span>resultMap id<span class="token operator">=</span><span class="token string">"BaseResultMap"</span> type<span class="token operator">=</span><span class="token string">"com.pipi.dao.pojo.Address"</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>id column<span class="token operator">=</span><span class="token string">"id"</span> property<span class="token operator">=</span><span class="token string">"id"</span> jdbcType<span class="token operator">=</span><span class="token string">"INTEGER"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>result column<span class="token operator">=</span><span class="token string">"openid"</span> property<span class="token operator">=</span><span class="token string">"openid"</span> jdbcType<span class="token operator">=</span><span class="token string">"VARCHAR"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>result column<span class="token operator">=</span><span class="token string">"name"</span> property<span class="token operator">=</span><span class="token string">"name"</span> jdbcType<span class="token operator">=</span><span class="token string">"VARCHAR"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>result column<span class="token operator">=</span><span class="token string">"mobile"</span> property<span class="token operator">=</span><span class="token string">"mobile"</span> jdbcType<span class="token operator">=</span><span class="token string">"VARCHAR"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>result column<span class="token operator">=</span><span class="token string">"gender"</span> property<span class="token operator">=</span><span class="token string">"gender"</span> jdbcType<span class="token operator">=</span><span class="token string">"INTEGER"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>result column<span class="token operator">=</span><span class="token string">"address"</span> property<span class="token operator">=</span><span class="token string">"address"</span> jdbcType<span class="token operator">=</span><span class="token string">"VARCHAR"</span> <span class="token operator">/</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>result column<span class="token operator">=</span><span class="token string">"is_default"</span> property<span class="token operator">=</span><span class="token string">"isDefault"</span> jdbcType<span class="token operator">=</span><span class="token string">"INTEGER"</span> <span class="token operator">/</span><span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>resultMap<span class="token operator">></span>
</code></pre>
<h1 id="ActionContext"><a href="#ActionContext" class="headerlink" title="ActionContext"></a>ActionContext</h1><p>是Sruts2内置对象，通过该对象可以获得之前Servlet中的对象，比如：requst对象，response对象<br>每次发送一次请求就会创建一个ActionContext<br>ActionContext是一个Map集合  内部记录了name = request value = 该对象的地址   </p>

            </div>
            <hr>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone, qq, weibo, douban"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;Reprint please specify:
                    </span>
                    <a href="http://viabcde.github.io" class="b-link-green">Fox</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2016/09/01/2016-09-01-初识框架/" class="b-link-green">开发框架</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="/2016/09/06/2016-09-06-用户登录模块实现/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/22.jpg" class="responsive-img" alt="用户登录模块的后台实现">
                        
                        <span class="card-title">用户登录模块的后台实现</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">实例项目
访问首页首页登录地址映射到登陆页面    @RequestMapping("/")
    public String login() {
        return "login";
    }

登录网站接收前台url地址的</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2016-09-06
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/编程/" class="post-category" target="_blank">
                                    编程
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/project/" target="_blank">
                        <span class="chip bg-color">project</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2016/08/09/2016-08-09-windows/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/4.jpg" class="responsive-img" alt="Windows">
                        
                        <span class="card-title">Windows</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary">激活Windows自己动手，KMS激活win10 2016 长期服务版。步骤如下：命令提示符（管理员），依次输入以下3条命令
slmgr /ipk DCPHK-NFMTC-H88MJ-PFHPY-QJ4BJslmgr /skms xykz.</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2016-08-09
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/Windows/" class="post-category" target="_blank">
                                    Windows
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://blinkfox.github.io/" target="_blank">Blinkfox</a>基于
            <a href="https://hexo.io/" target="_blank">Hexo</a> 的
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>主题搭建.

            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:437230257@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=437230257" class="tooltipped" data-tooltip="QQ联系我: 437230257" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>


</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword" class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"display":{"position":"right","width":60,"height":100},"mobile":{"show":true},"search":null,"path":"search.xml","field":"post","log":false});</script></body>
</html>